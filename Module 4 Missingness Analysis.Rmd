---
title: "Module 4 Missingness Analysis"
author: "Kelsey Dowling"
date: "`r Sys.Date()`"
output:
  pdf_document:
    latex_engine: xelatex
---

This report gives the distribution of all Module 4 missing responses using the skip logic from Qx:https://nih.app.box.com/file/923661036132?s=o816d6804w154fqf5y161ii7ngvcezqg for those that completed this survey.


To avoid confusion, these tables will NOT have sums of missing responses at the bottom. Participants are able to skip one or all components of a question in Module 4; those counted in the 'skipped entire (question)' rows will be counted within all other rows of the table.


```{r libraries, include=FALSE}

##  MUST RUN FIRST BEFORE KNITTING


library(bigrquery)
#install_tinytex()
library(tinytex)

library(data.table) ###to write or read and data management 
library(tidyverse) ###for data management
library(dplyr) ###data management
library(reshape)  ###to work on transition from long to wide or wide to long data
library(listr) ###to work on a list of vector, files or..
library(sqldf) ##sql
library(lubridate) ###date time
library(stringr) ###to work on patterns, charaters
library(arsenal)
library(gt)
library(gtsummary)

options(tinytex.verbose = TRUE)

bq_auth()
```


```{r QueryStatus, include=FALSE}

##Make sure SQL queries are properly running


# check_sch_query_status <- 
#   function(project, table_name){
# 
#     ## Set default project for BQ CLI
#     #set_proj_cmd <- paste0("bq ls -j --project_id ", project, " > /dev/null")
#     #system(set_proj_cmd)
#     
#     # Get list of scheduled queries from bq
#     bq_request <- 'bq ls --transfer_config --transfer_location="us" --filter="dataSourceIds:scheduled_query"'
#     response   <- system(bq_request, intern=TRUE)
#     # Remove second line "----" of table and remove white space from each row
#     response   <- lapply(response[-2], function(x) scan(text = x, what = ""))
#     header     <- simplify2array(response[1]) # Array of column names
#     
#     # Bind rows of data into one array
#     for (i in length(header)){
#       x <- c() # Initialize array with first non-header line of data
#       # Loop through remaining data
#       for (line in response[2:length(response)]){
#         x <- rbind(x, line)
#       }
#     }
#     
#     # Format as dataframe
#     df <- data.frame(x, row.names = NULL)
#     colnames(df) <- header
#     
#     # Return sch. query status as "SUCCEEDED", "PENDING", "RUNNING" or "FAILED".
#     df$state[df$displayName==table_name] 
#   }
# 
# 
# table_name <- "FlatConnect.participants_JP"
# project    <- "nih-nci-dceg-connect-prod-6d04"
# 
# # Check status of scheduled query
# query_status <- check_sch_query_status(project, table_name)
# switch(query_status,
#  "FAILED"    = stop(paste0("The sch. query for ", table_name, " failed. Reach out to Jake.")),
#   "PENDING"   = stop(paste0("The query for ", table_name, " is scheduled and waiting to be run.")),
#   "RUNNING"   = stop(paste0("The sch. query for ", table_name, " is still running. Wait until complete.")),
#   "SUCCEEDED" = print(paste0("The most recent scheduled query for ", table_name, " succeeded. The table is up-to-date."))
# )
# 
# 
# table_name <- "FlatConnect.module1_v1_JP"
# project    <- "nih-nci-dceg-connect-prod-6d04"
# 
# # Check status of scheduled query
# query_status <- check_sch_query_status(project, table_name)
# switch(query_status,
#  "FAILED"    = stop(paste0("The sch. query for ", table_name, " failed. Reach out to Jake.")),
#   "PENDING"   = stop(paste0("The query for ", table_name, " is scheduled and waiting to be run.")),
#   "RUNNING"   = stop(paste0("The sch. query for ", table_name, " is still running. Wait until complete.")),
#   "SUCCEEDED" = print(paste0("The most recent scheduled query for ", table_name, " succeeded. The table is up-to-date."))
# )
# 
# 
# table_name <- "FlatConnect.module1_v2_JP"
# project    <- "nih-nci-dceg-connect-prod-6d04"
# 
# # Check status of scheduled query
# query_status <- check_sch_query_status(project, table_name)
# switch(query_status,
#  "FAILED"    = stop(paste0("The sch. query for ", table_name, " failed. Reach out to Jake.")),
#   "PENDING"   = stop(paste0("The query for ", table_name, " is scheduled and waiting to be run.")),
#   "RUNNING"   = stop(paste0("The sch. query for ", table_name, " is still running. Wait until complete.")),
#   "SUCCEEDED" = print(paste0("The most recent scheduled query for ", table_name, " succeeded. The table is up-to-date."))
# )
# 
# 
# table_name <- "FlatConnect.module4_v1_JP"
# project    <- "nih-nci-dceg-connect-prod-6d04"
# 
# # Check status of scheduled query
# query_status <- check_sch_query_status(project, table_name)
# switch(query_status,
#  "FAILED"    = stop(paste0("The sch. query for ", table_name, " failed. Reach out to Jake.")),
#   "PENDING"   = stop(paste0("The query for ", table_name, " is scheduled and waiting to be run.")),
#   "RUNNING"   = stop(paste0("The sch. query for ", table_name, " is still running. Wait until complete.")),
#   "SUCCEEDED" = print(paste0("The most recent scheduled query for ", table_name, " succeeded. The table is up-to-date."))
# )


```


```{r M1Merge, include=FALSE}

#Data Dictionary for column names
dictionary <- rio::import("https://episphere.github.io/conceptGithubActions/aggregate.json",format = "json")
dd <- dplyr::bind_rows(dictionary,.id="CID")
dd <-rbindlist(dictionary,fill=TRUE,use.names=TRUE,idcol="CID")
dd$`Variable Label`[is.na(dd$`Variable Label`)] <- replace_na(dd$'Variable Name')
dd <- as.data.frame.matrix(do.call("rbind",dictionary)) 
dd$CID <- rownames(dd)
#https://shaivyakodan.medium.com/7-useful-r-packages-for-analysis-7f60d28dca98
devtools::install_github("tidyverse/reprex")





## BQ Pull from the participants table just to use for versioning
project <- "nih-nci-dceg-connect-prod-6d04"
billing <- "nih-nci-dceg-connect-prod-6d04" 
recr_M1 <- bq_project_query(project, query="SELECT token,Connect_ID, d_821247024, d_914594314,  d_827220437,d_512820379,
                            d_949302066 , d_517311251  FROM  `nih-nci-dceg-connect-prod-6d04.FlatConnect.participants_JP` WHERE  d_821247024='197316935' and d_949302066 ='231311385'")
recr_m1 <- bq_table_download(recr_M1,bigint = "integer64")
cnames <- names(recr_m1)
# Check that it doesn't match any non-number
numbers_only <- function(x) !grepl("\\D", x)
# to check variables in recr_noinact_wl1
for (i in 1: length(cnames)){
  varname <- cnames[i]
  var<-pull(recr_m1,varname)
  recr_m1[,cnames[i]] <- ifelse(numbers_only(var), as.numeric(as.character(var)), var)
}




#### Handling participants that somehow completed both Mod1 version 1 and Mod1 version 2

sql_M1_1 <- bq_project_query(project, query = "SELECT Connect_ID, D_784967158 FROM `nih-nci-dceg-connect-prod-6d04.FlatConnect.module1_v1_JP` WHERE Connect_ID IS NOT NULL")
sql_M1_2 <- bq_project_query(project, query = "SELECT Connect_ID, D_784967158 FROM `nih-nci-dceg-connect-prod-6d04.FlatConnect.module1_v2_JP` WHERE Connect_ID IS NOT NULL")

M1_V1 <- bq_table_download(sql_M1_1, bigint = "integer64")
M1_V2 <- bq_table_download(sql_M1_2, bigint = "integer64")

# Select matching column names
M1_V1_vars <- colnames(M1_V1)
M1_V2_vars <- colnames(M1_V2)
common_vars <- intersect(M1_V1_vars, M1_V2_vars)

# Subset to common columns
M1_V1_common <- M1_V1[, common_vars]
M1_V2_common <- M1_V2[, common_vars]

# Add version indicator
M1_V1_common$version <- 1
M1_V2_common$version <- 2

# Identify columns with mismatched types
mismatched_cols <- names(M1_V1_common)[sapply(names(M1_V1_common), function(col) {
  class(M1_V1_common[[col]]) != class(M1_V2_common[[col]])
})]

# Convert mismatched columns to character for consistency
M1_V1_common <- M1_V1_common %>%
  mutate(across(all_of(mismatched_cols), as.character))
M1_V2_common <- M1_V2_common %>%
  mutate(across(all_of(mismatched_cols), as.character))

# Combine both versions for participants who completed both
M1_common <- bind_rows(M1_V1_common, M1_V2_common) %>%
  arrange(Connect_ID, desc(version))

# For columns unique to each version
V1_only_vars <- setdiff(M1_V1_vars, common_vars)
V2_only_vars <- setdiff(M1_V2_vars, common_vars)

# Subset each version for unique columns and add version indicator
m1_v1_only <- M1_V1[, c("Connect_ID", V1_only_vars)] %>%
  mutate(version = 1)
m1_v2_only <- M1_V2[, c("Connect_ID", V2_only_vars)] %>%
  mutate(version = 2)

# Combine the unique and common data
m1_common_v1 <- left_join(M1_common, m1_v1_only, by = c("Connect_ID", "version"))
m1_combined_v1v2 <- left_join(m1_common_v1, m1_v2_only, by = c("Connect_ID", "version"))

# Filter for complete cases where specific completion criteria are met
m1_complete <- m1_combined_v1v2 %>%
  filter(Connect_ID %in% recr_m1$Connect_ID[recr_m1$d_949302066 == 231311385]) %>%
  arrange(desc(version))

# Remove duplicates, keeping only the most recent version for each Connect_ID
m1_complete_nodup <- m1_complete[!duplicated(m1_complete$Connect_ID),]

m1_complete_nodup$Connect_ID <- as.numeric(m1_complete_nodup$Connect_ID)


## Define requirements of the data: active or passive,  user profile done, consented, mod4 done, verified
parts <- "SELECT Connect_ID, token,  d_452942800, d_264644252
FROM `nih-nci-dceg-connect-prod-6d04.FlatConnect.participants_JP` 
where Connect_ID IS NOT NULL and (d_512820379='486306141' OR d_512820379='854703046') and 
d_919254129='353358909' and d_699625233='353358909' and d_663265240='231311385' and d_821247024='197316935'"
querymod4 <- "SELECT * FROM `nih-nci-dceg-connect-prod-6d04.FlatConnect.module4_v1_JP` where Connect_ID IS NOT NULL"

parts_table <- bq_project_query(project, parts)
mod4_table <- bq_project_query(project, querymod4)

parts_data <- bq_table_download(parts_table, bigint = "integer64")
mod4_data <- bq_table_download(mod4_table, bigint = "integer64")

parts_data$Connect_ID <- as.numeric(parts_data$Connect_ID) ###need to convert type- m1... is double and parts is character
mod4_data$Connect_ID <- as.numeric(mod4_data$Connect_ID)

module4= left_join(parts_data, m1_complete_nodup, by="Connect_ID") %>%  left_join(mod4_data, by="Connect_ID")
dim(module4)

### Issue: there are 3 people that took module 4 twice. They are somehow showing up on this report but not on the low or high priority reports

knitr::opts_chunk$set(comment = NA)

```


```{r, warning=FALSE, echo=FALSE,  message=FALSE, collapse=TRUE}


cat("Participants with Module 4 Completion:", dim(module4)[[1]])


``` 

```{r MissingnessLibraries, warning=FALSE, include=FALSE}
#Missingness Analysis Set Up

#install.packages("naniar")
#install.packages("UpSetR")
library(naniar)
library(UpSetR)
library(tidyverse)



Mod4 <- as_tibble(module4)
```



# Section 1: Residential History 
## Home 1 Address
```{r Home1, warning=FALSE, echo=FALSE, message=FALSE}

Mod4$Street_Number <- Mod4$D_121490150_D_255248624
Mod4$Street_Name <- Mod4$D_121490150_D_945532934
Mod4$Apt_Number <- Mod4$D_121490150_D_469838242
Mod4$City <- Mod4$D_121490150_D_303500597
Mod4$State <- Mod4$D_121490150_D_195068098
Mod4$ZIP <- Mod4$D_121490150_D_202784871
Mod4$Country <- Mod4$D_121490150_D_831127170



home1skip <- Mod4 %>% select(Connect_ID, Street_Number, Street_Name, City, State, ZIP, Country)
home1skip= home1skip %>%  mutate(Address1= case_when(is.na(Street_Number) & is.na(Street_Name) & 
                                                       is.na(City) & is.na(State) & is.na(ZIP)& is.na(Country)~"Skipped Entire Home 1 Address "))

dt_home1skip_summary <- home1skip %>% dplyr::group_by(Address1) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address1, n, percentage)
dt_home1skip_summary <- dt_home1skip_summary[1,]


dt_home1skip_summary[2,1] <- "Skipped Street_Number" 
dt_home1skip_summary[2,2] <- sum(is.na(home1skip$Street_Number))
dt_home1skip_summary[2,3] <- (sum(is.na(home1skip$Street_Number))/dim(home1skip)[[1]])*100

dt_home1skip_summary[3,1] <- "Skipped Street Name" 
dt_home1skip_summary[3,2] <- sum(is.na(home1skip$Street_Name))
dt_home1skip_summary[3,3] <- (sum(is.na(home1skip$Street_Name))/dim(home1skip)[[1]])*100

dt_home1skip_summary[4,1] <- "Skipped City"
dt_home1skip_summary[4,2] <- sum(is.na(home1skip$City))
dt_home1skip_summary[4,3] <- (sum(is.na(home1skip$City))/dim(home1skip)[[1]])*100

dt_home1skip_summary[5,1] <- "Skipped State"
dt_home1skip_summary[5,2] <- sum(is.na(home1skip$State))
dt_home1skip_summary[5,3] <- (sum(is.na(home1skip$State))/dim(home1skip)[[1]])*100

dt_home1skip_summary[6,1] <- "Skipped ZIP"
dt_home1skip_summary[6,2] <- sum(is.na(home1skip$ZIP))
dt_home1skip_summary[6,3] <- (sum(is.na(home1skip$ZIP))/dim(home1skip)[[1]])*100

dt_home1skip_summary[7,1] <- "Skipped Country"
dt_home1skip_summary[7,2] <- sum(is.na(home1skip$Country))
dt_home1skip_summary[7,3] <- (sum(is.na(home1skip$Country))/dim(home1skip)[[1]])*100



dt_home1skip_summary %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Address 1 Components Skipped")) %>% 
  cols_label(n= md("**Number of Participants**"),Address1 = md("**Question**"), percentage = md("**%**")) %>% 
  #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address1,
    )
  ) 



Followup1_skip= Mod4 %>%  filter(Mod4$D_920576363_D_920576363!="[178420302]" & 
                                   (is.na(D_920576363_D_725583683) & is.na(D_121490150_D_303500597)) | 
                             (is.na(D_920576363_D_917021073) & is.na(D_121490150_D_195068098)) | 
                              (is.na(D_920576363_D_970000442) & is.na(D_121490150_D_202784871)) | 
                             (is.na(D_920576363_D_500100435) & is.na(D_121490150_D_831127170))) %>% 
  mutate(Address= case_when(is.na(D_920576363_D_725583683) & is.na(D_121490150_D_303500597) & 
                             is.na(D_920576363_D_917021073) & is.na(D_121490150_D_195068098) & 
                              is.na(D_920576363_D_970000442) & is.na(D_121490150_D_202784871) & 
                             is.na(D_920576363_D_500100435) & is.na(D_121490150_D_831127170) ~"Skipped All Follow-up"))

Followup1__skip <- Followup1_skip %>% dplyr::group_by(Address) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address, n, percentage)
Followup1__skip <- Followup1__skip[1,]


Followup1__skip[2,1] <- "Skipped State Follow-up" 
Followup1__skip[2,2] <- sum(is.na(Followup1_skip$D_920576363_D_725583683) & is.na(Followup1_skip$D_121490150_D_303500597))
Followup1__skip[2,3] <- (sum(is.na(Followup1_skip$D_920576363_D_725583683) & is.na(Followup1_skip$D_121490150_D_303500597))/dim(Followup1_skip)[[1]])*100

Followup1__skip[3,1] <- "Skipped State Follow-up" 
Followup1__skip[3,2] <- sum(is.na(Followup1_skip$D_920576363_D_917021073) & is.na(Followup1_skip$D_121490150_D_195068098))
Followup1__skip[3,3] <- (sum(is.na(Followup1_skip$D_920576363_D_917021073) & is.na(Followup1_skip$D_121490150_D_195068098))/dim(Followup1_skip)[[1]])*100

Followup1__skip[4,1] <- "Skipped ZIP Follow-up"
Followup1__skip[4,2] <- sum(is.na(Followup1_skip$D_920576363_D_970000442) & is.na(Followup1_skip$D_121490150_D_202784871))
Followup1__skip[4,3] <- (sum(is.na(Followup1_skip$D_920576363_D_970000442) & is.na(Followup1_skip$D_121490150_D_202784871))/dim(Followup1_skip)[[1]])*100

Followup1__skip[4,1] <- "Skipped Country Follow-up"
Followup1__skip[4,2] <- sum(is.na(Followup1_skip$D_920576363_D_500100435) & is.na(Followup1_skip$D_121490150_D_831127170))
Followup1__skip[4,3] <- (sum(is.na(Followup1_skip$D_920576363_D_500100435) & is.na(Followup1_skip$D_121490150_D_831127170))/dim(Followup1_skip)[[1]])*100


Followup1__skip %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Address 1 Follow-up Skipped")) %>% 
  cols_label(n= md("**Number of Participants**"),Address = md("**Question**"), percentage = md("**%**")) %>% 
  #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address,
    )
  ) 







home_add3_1= Mod4 %>% #select(D_804504024_D_105043152, D_804504024_D_543135391) %>% 
  filter((is.na(Mod4$D_804504024_D_105043152) | is.na(Mod4$D_804504024_D_543135391)) & Mod4$D_804504024_D_804504024!="[178420302]" & 
            is.na(Mod4$D_121490150_D_255248624) & is.na(Mod4$D_121490150_D_945532934) & ((!is.na(Mod4$D_121490150_D_303500597) | !is.na(Mod4$D_121490150_D_195068098) | 
                                                                                            !is.na(Mod4$D_121490150_D_202784871) | !is.na(Mod4$D_121490150_D_831127170)) | 
                                                                                   (!is.na(Mod4$D_920576363_D_725583683) | !is.na(Mod4$D_920576363_D_917021073) |
                                                                                      !is.na(Mod4$D_920576363_D_970000442) |!is.na(Mod4$D_920576363_D_500100435))))

home_add3_1 <- home_add3_1 %>%  mutate(Address= case_when(is.na(D_804504024_D_105043152)~"Skipped Cross-Street 1"))

dt_home_add3_1 <- home_add3_1 %>% dplyr::group_by(Address) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address, n, percentage)
dt_home_add3_1 <- dt_home_add3_1[1,]

dt_home_add3_1[2,1] <- "Skipped Cross-Street 2" 
dt_home_add3_1[2,2] <- sum(is.na(home_add3_1$D_804504024_D_543135391))
dt_home_add3_1[2,3] <- (sum(is.na(home_add3_1$D_804504024_D_543135391))/dim(home_add3_1)[[1]])*100


dt_home_add3_1 %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Address 1 Cross-Streets")) %>% 
  cols_label(n= md("**Number of Participants**"),Address = md("**Question**"), percentage = md("**%**")) %>% 
  #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address,
    )
  ) 






home_addoth <- Mod4 %>%  mutate(Address= case_when(is.na(D_290969423)~"Skipped Providing any Additional Homes"))

dt_home_addoth <- home_addoth %>% dplyr::group_by(Address) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address, n, percentage)
dt_home_addoth <- dt_home_addoth[1,]


dt_home_addoth %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("HOMEADDOTH")) %>% 
  cols_label(n= md("**Number of Participants**"),Address = md("**Question**"), percentage = md("**%**")) %>% 
  #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address,
    )
  ) 






home_addsum1 <- Mod4 %>% filter(Mod4$D_290969423==104430631 | is.na(Mod4$D_290969423)) %>%  mutate(Address= case_when(is.na(D_869829679)~"Skipped if All Homes Lived In Were Reported"))

dt_home_addsum1 <- home_addsum1 %>% dplyr::group_by(Address) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address, n, percentage)
dt_home_addsum1 <- dt_home_addsum1[1,]


dt_home_addsum1 %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("HOMEADDSUM1")) %>% 
  cols_label(n= md("**Number of Participants**"),Address = md("**Question**"), percentage = md("**%**")) %>% 
  #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address,
    )
  ) 



```



## Home 2 Address
```{r Home2, warning=FALSE, echo=FALSE, message=FALSE}


Mod4$Street_Number <- Mod4$D_574985342_D_985267931
Mod4$Street_Name <- Mod4$D_574985342_D_111275683
Mod4$City <- Mod4$D_574985342_D_536516743
Mod4$State <- Mod4$D_574985342_D_283900560
Mod4$ZIP <- Mod4$D_574985342_D_467947502
Mod4$Country <- Mod4$D_574985342_D_368486703



home2 <- Mod4 %>% filter(Mod4$D_290969423==353358909| Mod4$D_869829679==270752953)
home2skip= home2 %>%  mutate(Address1= case_when(is.na(Street_Number) & is.na(Street_Name) & is.na(Apt_Number)& 
                                                       is.na(City) & is.na(State) & is.na(ZIP)& is.na(Country)~"Skipped Entire Address"))

dt_home2skip_summary <- home2skip %>% dplyr::group_by(Address1) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address1, n, percentage)
dt_home2skip_summary <- dt_home2skip_summary[1,]

dt_home2skip_summary[2,1] <- "Skipped Street Number" 
dt_home2skip_summary[2,2] <- sum(is.na(home2skip$Street_Number))
dt_home2skip_summary[2,3] <- (sum(is.na(home2skip$Street_Number))/dim(home2skip)[[1]])*100

dt_home2skip_summary[3,1] <- "Skipped Street Name" 
dt_home2skip_summary[3,2] <- sum(is.na(home2skip$Street_Name))
dt_home2skip_summary[3,3] <- (sum(is.na(home2skip$Street_Name))/dim(home2skip)[[1]])*100

dt_home2skip_summary[4,1] <- "Skipped City"
dt_home2skip_summary[4,2] <- sum(is.na(home2skip$City))
dt_home2skip_summary[4,3] <- (sum(is.na(home2skip$City))/dim(home2skip)[[1]])*100

dt_home2skip_summary[5,1] <- "Skipped State"
dt_home2skip_summary[5,2] <- sum(is.na(home2skip$State))
dt_home2skip_summary[5,3] <- (sum(is.na(home2skip$State))/dim(home2skip)[[1]])*100

dt_home2skip_summary[6,1] <- "Skipped ZIP"
dt_home2skip_summary[6,2] <- sum(is.na(home2skip$ZIP))
dt_home2skip_summary[6,3] <- (sum(is.na(home2skip$ZIP))/dim(home2skip)[[1]])*100

dt_home2skip_summary[7,1] <- "Skipped Country"
dt_home2skip_summary[7,2] <- sum(is.na(home2skip$Country))
dt_home2skip_summary[7,3] <- (sum(is.na(home2skip$Country))/dim(home2skip)[[1]])*100

dt_home2skip_summary %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Address 2 Components Skipped")) %>% 
  cols_label(n= md("**Number of Participants**"),Address1 = md("**Question**"), percentage = md("**%**")) %>% 
  #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address1,
    )
  ) 






Followup2_skip= home2 %>%  filter(home2$D_444145120_D_444145120!="[178420302]" & 
                                   (is.na(D_444145120_D_288498031) & is.na(D_574985342_D_536516743)) | 
                              (is.na(D_444145120_D_288498031) & is.na(D_574985342_D_536516743)) | 
                             (is.na(D_444145120_D_195845897) & is.na(D_574985342_D_283900560)) | 
                             (is.na(D_444145120_D_936129960) & is.na(D_574985342_D_467947502)) | 
                              (is.na(D_444145120_D_924583345) & is.na(D_574985342_D_368486703)) ) %>% 
  mutate(Address= case_when(is.na(D_444145120_D_288498031) & is.na(D_574985342_D_536516743) & 
                              is.na(D_444145120_D_288498031) & is.na(D_574985342_D_536516743) & 
                             is.na(D_444145120_D_195845897) & is.na(D_574985342_D_283900560) & 
                             is.na(D_444145120_D_936129960) & is.na(D_574985342_D_467947502) & 
                              is.na(D_444145120_D_924583345) & is.na(D_574985342_D_368486703)~"Skipped Entire Follow-up"))

Followup2__skip <- Followup2_skip %>% dplyr::group_by(Address) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address, n, percentage)
Followup2__skip <- Followup2__skip[1,]

Followup2__skip[2,1] <- "Skipped City Follow-up" 
Followup2__skip[2,2] <- sum(is.na(Followup2_skip$D_444145120_D_288498031) & is.na(Followup2_skip$D_574985342_D_536516743))
Followup2__skip[2,3] <- (sum(is.na(Followup2_skip$D_444145120_D_288498031) & is.na(Followup2_skip$D_574985342_D_536516743))/dim(Followup2_skip)[[1]])*100

Followup2__skip[3,1] <- "Skipped State Follow-up" 
Followup2__skip[3,2] <- sum(is.na(Followup2_skip$D_444145120_D_195845897) & is.na(Followup2_skip$D_574985342_D_283900560))
Followup2__skip[3,3] <- (sum(is.na(Followup2_skip$D_444145120_D_195845897) & is.na(Followup2_skip$D_574985342_D_283900560))/dim(Followup2_skip)[[1]])*100

Followup2__skip[4,1] <- "Skipped ZIP Follow-up"
Followup2__skip[4,2] <- sum(is.na(Followup2_skip$D_444145120_D_936129960) & is.na(Followup2_skip$D_574985342_D_467947502))
Followup2__skip[4,3] <- (sum(is.na(Followup2_skip$D_444145120_D_936129960) & is.na(Followup2_skip$D_574985342_D_467947502))/dim(Followup2_skip)[[1]])*100

Followup2__skip[5,1] <- "Skipped Country Follow-up"
Followup2__skip[5,2] <- sum(is.na(Followup2_skip$D_444145120_D_924583345) & is.na(Followup2_skip$D_574985342_D_368486703))
Followup2__skip[5,3] <- (sum(is.na(Followup2_skip$D_444145120_D_924583345) & is.na(Followup2_skip$D_574985342_D_368486703))/dim(Followup2_skip)[[1]])*100


Followup2__skip %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Address 2 Follow-up Skipped")) %>% 
  cols_label(n= md("**Number of Participants**"),Address = md("**Question**"), percentage = md("**%**")) %>% 
  #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address,
    )
  ) 





home_add3_2= home2 %>% #select(D_804504024_D_105043152, D_804504024_D_543135391) %>% 
  filter((is.na(home2$D_398762737_D_553357862) | is.na(home2$D_398762737_D_474541595)) & home2$D_398762737_D_398762737!="[178420302]" & 
            is.na(home2$D_574985342_D_985267931) & is.na(home2$D_574985342_D_111275683) & ((!is.na(home2$D_574985342_D_536516743) | !is.na(home2$D_574985342_D_283900560) | 
                                                                                            !is.na(home2$D_574985342_D_467947502) | !is.na(home2$D_574985342_D_368486703)) | 
                                                                                   (!is.na(home2$D_444145120_D_288498031) | !is.na(home2$D_444145120_D_195845897) |
                                                                                      !is.na(home2$D_444145120_D_936129960) |!is.na(home2$D_444145120_D_924583345))))

home_add3_2 <- home_add3_2 %>%  mutate(Address= case_when(is.na(D_398762737_D_553357862)~"Skipped Cross-Street 1"))

dt_home_add3_2 <- home_add3_2 %>% dplyr::group_by(Address) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address, n, percentage)
dt_home_add3_2 <- dt_home_add3_2[1,]

dt_home_add3_2[2,1] <- "Skipped Cross-Street 2" 
dt_home_add3_2[2,2] <- sum(is.na(home_add3_2$D_398762737_D_474541595))
dt_home_add3_2[2,3] <- (sum(is.na(home_add3_2$D_398762737_D_474541595))/dim(home_add3_2)[[1]])*100


dt_home_add3_2 %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Address 2 Cross-Streets")) %>% 
  cols_label(n= md("**Number of Participants**"),Address = md("**Question**"), percentage = md("**%**")) %>% 
  #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address,
    )
  ) 




home_addoth2 <- home2 %>%  mutate(Address= case_when(is.na(D_862052821)~"Skipped Providing any Additional Homes"))

dt_home_addoth2 <- home_addoth2 %>% dplyr::group_by(Address) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address, n, percentage)
dt_home_addoth2 <- dt_home_addoth2[1,]


dt_home_addoth2 %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("HOMEADDOTH2")) %>% 
  cols_label(n= md("**Number of Participants**"),Address = md("**Question**"), percentage = md("**%**")) %>% 
  #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address,
    )
  ) 






home_addsum2 <- home2 %>% filter(home2$d_452942800>=as.Date("2022-12-14") & (home2$D_862052821==104430631 | is.na(home2$D_862052821))) %>%  
  mutate(Address= case_when(is.na(D_845483079)~"Skipped if All Homes Lived In Were Reported"))

dt_home_addsum2 <- home_addsum2 %>% dplyr::group_by(Address) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address, n, percentage)
dt_home_addsum2 <- dt_home_addsum2[1,]


dt_home_addsum2 %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("HOMEADDSUM2")) %>% 
  cols_label(n= md("**Number of Participants**"),Address = md("**Question**"), percentage = md("**%**")) %>% 
  #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address,
    )
  ) 







```

## Home 3 Address 
```{r Home3, warning=FALSE, echo=FALSE, message=FALSE}

Mod4$Street_Number <- Mod4$D_828086036_D_875706715
Mod4$Street_Name <- Mod4$D_828086036_D_645150792
Mod4$City <- Mod4$D_828086036_D_588699608
Mod4$State <- Mod4$D_828086036_D_544692849
Mod4$ZIP <- Mod4$D_828086036_D_335435992
Mod4$Country <- Mod4$D_828086036_D_337088272



home3 <- Mod4 %>% filter(Mod4$D_862052821==353358909| Mod4$D_845483079==270752953)
home3skip= home3 %>%  mutate(Address1= case_when(is.na(Street_Number) & is.na(Street_Name) & is.na(City) & is.na(State)& is.na(ZIP)& is.na(Country) ~"Skipped Entire Address"))

dt_home3skip_summary <- home3skip %>% dplyr::group_by(Address1) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address1, n, percentage)
dt_home3skip_summary <- dt_home3skip_summary[1,]

dt_home3skip_summary[2,1] <- "Skipped Street Number" 
dt_home3skip_summary[2,2] <- sum(is.na(home3skip$Street_Number))
dt_home3skip_summary[2,3] <- (sum(is.na(home3skip$Street_Number))/dim(home3skip)[[1]])*100

dt_home3skip_summary[3,1] <- "Skipped Street Name" 
dt_home3skip_summary[3,2] <- sum(is.na(home3skip$Street_Name))
dt_home3skip_summary[3,3] <- (sum(is.na(home3skip$Street_Name))/dim(home3skip)[[1]])*100

dt_home3skip_summary[4,1] <- "Skipped City"
dt_home3skip_summary[4,2] <- sum(is.na(home3skip$City))
dt_home3skip_summary[4,3] <- (sum(is.na(home3skip$City))/dim(home3skip)[[1]])*100

dt_home3skip_summary[5,1] <- "Skipped State"
dt_home3skip_summary[5,2] <- sum(is.na(home3skip$State))
dt_home3skip_summary[5,3] <- (sum(is.na(home3skip$State))/dim(home3skip)[[1]])*100

dt_home3skip_summary[6,1] <- "Skipped ZIP"
dt_home3skip_summary[6,2] <- sum(is.na(home3skip$ZIP))
dt_home3skip_summary[6,3] <- (sum(is.na(home3skip$ZIP))/dim(home3skip)[[1]])*100

dt_home3skip_summary[6,1] <- "Skipped Country"
dt_home3skip_summary[6,2] <- sum(is.na(home3skip$Country))
dt_home3skip_summary[6,3] <- (sum(is.na(home3skip$Country))/dim(home3skip)[[1]])*100

dt_home3skip_summary %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Address 3 Components Skipped")) %>% 
  cols_label(n= md("**Number of Participants**"),Address1 = md("**Question**"), percentage = md("**%**")) %>% 
  #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address1,
    )
  ) 






Followup3_skip= home3 %>%  filter(home3$D_752101258_D_752101258!="[178420302]") %>% 
  mutate(Address= case_when(is.na(D_752101258_D_648495207) & is.na(D_828086036_D_588699608)~"Skipped All  Follow-up"))

Followup3__skip <- Followup3_skip %>% dplyr::group_by(Address) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address, n, percentage)
Followup3__skip <- Followup3__skip[1,]

Followup3__skip[2,1] <- "Skipped City Follow-up" 
Followup3__skip[2,2] <- sum(is.na(Followup3_skip$D_752101258_D_648495207) & is.na(Followup3_skip$D_828086036_D_588699608))
Followup3__skip[2,3] <- (sum(is.na(Followup3_skip$D_752101258_D_648495207) & is.na(Followup3_skip$D_828086036_D_588699608))/dim(Followup3_skip)[[1]])*100

Followup3__skip[3,1] <- "Skipped State Follow-up" 
Followup3__skip[3,2] <- sum(is.na(Followup3_skip$D_752101258_D_300933270) & is.na(Followup3_skip$D_828086036_D_544692849))
Followup3__skip[3,3] <- (sum(is.na(Followup3_skip$D_752101258_D_300933270) & is.na(Followup3_skip$D_828086036_D_544692849))/dim(Followup3_skip)[[1]])*100

Followup3__skip[4,1] <- "Skipped ZIP Follow-up"
Followup3__skip[4,2] <- sum(is.na(Followup3_skip$D_752101258_D_649864362) & is.na(Followup3_skip$D_828086036_D_335435992))
Followup3__skip[4,3] <- (sum(is.na(Followup3_skip$D_752101258_D_649864362) & is.na(Followup3_skip$D_828086036_D_335435992))/dim(Followup3_skip)[[1]])*100

Followup3__skip[5,1] <- "Skipped Country Follow-up"
Followup3__skip[5,2] <- sum(is.na(Followup3_skip$D_752101258_D_723108194) & is.na(Followup3_skip$D_828086036_D_337088272))
Followup3__skip[5,3] <- (sum(is.na(Followup3_skip$D_752101258_D_723108194) & is.na(Followup3_skip$D_828086036_D_337088272))/dim(Followup3_skip)[[1]])*100


Followup3__skip %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Address 3 Follow-up Skipped")) %>% 
  cols_label(n= md("**Number of Participants**"),Address = md("**Question**"), percentage = md("**%**")) %>% 
  #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address,
    )
  ) 





home_add3_3= home3 %>% #select(D_804504024_D_105043152, D_804504024_D_543135391) %>% 
  filter((is.na(home3$D_961572487_D_469679476) | is.na(home3$D_961572487_D_216954796)) & home3$D_961572487_D_961572487!="[178420302]" & 
            is.na(home3$D_828086036_D_875706715) & is.na(home3$D_828086036_D_645150792) & 
           ((!is.na(home3$D_828086036_D_588699608) | !is.na(home3$D_828086036_D_544692849) | 
               !is.na(home3$D_828086036_D_335435992) | !is.na(home3$D_828086036_D_337088272)) |
              (!is.na(home3$D_752101258_D_648495207) | !is.na(home3$D_752101258_D_300933270) |
                 !is.na(home3$D_752101258_D_649864362) |!is.na(home3$D_752101258_D_723108194))))

home_add3_3 <- home_add3_3 %>%  mutate(Address= case_when(is.na(D_961572487_D_469679476)~"Skipped Cross-Street 1"))

dt_home_add3_3 <- home_add3_3 %>% dplyr::group_by(Address) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address, n, percentage)
dt_home_add3_3 <- dt_home_add3_3[1,]

dt_home_add3_3[2,1] <- "Skipped Cross-Street 2" 
dt_home_add3_3[2,2] <- sum(is.na(home_add3_3$D_961572487_D_216954796))
dt_home_add3_3[2,3] <- (sum(is.na(home_add3_3$D_961572487_D_216954796))/dim(home_add3_3)[[1]])*100


dt_home_add3_3 %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Address 3 Cross-Streets")) %>% 
  cols_label(n= md("**Number of Participants**"),Address = md("**Question**"), percentage = md("**%**")) %>% 
  #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address,
    )
  ) 




home_addoth3 <- home3 %>%  mutate(Address= case_when(is.na(D_593146348)~"Skipped Providing any Additional Homes"))

dt_home_addoth3 <- home_addoth3 %>% dplyr::group_by(Address) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address, n, percentage)
dt_home_addoth3 <- dt_home_addoth3[1,]


dt_home_addoth3 %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("HOMEADDOTH3")) %>% 
  cols_label(n= md("**Number of Participants**"),Address = md("**Question**"), percentage = md("**%**")) %>% 
  #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address,
    )
  ) 






home_addsum3 <- home3 %>% filter(home3$d_452942800>=as.Date("2022-12-14") & (home3$D_593146348==104430631 | is.na(home3$D_593146348))) %>%  
  mutate(Address= case_when(is.na(D_736086261)~"Skipped if All Homes Lived In Were Reported"))

dt_home_addsum3 <- home_addsum3 %>% dplyr::group_by(Address) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address, n, percentage)
dt_home_addsum3 <- dt_home_addsum3[1,]


dt_home_addsum3 %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("HOMEADDSUM3")) %>% 
  cols_label(n= md("**Number of Participants**"),Address = md("**Question**"), percentage = md("**%**")) %>% 
  #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address,
    )
  ) 





```

## Home 4 Address
```{r Home4, warning=FALSE, echo=FALSE, message=FALSE}

Mod4$Street_Number <- Mod4$D_680046149_D_130174162
Mod4$Street_Name <- Mod4$D_680046149_D_563832508
Mod4$City <- Mod4$D_680046149_D_930511603
Mod4$State <- Mod4$D_680046149_D_756548442
Mod4$ZIP <- Mod4$D_680046149_D_455968200
Mod4$Country <- Mod4$D_680046149_D_728704613



home4 <- Mod4 %>% filter(Mod4$D_593146348==353358909 | Mod4$D_736086261==270752953)
home4skip= home4 %>%  mutate(Address1= case_when(is.na(Street_Number) & is.na(Street_Name)& is.na(City)& 
                                                   is.na(State)& is.na(ZIP)& is.na(Country)~"Skipped Entire Address"))

dt_home4skip_summary <- home4skip %>% dplyr::group_by(Address1) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address1, n, percentage)
dt_home4skip_summary <- dt_home4skip_summary[1,]

dt_home4skip_summary[2,1] <- "Skipped Street Number" 
dt_home4skip_summary[2,2] <- sum(is.na(home4skip$Street_Number))
dt_home4skip_summary[2,3] <- (sum(is.na(home4skip$Street_Number))/dim(home4skip)[[1]])*100

dt_home4skip_summary[3,1] <- "Skipped Street Name" 
dt_home4skip_summary[3,2] <- sum(is.na(home4skip$Street_Name))
dt_home4skip_summary[3,3] <- (sum(is.na(home4skip$Street_Name))/dim(home4skip)[[1]])*100

dt_home4skip_summary[4,1] <- "Skipped City"
dt_home4skip_summary[4,2] <- sum(is.na(home4skip$City))
dt_home4skip_summary[4,3] <- (sum(is.na(home4skip$City))/dim(home4skip)[[1]])*100

dt_home4skip_summary[5,1] <- "Skipped State"
dt_home4skip_summary[5,2] <- sum(is.na(home4skip$State))
dt_home4skip_summary[5,3] <- (sum(is.na(home4skip$State))/dim(home4skip)[[1]])*100

dt_home4skip_summary[6,1] <- "Skipped ZIP"
dt_home4skip_summary[6,2] <- sum(is.na(home4skip$ZIP))
dt_home4skip_summary[6,3] <- (sum(is.na(home4skip$ZIP))/dim(home4skip)[[1]])*100

dt_home4skip_summary[7,1] <- "Skipped Country"
dt_home4skip_summary[7,2] <- sum(is.na(home4skip$Country))
dt_home4skip_summary[7,3] <- (sum(is.na(home4skip$Country))/dim(home4skip)[[1]])*100

dt_home4skip_summary %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Address 4 Components Skipped")) %>% 
  cols_label(n= md("**Number of Participants**"),Address1 = md("**Question**"), percentage = md("**%**")) %>% 
  #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address1,
    )
  ) 






Followup4_skip= home4 %>%  filter(home4$D_879180101_D_879180101!="[178420302]") %>% 
  mutate(Address= case_when(is.na(D_879180101_D_931999203) & is.na(D_680046149_D_930511603)~"Skipped City Follow-up"))

Followup4__skip <- Followup4_skip %>% dplyr::group_by(Address) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address, n, percentage)
Followup4__skip <- Followup4__skip[1,]

Followup4__skip[2,1] <- "Skipped State Follow-up" 
Followup4__skip[2,2] <- sum(is.na(Followup4_skip$D_879180101_D_486511102) & is.na(Followup4_skip$D_680046149_D_756548442))
Followup4__skip[2,3] <- (sum(is.na(Followup4_skip$D_879180101_D_486511102) & is.na(Followup4_skip$D_680046149_D_756548442))/dim(Followup4_skip)[[1]])*100

Followup4__skip[3,1] <- "Skipped ZIP Follow-up"
Followup4__skip[3,2] <- sum(is.na(Followup4_skip$D_879180101_D_267027102) & is.na(Followup4_skip$D_680046149_D_455968200))
Followup4__skip[3,3] <- (sum(is.na(Followup4_skip$D_879180101_D_267027102) & is.na(Followup4_skip$D_680046149_D_455968200))/dim(Followup4_skip)[[1]])*100

Followup4__skip[4,1] <- "Skipped Country Follow-up"
Followup4__skip[4,2] <- sum(is.na(Followup4_skip$D_879180101_D_734345879) & is.na(Followup4_skip$D_680046149_D_728704613))
Followup4__skip[4,3] <- (sum(is.na(Followup4_skip$D_879180101_D_734345879) & is.na(Followup4_skip$D_680046149_D_728704613))/dim(Followup4_skip)[[1]])*100


Followup4__skip %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Address 4 Follow-up Skipped")) %>% 
  cols_label(n= md("**Number of Participants**"),Address = md("**Question**"), percentage = md("**%**")) %>% 
  #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address,
    )
  ) 





home_add3_4= home4 %>% #select(D_804504024_D_105043152, D_804504024_D_543135391) %>% 
  filter((is.na(home4$D_746604821_D_423713680) | is.na(home4$D_746604821_D_555767576)) & home4$D_746604821_D_746604821!="[178420302]" & 
            is.na(home4$D_680046149_D_130174162) & is.na(home4$D_680046149_D_563832508) & ((!is.na(home4$D_680046149_D_930511603) | !is.na(home4$D_680046149_D_756548442) | 
                                                                                            !is.na(home4$D_680046149_D_455968200) | !is.na(home4$D_680046149_D_728704613)) | 
                                                                                   (!is.na(home4$D_879180101_D_931999203) | !is.na(home4$D_879180101_D_486511102) |
                                                                                      !is.na(home4$D_879180101_D_267027102) |!is.na(home4$D_879180101_D_734345879))))

home_add3_4 <- home_add3_4 %>%  mutate(Address= case_when(is.na(D_746604821_D_423713680)~"Skipped Cross-Street 1"))

dt_home_add3_4 <- home_add3_4 %>% dplyr::group_by(Address) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address, n, percentage)
dt_home_add3_4 <- dt_home_add3_4[1,]

dt_home_add3_4[2,1] <- "Skipped Cross-Street 2" 
dt_home_add3_4[2,2] <- sum(is.na(home_add3_4$D_746604821_D_555767576))
dt_home_add3_4[2,3] <- (sum(is.na(home_add3_4$D_746604821_D_555767576))/dim(home_add3_4)[[1]])*100


dt_home_add3_4 %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Address 4 Cross-Streets")) %>% 
  cols_label(n= md("**Number of Participants**"),Address = md("**Question**"), percentage = md("**%**")) %>% 
  #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address,
    )
  ) 




home_addoth4 <- home4 %>%  mutate(Address= case_when(is.na(D_983592172)~"Skipped Providing any Additional Homes"))

dt_home_addoth4 <- home_addoth4 %>% dplyr::group_by(Address) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address, n, percentage)
dt_home_addoth4 <- dt_home_addoth4[1,]


dt_home_addoth4 %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("HOMEADDOTH4")) %>% 
  cols_label(n= md("**Number of Participants**"),Address = md("**Question**"), percentage = md("**%**")) %>% 
  #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address,
    )
  ) 






home_addsum4 <- home4 %>% filter(home4$d_452942800>=as.Date("2022-12-14") & (home4$D_983592172==104430631 | is.na(home4$D_983592172))) %>%  
  mutate(Address= case_when(is.na(D_294308065)~"Skipped if All Homes Lived In Were Reported"))

dt_home_addsum4 <- home_addsum4 %>% dplyr::group_by(Address) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address, n, percentage)
dt_home_addsum4 <- dt_home_addsum4[1,]


dt_home_addsum4 %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("HOMEADDSUM4")) %>% 
  cols_label(n= md("**Number of Participants**"),Address = md("**Question**"), percentage = md("**%**")) %>% 
  #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address,
    )
  ) 





```

## Home 5 Address
```{r Home5, warning=FALSE, echo=FALSE, message=FALSE}


Mod4$Street_Number <- Mod4$D_274189667_D_838725845
Mod4$Street_Name <- Mod4$D_274189667_D_565515774
Mod4$City <- Mod4$D_274189667_D_742177990
Mod4$State <- Mod4$D_274189667_D_843508307
Mod4$ZIP <- Mod4$D_274189667_D_554901696
Mod4$Country <- Mod4$D_274189667_D_819429013



home5 <- Mod4 %>% filter(Mod4$D_983592172==353358909 | Mod4$D_294308065==270752953)
home5skip= home5 %>%  mutate(Address1= case_when(is.na(Street_Number) & is.na(Street_Name) & is.na(City) & is.na(State) & is.na(ZIP) & is.na(Country)~"Skipped Entire Address"))

dt_home5skip_summary <- home5skip %>% dplyr::group_by(Address1) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address1, n, percentage)
dt_home5skip_summary <- dt_home5skip_summary[1,]

dt_home5skip_summary[2,1] <- "Skipped Street Number" 
dt_home5skip_summary[2,2] <- sum(is.na(home5skip$Street_Number))
dt_home5skip_summary[2,3] <- (sum(is.na(home5skip$Street_Number))/dim(home5skip)[[1]])*100

dt_home5skip_summary[3,1] <- "Skipped Street Name" 
dt_home5skip_summary[3,2] <- sum(is.na(home5skip$Street_Name))
dt_home5skip_summary[3,3] <- (sum(is.na(home5skip$Street_Name))/dim(home5skip)[[1]])*100

dt_home5skip_summary[4,1] <- "Skipped City"
dt_home5skip_summary[4,2] <- sum(is.na(home5skip$City))
dt_home5skip_summary[4,3] <- (sum(is.na(home5skip$City))/dim(home5skip)[[1]])*100

dt_home5skip_summary[5,1] <- "Skipped State"
dt_home5skip_summary[5,2] <- sum(is.na(home5skip$State))
dt_home5skip_summary[5,3] <- (sum(is.na(home5skip$State))/dim(home5skip)[[1]])*100

dt_home5skip_summary[6,1] <- "Skipped ZIP"
dt_home5skip_summary[6,2] <- sum(is.na(home5skip$ZIP))
dt_home5skip_summary[6,3] <- (sum(is.na(home5skip$ZIP))/dim(home5skip)[[1]])*100

dt_home5skip_summary[7,1] <- "Skipped Country"
dt_home5skip_summary[7,2] <- sum(is.na(home5skip$Country))
dt_home5skip_summary[7,3] <- (sum(is.na(home5skip$Country))/dim(home5skip)[[1]])*100

dt_home5skip_summary %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Address 5 Components Skipped")) %>% 
  cols_label(n= md("**Number of Participants**"),Address1 = md("**Question**"), percentage = md("**%**")) %>% 
  #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address1,
    )
  ) 






Followup5_skip= home5 %>%  filter(home5$D_212343294_D_212343294!="[178420302]") %>% 
  mutate(Address= case_when(is.na(D_212343294_D_445867902) & is.na(D_274189667_D_742177990)~"Skipped City Follow-up"))

Followup5__skip <- Followup5_skip %>% dplyr::group_by(Address) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address, n, percentage)
Followup5__skip <- Followup5__skip[1,]

Followup5__skip[2,1] <- "Skipped State Follow-up" 
Followup5__skip[2,2] <- sum(is.na(Followup5_skip$D_212343294_D_348049244) & is.na(Followup5_skip$D_274189667_D_843508307))
Followup5__skip[2,3] <- (sum(is.na(Followup5_skip$D_212343294_D_348049244) & is.na(Followup5_skip$D_274189667_D_843508307))/dim(Followup5_skip)[[1]])*100

Followup5__skip[3,1] <- "Skipped ZIP Follow-up"
Followup5__skip[3,2] <- sum(is.na(Followup5_skip$D_212343294_D_684217044) & is.na(Followup5_skip$D_274189667_D_554901696))
Followup5__skip[3,3] <- (sum(is.na(Followup5_skip$D_212343294_D_684217044) & is.na(Followup5_skip$D_274189667_D_554901696))/dim(Followup5_skip)[[1]])*100

Followup5__skip[4,1] <- "Skipped Country Follow-up"
Followup5__skip[4,2] <- sum(is.na(Followup5_skip$D_212343294_D_600319581) & is.na(Followup5_skip$D_274189667_D_819429013))
Followup5__skip[4,3] <- (sum(is.na(Followup5_skip$D_212343294_D_600319581) & is.na(Followup5_skip$D_274189667_D_819429013))/dim(Followup5_skip)[[1]])*100


Followup5__skip %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Address 5 Follow-up Skipped")) %>% 
  cols_label(n= md("**Number of Participants**"),Address = md("**Question**"), percentage = md("**%**")) %>% 
  #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address,
    )
  ) 





home_add3_5= home5 %>% #select(D_804504024_D_105043152, D_804504024_D_543135391) %>% 
  filter(home5$D_298296694_D_298296694!="[178420302]" & 
            is.na(home5$D_274189667_D_838725845) & is.na(home5$D_274189667_D_565515774) & ((!is.na(home5$D_274189667_D_742177990) | !is.na(home5$D_274189667_D_843508307) | 
                                                                                            !is.na(home5$D_274189667_D_554901696) | !is.na(home5$D_274189667_D_819429013)) | 
                                                                                   (!is.na(home5$D_212343294_D_445867902) | !is.na(home5$D_212343294_D_348049244) |
                                                                                      !is.na(home5$D_212343294_D_684217044) |!is.na(home5$D_212343294_D_600319581))))

home_add3_5 <- home_add3_5 %>%  mutate(Address= case_when(is.na(D_298296694_D_915527263)~"Skipped Cross-Street 1",
                                                          TRUE ~ "No Cross-Street 1 Skipping"))

dt_home_add3_5 <- home_add3_5 %>% dplyr::group_by(Address) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address, n, percentage)
dt_home_add3_5 <- dt_home_add3_5[1,]

dt_home_add3_5[2,1] <- "Skipped Cross-Street 2" 
dt_home_add3_5[2,2] <- sum(is.na(home_add3_5$D_298296694_D_325919807))
dt_home_add3_5[2,3] <- (sum(is.na(home_add3_5$D_298296694_D_325919807))/dim(home_add3_5)[[1]])*100

dt_home_add3_5 <- dt_home_add3_5[2,]
dt_home_add3_5 %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Address 5 Cross-Streets")) %>% 
  cols_label(n= md("**Number of Participants**"),Address = md("**Question**"), percentage = md("**%**")) %>% 
  #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address,
    )
  ) 




home_addoth6 <- home5 %>%  mutate(Address= case_when(is.na(D_776406200)~"Skipped Providing any Additional Homes"))

dt_home_addoth6 <- home_addoth6 %>% dplyr::group_by(Address) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address, n, percentage)
dt_home_addoth6 <- dt_home_addoth6[1,]


dt_home_addoth6 %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("HOMEADDOTH5")) %>% 
  cols_label(n= md("**Number of Participants**"),Address = md("**Question**"), percentage = md("**%**")) %>% 
  #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address,
    )
  ) 






home_addsum5 <- home5 %>% filter(home5$d_452942800>=as.Date("2022-12-14") & (home5$D_776406200==104430631 | is.na(home5$D_776406200))) %>%  
  mutate(Address= case_when(is.na(D_385583361)~"Skipped if All Homes Lived In Were Reported"))

dt_home_addsum5 <- home_addsum5 %>% dplyr::group_by(Address) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address, n, percentage)
dt_home_addsum5 <- dt_home_addsum5[1,]


dt_home_addsum5 %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("HOMEADDSUM5")) %>% 
  cols_label(n= md("**Number of Participants**"),Address = md("**Question**"), percentage = md("**%**")) %>% 
  #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address,
    )
  ) 





```

## Home 6 Address
```{r Home6, warning=FALSE, echo=FALSE, message=FALSE}

Mod4$Street_Number <- Mod4$D_113930886_D_306805272
Mod4$Street_Name <- Mod4$D_113930886_D_819844467
Mod4$City <- Mod4$D_113930886_D_418702418
Mod4$State <- Mod4$D_113930886_D_101219440
Mod4$ZIP <- Mod4$D_113930886_D_127963610
Mod4$Country <- Mod4$D_113930886_D_127963610



home6 <- Mod4 %>% filter(Mod4$D_776406200==353358909 | Mod4$D_385583361==270752953)
home6skip= home6 %>%  mutate(Address1= case_when(is.na(Street_Number)~"Skipped Street Number"))

dt_home6skip_summary <- home6skip %>% dplyr::group_by(Address1) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address1, n, percentage)
dt_home6skip_summary <- dt_home6skip_summary[1,]

dt_home6skip_summary[2,1] <- "Skipped Street Name" 
dt_home6skip_summary[2,2] <- sum(is.na(home6skip$Street_Name))
dt_home6skip_summary[2,3] <- (sum(is.na(home6skip$Street_Name))/dim(home6skip)[[1]])*100

dt_home6skip_summary[3,1] <- "Skipped City"
dt_home6skip_summary[3,2] <- sum(is.na(home6skip$City))
dt_home6skip_summary[3,3] <- (sum(is.na(home6skip$City))/dim(home6skip)[[1]])*100

dt_home6skip_summary[4,1] <- "Skipped State"
dt_home6skip_summary[4,2] <- sum(is.na(home6skip$State))
dt_home6skip_summary[4,3] <- (sum(is.na(home6skip$State))/dim(home6skip)[[1]])*100

dt_home6skip_summary[5,1] <- "Skipped ZIP"
dt_home6skip_summary[5,2] <- sum(is.na(home6skip$ZIP))
dt_home6skip_summary[5,3] <- (sum(is.na(home6skip$ZIP))/dim(home6skip)[[1]])*100

dt_home6skip_summary[6,1] <- "Skipped Country"
dt_home6skip_summary[6,2] <- sum(is.na(home6skip$Country))
dt_home6skip_summary[6,3] <- (sum(is.na(home6skip$Country))/dim(home6skip)[[1]])*100

dt_home6skip_summary %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Address 6 Components Skipped")) %>% 
  cols_label(n= md("**Number of Participants**"),Address1 = md("**Question**"), percentage = md("**%**")) %>% 
  #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address1,
    )
  ) 






Followup6_skip= home6 %>%  filter(home6$D_255474241_D_255474241!="[178420302]") %>% 
  mutate(Address= case_when(is.na(D_255474241_D_218334768) & is.na(D_113930886_D_418702418)~"Skipped City Follow-up"))

Followup6__skip <- Followup6_skip %>% dplyr::group_by(Address) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address, n, percentage)
Followup6__skip <- Followup6__skip[1,]

Followup6__skip[2,1] <- "Skipped State Follow-up" 
Followup6__skip[2,2] <- sum(is.na(Followup6_skip$D_255474241_D_394294282) & is.na(Followup6_skip$D_113930886_D_101219440))
Followup6__skip[2,3] <- (sum(is.na(Followup6_skip$D_255474241_D_394294282) & is.na(Followup6_skip$D_113930886_D_101219440))/dim(Followup6_skip)[[1]])*100

Followup6__skip[3,1] <- "Skipped ZIP Follow-up"
Followup6__skip[3,2] <- sum(is.na(Followup6_skip$D_255474241_D_803526907) & is.na(Followup6_skip$D_113930886_D_127963610))
Followup6__skip[3,3] <- (sum(is.na(Followup6_skip$D_255474241_D_803526907) & is.na(Followup6_skip$D_113930886_D_127963610))/dim(Followup6_skip)[[1]])*100

Followup6__skip[4,1] <- "Skipped Country Follow-up"
Followup6__skip[4,2] <- sum(is.na(Followup6_skip$D_255474241_D_941168091) & is.na(Followup6_skip$D_113930886_D_127963610))
Followup6__skip[4,3] <- (sum(is.na(Followup6_skip$D_255474241_D_941168091) & is.na(Followup6_skip$D_113930886_D_127963610))/dim(Followup6_skip)[[1]])*100


Followup6__skip %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Address 6 Follow-up Skipped")) %>% 
  cols_label(n= md("**Number of Participants**"),Address = md("**Question**"), percentage = md("**%**")) %>% 
  #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address,
    )
  ) 





home_add3_6= home6 %>% #select(D_804504024_D_105043152, D_804504024_D_543135391) %>% 
  filter(home6$D_205492848_D_205492848!="[178420302]" & 
            is.na(home6$D_113930886_D_306805272) & is.na(home6$D_113930886_D_819844467) & ((!is.na(home6$D_113930886_D_418702418) | !is.na(home6$D_113930886_D_101219440) | 
                                                                                            !is.na(home6$D_113930886_D_127963610) | !is.na(home6$D_113930886_D_127963610)) | 
                                                                                   (!is.na(home6$D_255474241_D_218334768) | !is.na(home6$D_255474241_D_394294282) |
                                                                                      !is.na(home6$D_255474241_D_803526907) |!is.na(home6$D_255474241_D_941168091))))

home_add3_6 <- home_add3_6 %>%  mutate(Address= case_when(is.na(D_205492848_D_756458580)~"Skipped Cross-Street 1",
                                                          TRUE ~ "No Cross-Street 1 Skipping"))

dt_home_add3_6 <- home_add3_6 %>% dplyr::group_by(Address) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address, n, percentage)
dt_home_add3_6 <- dt_home_add3_6[1,]

dt_home_add3_6[2,1] <- "Skipped Cross-Street 2" 
dt_home_add3_6[2,2] <- sum(is.na(home_add3_6$D_205492848_D_481599610))
dt_home_add3_6[2,3] <- (sum(is.na(home_add3_6$D_205492848_D_481599610))/dim(home_add3_6)[[1]])*100

dt_home_add3_6 <- dt_home_add3_6[2,]
dt_home_add3_6 %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Address 6 Cross-Streets")) %>% 
  cols_label(n= md("**Number of Participants**"),Address = md("**Question**"), percentage = md("**%**")) %>% 
  #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address,
    )
  ) 




home_addoth6 <- home6 %>%  mutate(Address= case_when(is.na(D_135207939)~"Skipped Providing any Additional Homes"))

dt_home_addoth6 <- home_addoth6 %>% dplyr::group_by(Address) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address, n, percentage)
dt_home_addoth6 <- dt_home_addoth6[1,]


dt_home_addoth6 %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("HOMEADDOTH6")) %>% 
  cols_label(n= md("**Number of Participants**"),Address = md("**Question**"), percentage = md("**%**")) %>% 
  #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address,
    )
  ) 






home_addsum6 <- home6 %>% filter(home6$d_452942800>=as.Date("2022-12-14") & (home6$D_135207939==104430631 | is.na(home6$D_135207939)) & is.na(D_768802173) ) %>%  
  mutate(Address= case_when(is.na(D_768802173)~"Skipped if All Homes Lived In Were Reported"))

dt_home_addsum6 <- home_addsum6 %>% dplyr::group_by(Address) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address, n, percentage)
dt_home_addsum6 <- dt_home_addsum6[1,]


dt_home_addsum6 %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("HOMEADDSUM6")) %>% 
  cols_label(n= md("**Number of Participants**"),Address = md("**Question**"), percentage = md("**%**")) %>% 
  #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address,
    )
  ) 


```

## Home Move In Move Out
```{r MoveInOut, warning=FALSE, echo=FALSE, message=FALSE}

#HOME1
home1_inout= Mod4 %>%  mutate(Answer= case_when(is.na(D_590222838) & 
                                                  !(is.na(D_121490150_D_255248624) & is.na(D_121490150_D_945532934) & is.na(D_121490150_D_469838242) &
                                                      is.na(D_121490150_D_303500597) & is.na(D_121490150_D_195068098) & is.na(D_121490150_D_202784871) &
                                                      is.na(D_121490150_D_831127170) ) ~"Skipped Home 1 Move-In Year"))

dt_home1_inout_summary <- home1_inout %>% dplyr::group_by(Answer) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Answer, n, percentage)
dt_home1_inout_summary <- dt_home1_inout_summary[1,]

# dt_home1_inout_summary[2,1] <- "Skipped Move-Out Year/Still Live t" 
# dt_home1_inout_summary[2,2] <- sum(is.na(home1_inout$D_728155643_D_943813942))
# dt_home1_inout_summary[2,3] <- (sum(is.na(home1_inout$D_728155643_D_943813942))/dim(home1_inout)[[1]])*100

dt_home1_inout_summary[2,1] <- "Skipped Home 1 Move-Out Year or Still Live There"
dt_home1_inout_summary[2,2] <- sum(is.na(home1_inout$D_728155643_D_728155643_D_678602069) & is.na(home1_inout$D_728155643_D_943813942))
dt_home1_inout_summary[2,3] <- (sum(is.na(home1_inout$D_728155643_D_728155643_D_678602069) & is.na(home1_inout$D_728155643_D_943813942))/dim(home1_inout)[[1]])*100


dt_home1_inout_summary %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Home 1 Move-In & Move-Out")) %>% 
  cols_label(n= md("**Number of Participants**"),Answer = md("**Question**"), percentage = md("**%**")) %>% 
  #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Answer,
    )
  ) 






#HOME2
home2_inout= Mod4 %>% filter(Mod4$D_290969423==353358909| Mod4$D_869829679==270752953) %>%  mutate(Answer= case_when(is.na(D_623452399)~"Skipped Home 2 Move-In Year"))

dt_home2_inout_summary <- home2_inout %>% dplyr::group_by(Answer) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Answer, n, percentage)
dt_home2_inout_summary <- dt_home2_inout_summary[1,]

dt_home2_inout_summary[2,1] <- "Skipped Home 2 Move-Out Year or Still Live There"
dt_home2_inout_summary[2,2] <- sum(is.na(home2_inout$D_380621340_D_380621340_D_678602069) & is.na(home2_inout$D_380621340_D_943813942))
dt_home2_inout_summary[2,3] <- (sum(is.na(home2_inout$D_380621340_D_380621340_D_678602069) & is.na(home2_inout$D_380621340_D_943813942))/dim(home2_inout)[[1]])*100


dt_home2_inout_summary %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Home 2 Move-In & Move-Out")) %>% 
  cols_label(n= md("**Number of Participants**"),Answer = md("**Question**"), percentage = md("**%**")) %>% 
  #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Answer,
    )
  ) 




#HOMEMOVEINOUT3
home3_inout= Mod4 %>% filter(Mod4$D_862052821==353358909| Mod4$D_845483079==270752953) %>% 
  mutate(Answer= case_when(is.na(D_876443676)~"Skipped Home 3 Move-In Year"))

dt_home3_inout_summary <- home3_inout %>% dplyr::group_by(Answer) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Answer, n, percentage)
dt_home3_inout_summary <- dt_home3_inout_summary[1,]

dt_home3_inout_summary[2,1] <- "Skipped Home 3 Move-Out Year or Still Live There"
dt_home3_inout_summary[2,2] <- sum(is.na(home3_inout$D_999694720_D_999694720_D_678602069) & is.na(home3_inout$D_999694720_D_943813942))
dt_home3_inout_summary[2,3] <- (sum(is.na(home3_inout$D_999694720_D_999694720_D_678602069) & is.na(home3_inout$D_999694720_D_943813942))/dim(home3_inout)[[1]])*100


dt_home3_inout_summary %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Home 3 Move-In & Move-Out")) %>% 
  cols_label(n= md("**Number of Participants**"),Answer = md("**Question**"), percentage = md("**%**")) %>% 
  #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Answer,
    )
  ) 




#HOMEMOVEINOUT4
home4_inout= Mod4 %>% filter(Mod4$D_593146348==353358909| Mod4$D_736086261==270752953) %>% 
  mutate(Answer= case_when(is.na(D_270587543)~"Skipped Home 4 Move-In Year"))

dt_home4_inout_summary <- home4_inout %>% dplyr::group_by(Answer) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Answer, n, percentage)
dt_home4_inout_summary <- dt_home4_inout_summary[1,]

dt_home4_inout_summary[2,1] <- "Skipped Home 4 Move-Out Year or Still Live There"
dt_home4_inout_summary[2,2] <- sum(is.na(home4_inout$D_849066624_D_849066624_D_678602069) & is.na(home4_inout$D_849066624_D_943813942))
dt_home4_inout_summary[2,3] <- (sum(is.na(home4_inout$D_849066624_D_849066624_D_678602069) & is.na(home4_inout$D_849066624_D_943813942))/dim(home4_inout)[[1]])*100


dt_home4_inout_summary %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Home 4 Move-In & Move-Out")) %>% 
  cols_label(n= md("**Number of Participants**"),Answer = md("**Question**"), percentage = md("**%**")) %>% 
  #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Answer,
    )
  ) 



#HOMEMOVEINOUT5
home5_inout= Mod4 %>% filter(Mod4$D_983592172==353358909| Mod4$D_294308065==270752953) %>% 
  mutate(Answer= case_when(is.na(D_195167143)~"Skipped Home 5 Move-In Year"))

dt_home5_inout_summary <- home5_inout %>% dplyr::group_by(Answer) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Answer, n, percentage)
dt_home5_inout_summary <- dt_home5_inout_summary[1,]

dt_home5_inout_summary[2,1] <- "Skipped Home 5 Move-Out Year or Still Live There"
dt_home5_inout_summary[2,2] <- sum(is.na(home5_inout$D_425315696_D_425315696_D_678602069) & is.na(home5_inout$D_425315696_D_943813942))
dt_home5_inout_summary[2,3] <- (sum(is.na(home5_inout$D_425315696_D_425315696_D_678602069) & is.na(home5_inout$D_425315696_D_943813942))/dim(home5_inout)[[1]])*100


dt_home5_inout_summary %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Home 5 Move-In & Move-Out")) %>% 
  cols_label(n= md("**Number of Participants**"),Answer = md("**Question**"), percentage = md("**%**")) %>% 
  #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Answer,
    )
  ) 



#HOMEMOVEINOUT6
home6_inout= Mod4 %>% filter(Mod4$D_776406200==353358909| Mod4$D_385583361==270752953) %>% 
  mutate(Answer= case_when(is.na(D_495330716)~"Skipped Home 5 Move-In Year"))

dt_home6_inout_summary <- home6_inout %>% dplyr::group_by(Answer) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Answer, n, percentage)
dt_home6_inout_summary <- dt_home6_inout_summary[1,]

dt_home6_inout_summary[2,1] <- "Skipped Home 5 Move-Out Year or Still Live There"
dt_home6_inout_summary[2,2] <- sum(is.na(home6_inout$D_529608184_D_529608184_D_678602069) & is.na(home6_inout$D_529608184_D_943813942))
dt_home6_inout_summary[2,3] <- (sum(is.na(home6_inout$D_529608184_D_529608184_D_678602069) & is.na(home6_inout$D_529608184_D_943813942))/dim(home6_inout)[[1]])*100


dt_home6_inout_summary %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Home 5 Move-In & Move-Out")) %>% 
  cols_label(n= md("**Number of Participants**"),Answer = md("**Question**"), percentage = md("**%**")) %>% 
  #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Answer,
    )
  )




```

## Home Water Source
```{r HomeWater, warning=FALSE, echo=FALSE, message=FALSE}

#Home 1
home1_water= Mod4 %>%  mutate(Address1= case_when(is.na(D_958419506_D_958419506) & is.na(D_958419506_D_799451743)~"Skipped HOMEWTR1_1"))

dt_home1_water_summary <- home1_water %>% dplyr::group_by(Address1) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address1, n, percentage)
dt_home1_water_summary <- dt_home1_water_summary[1,]

dt_home1_water_summary[2,1] <- "Skipped HOMEWTR2_1" 
well1 <- home1_water %>% filter(D_958419506_D_958419506==388690303)
dt_home1_water_summary[2,2] <- sum(is.na(well1$D_725408440))
dt_home1_water_summary[2,3] <- (sum(is.na(well1$D_725408440))/dim(well1)[[1]])*100

dt_home1_water_summary[3,1] <- "Skipped HOMEWTR3_1" 
dt_home1_water_summary[3,2] <- sum(is.na(home1_water$D_539909957_D_539909957) & is.na(home1_water$D_539909957_D_994632550))
dt_home1_water_summary[3,3] <- (sum(is.na(home1_water$D_539909957_D_539909957) & is.na(home1_water$D_539909957_D_994632550))/dim(home1_water)[[1]])*100


dt_home1_water_summary %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Primary Water Sources of Home 1")) %>% 
  cols_label(n= md("**Number of Participants**"),Address1 = md("**Question**"), percentage = md("**%**")) %>% 
  #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address1,
    )
  ) 



#Home 2
home2_water= Mod4 %>%  filter(Mod4$D_290969423==353358909| Mod4$D_869829679==270752953) %>% 
  mutate(Address1= case_when(is.na(D_505863509_D_505863509) & is.na(D_505863509_D_441314504)~"Skipped HOMEWTR1_2"))

dt_home2_water_summary <- home2_water %>% dplyr::group_by(Address1) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address1, n, percentage)
dt_home2_water_summary <- dt_home2_water_summary[1,]

dt_home2_water_summary[2,1] <- "Skipped HOMEWTR2_2" 
well2 <- home2_water %>% filter(D_505863509_D_505863509==388690303)
dt_home2_water_summary[2,2] <- sum(is.na(well2$D_651233069))
dt_home2_water_summary[2,3] <- (sum(is.na(well2$D_651233069))/dim(home2_water)[[1]])*100

dt_home2_water_summary[3,1] <- "Skipped HOMEWTR3_2" 
dt_home2_water_summary[3,2] <- sum(is.na(home2_water$D_250486386_D_250486386) & is.na(home2_water$D_250486386_D_224594497))
dt_home2_water_summary[3,3] <- (sum(is.na(home2_water$D_250486386_D_250486386) & is.na(home2_water$D_250486386_D_224594497))/dim(well2)[[1]])*100


dt_home2_water_summary %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Primary Water Sources of Home 2")) %>% 
  cols_label(n= md("**Number of Participants**"),Address1 = md("**Question**"), percentage = md("**%**")) %>% 
  #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address1,
    )
  ) 




#Home3
home3_water= Mod4 %>%  filter(Mod4$D_862052821==353358909| Mod4$D_845483079==270752953) %>% 
  mutate(Address1= case_when(is.na(D_957717014_D_957717014) & is.na(D_957717014_D_984805254)~"Skipped HOMEWTR1_3"))

dt_home3_water_summary <- home3_water %>% dplyr::group_by(Address1) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address1, n, percentage)
dt_home3_water_summary <- dt_home3_water_summary[1,]

dt_home3_water_summary[2,1] <- "Skipped HOMEWTR2_3"
well3 <- home3_water %>% filter(D_957717014_D_957717014==388690303)
dt_home3_water_summary[2,2] <- sum(is.na(well3$D_809387606))
dt_home3_water_summary[2,3] <- (sum(is.na(well3$D_809387606))/dim(well3)[[1]])*100

dt_home3_water_summary[3,1] <- "Skipped HOMEWTR3_3" 
dt_home3_water_summary[3,2] <- sum(is.na(home3_water$D_726654963_D_726654963) & is.na(home3_water$D_726654963_D_276249147))
dt_home3_water_summary[3,3] <- (sum(is.na(home3_water$D_726654963_D_726654963) & is.na(home3_water$D_726654963_D_276249147))/dim(home3_water)[[1]])*100


dt_home3_water_summary %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Primary Water Sources of Home 3")) %>% 
  cols_label(n= md("**Number of Participants**"),Address1 = md("**Question**"), percentage = md("**%**")) %>% 
  #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address1,
    )
  ) 



#home4
home4_water= Mod4 %>%  filter(Mod4$D_593146348==353358909| Mod4$D_736086261==270752953) %>% 
  mutate(Address1= case_when(is.na(D_195367894_D_195367894) & is.na(D_195367894_D_300611347)~"Skipped HOMEWTR1_4"))

dt_home4_water_summary <- home4_water %>% dplyr::group_by(Address1) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address1, n, percentage)
dt_home4_water_summary <- dt_home4_water_summary[1,]

dt_home4_water_summary[2,1] <- "Skipped HOMEWTR2_4" 
well4 <- home4_water %>% filter(D_195367894_D_195367894==388690303)
dt_home4_water_summary[2,2] <- sum(is.na(well4$D_428044531))
dt_home4_water_summary[2,3] <- (sum(is.na(well4$D_428044531))/dim(well4)[[1]])*100

dt_home4_water_summary[3,1] <- "Skipped HOMEWTR3_4" 
dt_home4_water_summary[3,2] <- sum(is.na(home4_water$D_934184033_D_934184033) & is.na(home4_water$D_934184033_D_675539614))
dt_home4_water_summary[3,3] <- (sum(is.na(home4_water$D_934184033_D_934184033) & is.na(home4_water$D_934184033_D_675539614))/dim(home4_water)[[1]])*100


dt_home4_water_summary %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Primary Water Sources of Home 4")) %>% 
  cols_label(n= md("**Number of Participants**"),Address1 = md("**Question**"), percentage = md("**%**")) %>% 
  #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address1,
    )
  ) 





#Home5
home5_water= Mod4 %>%  filter(Mod4$D_983592172==353358909| Mod4$D_294308065==270752953) %>% 
  mutate(Address1= case_when(is.na(D_986989731_D_986989731) & is.na(D_195367894_D_300611347)~"Skipped HOMEWTR1_5"))

dt_home5_water_summary <- home5_water %>% dplyr::group_by(Address1) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address1, n, percentage)
dt_home5_water_summary <- dt_home5_water_summary[1,]

dt_home5_water_summary[2,1] <- "Skipped HOMEWTR2_5" 
well5 <- home5_water %>% filter(D_986989731_D_986989731==388690303)
dt_home5_water_summary[2,2] <- sum(is.na(well5$D_441498892))
dt_home5_water_summary[2,3] <- (sum(is.na(well5$D_441498892))/dim(well5)[[1]])*100

dt_home5_water_summary[3,1] <- "Skipped HOMEWTR3_5" 
dt_home5_water_summary[3,2] <- sum(is.na(home5_water$D_508187475_D_508187475) & is.na(home5_water$D_508187475_D_209510432))
dt_home5_water_summary[3,3] <- (sum(is.na(home5_water$D_508187475_D_508187475) & is.na(home5_water$D_508187475_D_209510432))/dim(home5_water)[[1]])*100


dt_home5_water_summary %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Primary Water Sources of Home 5")) %>% 
  cols_label(n= md("**Number of Participants**"),Address1 = md("**Question**"), percentage = md("**%**")) %>% 
  #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address1,
    )
  ) 



#Home 6
home6_water= Mod4 %>%  filter(Mod4$D_776406200==353358909| Mod4$D_385583361==270752953) %>% 
  mutate(Address1= case_when(is.na(D_665978055_D_665978055) & is.na(D_665978055_D_513925041)~"Skipped HOMEWTR1_6"))

dt_home6_water_summary <- home6_water %>% dplyr::group_by(Address1) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address1, n, percentage)
dt_home6_water_summary <- dt_home6_water_summary[1,]

dt_home6_water_summary[2,1] <- "Skipped HOMEWTR2_6" 
well6 <- home6_water %>% filter(D_665978055_D_665978055==388690303)
dt_home6_water_summary[2,2] <- sum(is.na(well6$D_441498892))
dt_home6_water_summary[2,3] <- (sum(is.na(well6$D_441498892))/dim(well6)[[1]])*100

dt_home6_water_summary[3,1] <- "Skipped HOMEWTR3_6" 
dt_home6_water_summary[3,2] <- sum(is.na(home6_water$D_933017499_D_933017499) & is.na(home6_water$D_933017499_D_980497607))
dt_home6_water_summary[3,3] <- (sum(is.na(home6_water$D_933017499_D_933017499) & is.na(home6_water$D_933017499_D_980497607))/dim(home6_water)[[1]])*100


dt_home6_water_summary %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Primary Water Sources of Home 6")) %>% 
  cols_label(n= md("**Number of Participants**"),Address1 = md("**Question**"), percentage = md("**%**")) %>% 
  #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address1,
    )
  ) 




```

## Seasonal Homes
### Season Home 1
```{r Seasonal, warning=FALSE, echo=FALSE, message=FALSE}
## Sea Home Address ##
sea_home= Mod4 %>%  
  mutate(Address1= case_when(is.na(D_342677547)~"Skipped SEASHOME"))

dt_sea_home_summary <- sea_home %>% dplyr::group_by(Address1) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address1, n, percentage)
dt_sea_home_summary <- dt_sea_home_summary[1,]

dt_sea_home_summary %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Seasonal or Vacation Home")) %>% 
  cols_label(n= md("**Number of Participants**"),Address1 = md("**Question**"), percentage = md("**%**")) %>% 
  #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address1,
    )
  ) 


#SEAADDSUM1_1
sea_home= Mod4 %>% filter(Mod4$D_342677547==104430631) %>%  
  mutate(Address1= case_when(is.na(D_710449106)~"Skipped SEAASDSUM1"))

dt_sea_home_summary <- sea_home %>% dplyr::group_by(Address1) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address1, n, percentage)
dt_sea_home_summary <- dt_sea_home_summary[1,]

dt_sea_home_summary %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Confirm No Seasonal or Vacation Home")) %>% 
  cols_label(n= md("**Number of Participants**"),Address1 = md("**Question**"), percentage = md("**%**")) %>% 
  #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address1,
    )
  ) 



#Sea Home 1 -- country removed
seahome_add1_1 <- Mod4 %>%  filter(Mod4$D_342677547==353358909)
seahome_add1_1= seahome_add1_1 %>%  mutate(Address1= case_when(is.na(D_376408004_D_234037089)~"Skipped Street Number"))

dt_seahome_add1_1_summary <- seahome_add1_1 %>% dplyr::group_by(Address1) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address1, n, percentage)
dt_seahome_add1_1_summary <- dt_seahome_add1_1_summary[1,]

dt_seahome_add1_1_summary[2,1] <- "Skipped Street Name" 
dt_seahome_add1_1_summary[2,2] <- sum(is.na(seahome_add1_1$D_376408004_D_416862112))
dt_seahome_add1_1_summary[2,3] <- (sum(is.na(seahome_add1_1$D_376408004_D_416862112))/dim(seahome_add1_1)[[1]])*100

dt_seahome_add1_1_summary[3,1] <- "Skipped City"
dt_seahome_add1_1_summary[3,2] <- sum(is.na(seahome_add1_1$D_376408004_D_556576930))
dt_seahome_add1_1_summary[3,3] <- (sum(is.na(seahome_add1_1$D_376408004_D_556576930))/dim(seahome_add1_1)[[1]])*100

dt_seahome_add1_1_summary[4,1] <- "Skipped State"
dt_seahome_add1_1_summary[4,2] <- sum(is.na(seahome_add1_1$D_376408004_D_304326324))
dt_seahome_add1_1_summary[4,3] <- (sum(is.na(seahome_add1_1$D_376408004_D_304326324))/dim(seahome_add1_1)[[1]])*100

dt_seahome_add1_1_summary[5,1] <- "Skipped ZIP"
dt_seahome_add1_1_summary[5,2] <- sum(is.na(seahome_add1_1$D_376408004_D_812433386))
dt_seahome_add1_1_summary[5,3] <- (sum(is.na(seahome_add1_1$D_376408004_D_812433386))/dim(seahome_add1_1)[[1]])*100


dt_seahome_add1_1_summary %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Vacation Home 1 Address Components Skipped")) %>% 
  cols_label(n= md("**Number of Participants**"),Address1 = md("**Question**"), percentage = md("**%**")) %>% 
  #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address1,
    )
  ) 






FollowupV1_skip= seahome_add1_1 %>%  filter(seahome_add1_1$D_173413183_D_173413183!="[178420302]") %>% 
  mutate(Address= case_when(is.na(D_173413183_D_416620941) & is.na(D_376408004_D_556576930)~"Skipped City Follow-up"))

FollowupV1__skip <- FollowupV1_skip %>% dplyr::group_by(Address) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address, n, percentage)
FollowupV1__skip <- FollowupV1__skip[1,]

FollowupV1__skip[2,1] <- "Skipped State Follow-up" 
FollowupV1__skip[2,2] <- sum(is.na(FollowupV1_skip$D_173413183_D_915859406) & is.na(FollowupV1_skip$D_376408004_D_304326324))
FollowupV1__skip[2,3] <- (sum(is.na(FollowupV1_skip$D_173413183_D_915859406) & is.na(FollowupV1_skip$D_376408004_D_304326324))/dim(FollowupV1_skip)[[1]])*100

FollowupV1__skip[3,1] <- "Skipped ZIP Follow-up"
FollowupV1__skip[3,2] <- sum(is.na(FollowupV1_skip$D_173413183_D_354833686) & is.na(FollowupV1_skip$D_376408004_D_812433386))
FollowupV1__skip[3,3] <- (sum(is.na(FollowupV1_skip$D_173413183_D_354833686) & is.na(FollowupV1_skip$D_376408004_D_812433386))/dim(FollowupV1_skip)[[1]])*100

FollowupV1__skip <- FollowupV1__skip[c(2,3),] #no one skipped city follow up so for now I'm leaving it out

FollowupV1__skip %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Vacation Home Address 1 Follow-up Skipped")) %>% 
  cols_label(n= md("**Number of Participants**"),Address = md("**Question**"), percentage = md("**%**")) %>% 
  #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address,
    )
  ) 






seahome_add3_1= Mod4 %>% 
  filter(is.na(Mod4$D_376408004_D_234037089) & is.na(Mod4$D_376408004_D_416862112) & 
           Mod4$D_342677547==353358909 & Mod4$D_200086909_D_200086909!="[178420302]" &
           ((!is.na(Mod4$D_376408004_D_556576930) | !is.na(Mod4$D_376408004_D_304326324) |!is.na(Mod4$D_376408004_D_812433386)) | 
              (!is.na(Mod4$D_173413183_D_416620941) | !is.na(Mod4$D_173413183_D_915859406) |!is.na(Mod4$D_173413183_D_354833686))))

seahome_add3_1 <- seahome_add3_1 %>% mutate(Address= case_when(is.na(D_200086909_D_351319555)~"Skipped Cross-Street1"))

seahome_add3_1__skip <- seahome_add3_1 %>% dplyr::group_by(Address) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address, n, percentage)
seahome_add3_1__skip <- seahome_add3_1__skip[1,]

seahome_add3_1__skip[2,1] <- "Skipped Cross-Street2" 
seahome_add3_1__skip[2,2] <- sum(is.na(seahome_add3_1$D_200086909_D_154163153))
seahome_add3_1__skip[2,3] <- (sum(is.na(seahome_add3_1$D_200086909_D_154163153))/dim(seahome_add3_1)[[1]])*100

seahome_add3_1__skip <- seahome_add3_1__skip[2,]
seahome_add3_1__skip %>%  gt::gt() %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Vacation Home Address 1 Cross-Streets Skipped")) %>% 
  cols_label(n= md("**Number of Participants**"),Address = md("**Question**"), percentage = md("**%**")) %>% 
  #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address,
    )
  )




  #SEASADDOTH1
seaaddoth= seahome_add1_1 %>%  
  mutate(Address1= case_when(is.na(D_576956950)~"Skipped SEAHOMEADDOTH1"))

dt_seaaddoth_summary <- seaaddoth %>% dplyr::group_by(Address1) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address1, n, percentage)
dt_seaaddoth_summary <- dt_seaaddoth_summary[1,]

dt_seaaddoth_summary %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Skipped if Other Vacation Homes Stayed At")) %>% 
  cols_label(n= md("**Number of Participants**"),Address1 = md("**Question**"), percentage = md("**%**")) %>% 
  #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address1,
    )
  ) 



#SEADDSUM1
seaaddsum1= seahome_add1_1 %>% filter(seahome_add1_1$D_576956950!=353358909) %>% 
  mutate(Address1= case_when(is.na(D_512143997)~"Skipped SEADDSUM1"))

dt_seaaddsum1_summary <- seaaddsum1 %>% dplyr::group_by(Address1) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address1, n, percentage)
dt_seaaddsum1_summary <- dt_seaaddsum1_summary[1,]

dt_seaaddsum1_summary %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Skipped Confirmation of Complete Vacation Homes List")) %>% 
  cols_label(n= md("**Number of Participants**"),Address1 = md("**Question**"), percentage = md("**%**")) %>% 
  #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address1,
    )
  )



```

### Seasonal Home Move in and Move Out
```{r SeaInOut, warning=FALSE, echo=FALSE, message=FALSE}
  #SEASADDSUM2_1

SEASADDYRS= seahome_add1_1 %>%  mutate(Address1= case_when(is.na(D_379754686)~"Skipped First Year"))

dt_SEASADDYRS_summary <- SEASADDYRS %>% dplyr::group_by(Address1) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address1, n, percentage)
dt_SEASADDYRS_summary <- dt_SEASADDYRS_summary[1,]

dt_SEASADDYRS_summary[2,1] <- "Skipped Last Year Spent There" 
dt_SEASADDYRS_summary[2,2] <- sum(is.na(SEASADDYRS$D_975198123_D_314198277) & is.na(SEASADDYRS$D_975198123_D_975198123_D_196962759))
dt_SEASADDYRS_summary[2,3] <- (sum(is.na(SEASADDYRS$D_975198123_D_314198277) & is.na(SEASADDYRS$D_975198123_D_975198123_D_196962759))/dim(SEASADDYRS)[[1]])*100

dt_SEASADDYRS_summary[3,1] <- "Skipped Months Per Year There"
dt_SEASADDYRS_summary[3,2] <- sum(is.na(SEASADDYRS$D_860269869_D_451310566) & is.na(SEASADDYRS$D_860269869_D_860269869_D_232063618))
dt_SEASADDYRS_summary[3,3] <- (sum(is.na(SEASADDYRS$D_860269869_D_451310566) & is.na(SEASADDYRS$D_860269869_D_860269869_D_232063618))/dim(SEASADDYRS)[[1]])*100


dt_SEASADDYRS_summary %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Years and Months at Vacation Home 1")) %>% 
  cols_label(n= md("**Number of Participants**"),Address1 = md("**Question**"), percentage = md("**%**")) %>% 
  #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address1,
    )
  ) 


```

### Seasonal Home Water Source
```{r SeaWater, warning=FALSE, echo=FALSE, message=FALSE}
## Sea Home Water ##
seahome_water= seahome_add1_1 %>%  
  mutate(Address1= case_when(is.na(D_426743354_D_426743354) & is.na(D_426743354_D_490504789)~"Skipped SEASWTR1_1"))

dt_seahome_water_summary <- seahome_water %>% dplyr::group_by(Address1) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address1, n, percentage)
dt_seahome_water_summary <- dt_seahome_water_summary[1,]

dt_seahome_water_summary[2,1] <- "Skipped SEASWTR2_1" 
dt_seahome_water_summary[2,2] <- sum(is.na(seahome_water$D_809682067) & is.na(seahome_water$D_426743354_D_426743354==388690303))
dt_seahome_water_summary[2,3] <- (sum(is.na(seahome_water$D_809682067) & is.na(seahome_water$D_426743354_D_426743354==388690303))/dim(seahome_water)[[1]])*100

dt_seahome_water_summary[3,1] <- "Skipped SEASWTR3_1"
dt_seahome_water_summary[3,2] <- sum(is.na(seahome_water$D_598478268_D_598478268) & is.na(seahome_water$D_598478268_D_670605457))
dt_seahome_water_summary[3,3] <- (sum(is.na(seahome_water$D_598478268_D_598478268) & is.na(seahome_water$D_598478268_D_670605457))/dim(seahome_water)[[1]])*100


dt_seahome_water_summary %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Vacation Home 1 Water Sources")) %>% 
  cols_label(n= md("**Number of Participants**"),Address1 = md("**Question**"), percentage = md("**%**")) %>% 
  #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address1,
    )
  ) 


```

## Childhood Home
### Childhood Address
```{r Childhood, warning=FALSE, echo=FALSE, message=FALSE}
#Home1
childhome= Mod4 %>%  filter(Mod4$D_277348878==751569137) %>% 
  mutate(Address1= case_when(is.na(D_632533534_D_284547539) & is.na(D_632533534_D_802585033) & is.na(D_632533534_D_128827522) & is.na(D_632533534_D_439447560) & 
                             is.na(D_632533534_D_286781627) & is.na(D_632533534_D_733929451) ~"Skipped Entire Address"))

dt_childhome_summary <- childhome %>% dplyr::group_by(Address1) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address1, n, percentage)
dt_childhome_summary <- dt_childhome_summary[1,]

dt_childhome_summary[2,1] <- "Skipped Street Number" 
dt_childhome_summary[2,2] <- sum(is.na(childhome$D_632533534_D_284547539))
dt_childhome_summary[2,3] <- (sum(is.na(childhome$D_632533534_D_284547539))/dim(childhome)[[1]])*100

dt_childhome_summary[2,1] <- "Skipped Street Name" 
dt_childhome_summary[2,2] <- sum(is.na(childhome$D_632533534_D_802585033))
dt_childhome_summary[2,3] <- (sum(is.na(childhome$D_632533534_D_802585033))/dim(childhome)[[1]])*100

dt_childhome_summary[3,1] <- "Skipped City"
dt_childhome_summary[3,2] <- sum(is.na(childhome$D_632533534_D_128827522))
dt_childhome_summary[3,3] <- (sum(is.na(childhome$D_632533534_D_128827522))/dim(childhome)[[1]])*100

dt_childhome_summary[4,1] <- "Skipped State"
dt_childhome_summary[4,2] <- sum(is.na(childhome$D_632533534_D_439447560))
dt_childhome_summary[4,3] <- (sum(is.na(childhome$D_632533534_D_439447560))/dim(childhome)[[1]])*100

dt_childhome_summary[5,1] <- "Skipped ZIP"
dt_childhome_summary[5,2] <- sum(is.na(childhome$D_632533534_D_286781627))
dt_childhome_summary[5,3] <- (sum(is.na(childhome$D_632533534_D_286781627))/dim(childhome)[[1]])*100

dt_childhome_summary[6,1] <- "Skipped Country"
dt_childhome_summary[6,2] <- sum(is.na(childhome$D_632533534_D_733929451))
dt_childhome_summary[6,3] <- (sum(is.na(childhome$D_632533534_D_733929451))/dim(childhome)[[1]])*100


dt_childhome_summary %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Childhood Address Components")) %>% 
  cols_label(n= md("**Number of Participants**"),Address1 = md("**Question**"), percentage = md("**%**")) %>% 
  #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address1,
    )
  ) 




FollowupC1_skip= childhome %>%  filter(childhome$D_264797252_D_264797252!="[178420302]") %>% 
  mutate(Address= case_when(is.na(D_632533534_D_128827522) & is.na(D_264797252_D_890792569)~"Skipped City Follow-up"))

FollowupC1__skip <- FollowupC1_skip %>% dplyr::group_by(Address) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address, n, percentage)
FollowupC1__skip <- FollowupC1__skip[1,]

FollowupC1__skip[2,1] <- "Skipped State Follow-up" 
FollowupC1__skip[2,2] <- sum(is.na(FollowupC1_skip$D_632533534_D_439447560) & is.na(FollowupC1_skip$D_264797252_D_451394598))
FollowupC1__skip[2,3] <- (sum(is.na(FollowupC1_skip$D_632533534_D_439447560) & is.na(FollowupC1_skip$D_264797252_D_451394598))/dim(FollowupC1_skip)[[1]])*100

FollowupC1__skip[3,1] <- "Skipped ZIP Follow-up"
FollowupC1__skip[3,2] <- sum(is.na(FollowupC1_skip$D_632533534_D_286781627) & is.na(FollowupC1_skip$D_264797252_D_984908796))
FollowupC1__skip[3,3] <- (sum(is.na(FollowupC1_skip$D_632533534_D_286781627) & is.na(FollowupC1_skip$D_264797252_D_984908796))/dim(FollowupC1_skip)[[1]])*100

FollowupC1__skip[4,1] <- "Skipped Country Follow-up"
FollowupC1__skip[4,2] <- sum(is.na(FollowupC1_skip$D_632533534_D_733929451) & is.na(FollowupC1_skip$D_264797252_D_847327251))
FollowupC1__skip[4,3] <- (sum(is.na(FollowupC1_skip$D_632533534_D_733929451) & is.na(FollowupC1_skip$D_264797252_D_847327251))/dim(FollowupC1_skip)[[1]])*100


FollowupC1__skip %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Childhood Home Address Follow-up Skipped")) %>% 
  cols_label(n= md("**Number of Participants**"),Address = md("**Question**"), percentage = md("**%**")) %>% 
  #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address,
    )
  ) 




child_add3_1= childhome %>% 
  filter(is.na(childhome$D_632533534_D_284547539) & is.na(childhome$D_632533534_D_802585033)  & D_469914719_D_469914719!="[178420302]" &  
         ((!is.na(childhome$D_632533534_D_128827522) | !is.na(childhome$D_632533534_D_439447560) | 
             !is.na(childhome$D_632533534_D_286781627) | !is.na(childhome$D_632533534_D_733929451)) | 
             (!is.na(childhome$D_264797252_D_890792569) | !is.na(childhome$D_264797252_D_451394598) |
                !is.na(childhome$D_264797252_D_984908796) |!is.na(childhome$D_264797252_D_847327251))))


child_add3_1 <- child_add3_1 %>% mutate(Address= case_when(is.na(D_469914719_D_952124199)~"Skipped Cross-Street1"))

child_add3_1__skip <- child_add3_1 %>% dplyr::group_by(Address) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address, n, percentage)
child_add3_1__skip <- FollowupV1__skip[1,]

child_add3_1__skip[2,1] <- "Skipped Cross-Street2" 
child_add3_1__skip[2,2] <- sum(is.na(child_add3_1$D_469914719_D_204186397))
child_add3_1__skip[2,3] <- (sum(is.na(child_add3_1$D_200086909_D_154163153))/dim(child_add3_1)[[1]])*100

child_add3_1__skip %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Childhood Home Cross-Streets Skipped")) %>% 
  cols_label(n= md("**Number of Participants**"),Address = md("**Question**"), percentage = md("**%**")) %>% 
  #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address,
    )
  )

```

### Childhood move in and move out
```{r ChildInOut, warning=FALSE, echo=FALSE, message=FALSE}
#CHILDADD5_1_YEAR Move In/move out
childinout= Mod4 %>%  filter(Mod4$D_277348878==751569137) %>% 
  mutate(Address1= case_when(is.na(D_191221569_D_948416598) & is.na(D_191221569_D_858353109)~"Skipped Year Moved in or Since Birth"))

dt_childinout_summary <- childinout %>% dplyr::group_by(Address1) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address1, n, percentage)
dt_childinout_summary <- dt_childinout_summary[1,]

dt_childinout_summary[2,1] <- "Skipped Year Moved Out or Still Live There" 
dt_childinout_summary[2,2] <- sum(is.na(childinout$D_752015272_D_943813942) & is.na(childinout$D_752015272_D_752015272_D_139208251))
dt_childinout_summary[2,3] <- (sum(is.na(childinout$D_632533534_D_802585033) & is.na(childinout$D_752015272_D_752015272_D_139208251))/dim(childinout)[[1]])*100


dt_childinout_summary %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Childhood Home Move-In and Move-Out")) %>% 
  cols_label(n= md("**Number of Participants**"),Address1 = md("**Question**"), percentage = md("**%**")) %>% 
  #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address1,
    )
  ) 



```

### Childhood Water Source
```{r ChildWater, warning=FALSE, echo=FALSE, message=FALSE}
childwater= Mod4 %>%  filter(Mod4$D_277348878==751569137) %>% 
  mutate(Address1= case_when(is.na(D_714365367_D_714365367) & is.na(D_714365367_D_158518077)~"Skipped Main Water Source"))

dt_childwater_summary <- childwater %>% dplyr::group_by(Address1) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address1, n, percentage)
dt_childwater_summary <- dt_childwater_summary[1,]

dt_childwater_summary[2,1] <- "Skipped Drinking Water Source" 
dt_childwater_summary[2,2] <- sum(is.na(childwater$D_665593888_D_665593888) & is.na(childwater$D_665593888_D_669305975))
dt_childwater_summary[2,3] <- (sum(is.na(childwater$D_665593888_D_665593888) & is.na(childwater$D_665593888_D_669305975))/dim(childwater)[[1]])*100


dt_childwater_summary %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Childhood Home Water Supply")) %>% 
  cols_label(n= md("**Number of Participants**"),Address1 = md("**Question**"), percentage = md("**%**")) %>% 
  #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address1,
    )
  ) 



```

## Adult Tap Water Intake and Use
```{r AdultWater, warning=FALSE, echo=FALSE, message=FALSE}
## Adult Tap Water Intake ##
adultwater= Mod4 %>%   
  mutate(Address1= case_when(is.na(D_285545471_D_285545471) & is.na(D_285545471_D_936382173)~"Skipped Frequency of Drinking Tap Water"))

dt_adultwater_summary <- adultwater %>% dplyr::group_by(Address1) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address1, n, percentage)
dt_adultwater_summary <- dt_adultwater_summary[1,]

dt_adultwater_summary[2,1] <- "Skipped if Using Tap Water for Coffee" 
dt_adultwater_summary[2,2] <- sum(is.na(adultwater$D_831438612_D_831438612_D_863839736))
dt_adultwater_summary[2,3] <- (sum(is.na(adultwater$D_831438612_D_831438612_D_863839736))/dim(adultwater)[[1]])*100

dt_adultwater_summary[3,1] <- "Skipped if Using Tap Water for Hot Tea" 
dt_adultwater_summary[3,2] <- sum(is.na(adultwater$D_831438612_D_831438612_D_531671855))
dt_adultwater_summary[3,3] <- (sum(is.na(adultwater$D_831438612_D_831438612_D_531671855))/dim(adultwater)[[1]])*100

dt_adultwater_summary[4,1] <- "Skipped if Using Tap Water for Iced Tea" 
dt_adultwater_summary[4,2] <- sum(is.na(adultwater$D_831438612_D_831438612_D_525375987))
dt_adultwater_summary[4,3] <- (sum(is.na(adultwater$D_831438612_D_831438612_D_525375987))/dim(adultwater)[[1]])*100

dt_adultwater_summary[5,1] <- "Skipped if Using Tap Water for Mixing" 
dt_adultwater_summary[5,2] <- sum(is.na(adultwater$D_831438612_D_831438612_D_995797773))
dt_adultwater_summary[5,3] <- (sum(is.na(adultwater$D_831438612_D_831438612_D_995797773))/dim(adultwater)[[1]])*100

dt_adultwater_summary[6,1] <- "Skipped if Using Tap Water for Other Beverages" 
dt_adultwater_summary[6,2] <- sum(is.na(adultwater$D_831438612_D_831438612_D_431441193) & is.na(adultwater$D_831438612_D_831438612_D_834822910))
dt_adultwater_summary[6,3] <- (sum(is.na(adultwater$D_831438612_D_831438612_D_431441193) & is.na(adultwater$D_831438612_D_831438612_D_834822910))/dim(adultwater)[[1]])*100


dt_adultwater_summary %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Drinking Tap Water")) %>% 
  cols_label(n= md("**Number of Participants**"),Address1 = md("**Question**"), percentage = md("**%**")) %>% 
  #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address1,
    )
  ) 



#DRINKSWTR2B--coffee
adultwater2= Mod4 %>%   
  mutate(Address1= case_when(is.na(D_961178879_D_961178879) & D_831438612_D_831438612_D_863839736==1 ~"Skipped Frequency of Drinking Coffee"))

dt_adultwater2_summary <- adultwater2 %>% dplyr::group_by(Address1) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address1, n, percentage)
dt_adultwater2_summary <- dt_adultwater2_summary[1,]

dt_adultwater2_summary[2,1] <- "Skipped Frequency of Drinking Tea" 
drinktea <- adultwater2 %>% filter(D_831438612_D_831438612_D_531671855==1)
dt_adultwater2_summary[2,2] <- sum(is.na(drinktea$D_138116092_D_138116092))
dt_adultwater2_summary[2,3] <- (sum(is.na(drinktea$D_138116092_D_138116092))/dim(drinktea)[[1]])*100

dt_adultwater2_summary[3,1] <- "Skipped Frequency of Drinking Iced Tea"
drinkice <- adultwater2 %>% filter(D_831438612_D_831438612_D_525375987==1)
dt_adultwater2_summary[3,2] <- sum(is.na(drinkice$D_393682471_D_393682471))
dt_adultwater2_summary[3,3] <- (sum(is.na(drinkice$D_393682471_D_393682471))/dim(drinkice)[[1]])*100

dt_adultwater2_summary[4,1] <- "Skipped Frequency of Drinking Mixed Liquids" 
drinkliq <- adultwater2 %>% filter(D_831438612_D_831438612_D_995797773==1)
dt_adultwater2_summary[4,2] <- sum(is.na(drinkliq$D_364303962_D_364303962))
dt_adultwater2_summary[4,3] <- (sum(is.na(drinkliq$D_364303962_D_364303962))/dim(drinkliq)[[1]])*100

dt_adultwater2_summary[5,1] <- "Skipped Frequency of Drinking Other Beverages" 
drinkoth <- adultwater2 %>% filter(D_831438612_D_831438612_D_431441193==1)
dt_adultwater2_summary[5,2] <- sum(is.na(drinkoth$D_944517297_D_944517297))
dt_adultwater2_summary[5,3] <- (sum(is.na(drinkoth$D_944517297_D_944517297))/dim(drinkoth)[[1]])*100



dt_adultwater2_summary %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Frequency of Drinking Beverages Made with Tap Water")) %>% 
  cols_label(n= md("**Number of Participants**"),Address1 = md("**Question**"), percentage = md("**%**")) %>% 
  #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address1,
    )
  )


# drinks2B = Mod4 %>% select(D_961178879_D_961178879) %>% filter(Mod4$D_831438612_D_831438612_D_863839736==1)
# vis_miss(drinks2B)+labs(y= "Participants", title="DRINKS2B")
# #gg_miss_var(drinks2B)+labs(y= "Participants")
# 
# #DRINKSWTR2C--tea
# drinks2C = Mod4 %>% select(D_138116092_D_138116092) %>% filter(Mod4$D_831438612_D_831438612_D_531671855==1)
# vis_miss(drinks2C)+labs(y= "Participants", title="DRINKS2C")
# #gg_miss_var(drinks2C)+labs(y= "Participants")
# 
# #DRINKSWTR2D--iced tea
# drinks2D = Mod4 %>% select(D_393682471_D_393682471) %>% filter(Mod4$D_831438612_D_831438612_D_525375987==1)
# vis_miss(drinks2D)+labs(y= "Participants", title="DRINKS2D")
# #gg_miss_var(drinks2D)+labs(y= "Participants")
# 
# #DRINKSWTR2E--soup
# drinks2E = Mod4 %>% select(D_364303962_D_364303962) %>% filter(Mod4$D_831438612_D_831438612_D_995797773==1)
# vis_miss(drinks2E)+labs(y= "Participants", title="DRINKS2E")
# #gg_miss_var(drinks2E)+labs(y= "Participants")
# 
# #DRINKSWTR2F--other
# drinks2F = Mod4 %>% select(D_944517297_D_944517297) %>% filter(Mod4$D_831438612_D_831438612_D_431441193==1)
# vis_miss(drinks2F)+labs(y= "Participants", title="DRINKS2F")
# #gg_miss_var(drinks2F)+labs(y= "Participants")

##NUMBATHS
work19= Mod4 %>%  
  mutate(Address1= case_when(is.na(D_302947409)~"Skipped NUMBATHS"))

dt_work19_summary <- work19 %>% dplyr::group_by(Address1) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address1, n, percentage)
dt_work19_summary <- dt_work19_summary[1,]

dt_work19_summary %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Number of Showers or Baths per Week")) %>% 
  cols_label(n= md("**Number of Participants**"),Address1 = md("**Question**"), percentage = md("**%**")) %>% 
  #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address1,
    )
  ) 



```

# Section 2: Commuting
```{r Commuting, warning=FALSE, echo=FALSE, message=FALSE}

work19= Mod4 %>%  
  mutate(Address1= case_when(is.na(D_694113343)~"Skipped WORK2019"))

dt_work19_summary <- work19 %>% dplyr::group_by(Address1) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address1, n, percentage)
dt_work19_summary <- dt_work19_summary[1,]

dt_work19_summary %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Worked in 2019")) %>% 
  cols_label(n= md("**Number of Participants**"),Address1 = md("**Question**"), percentage = md("**%**")) %>% 
  #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address1,
    )
  ) 




days_work19= Mod4 %>%  filter(Mod4$D_694113343==353358909) %>%  
  mutate(Address1= case_when(is.na(D_774087638)~"Skipped DAYSWORK"))

dt_days_work19_summary <- days_work19 %>% dplyr::group_by(Address1) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address1, n, percentage)
dt_days_work19_summary <- dt_days_work19_summary[1,]

dt_days_work19_summary %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Days per Week Worked in 2019")) %>% 
  cols_label(n= md("**Number of Participants**"),Address1 = md("**Question**"), percentage = md("**%**")) %>% 
  #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address1,
    )
  )


```




## Work Commute Before the COVID-19 Pandemic
```{r PreCOVID, warning=FALSE, echo=FALSE, message=FALSE}
days_work19= Mod4 %>%  filter(Mod4$D_694113343==353358909) %>%  
  mutate(Address1= case_when(is.na(D_374639590)~"Skipped WORKRES"))

dt_days_work19_summary <- days_work19 %>% dplyr::group_by(Address1) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address1, n, percentage)
dt_days_work19_summary <- dt_days_work19_summary[1,]

dt_days_work19_summary %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Daily Work Tasks Include Driving")) %>% 
  cols_label(n= md("**Number of Participants**"),Address1 = md("**Question**"), percentage = md("**%**")) %>% 
  #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
    stub.font.weight = "bold"
  ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address1,
    )
  )




commute_num= Mod4 %>%  filter(Mod4$D_374639590!=353358909) %>%  
  mutate(Address1= case_when(is.na(D_828801156)~"Skipped NUMWORK"))

dt_commute_num_summary <- commute_num %>% dplyr::group_by(Address1) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address1, n, percentage)
dt_commute_num_summary <- dt_commute_num_summary[1,]

dt_commute_num_summary %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Number of Commutes to Different Workplaces per Week")) %>% 
  cols_label(n= md("**Number of Participants**"),Address1 = md("**Question**"), percentage = md("**%**")) %>% 
  #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
    stub.font.weight = "bold"
  ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address1,
    )
  )



curwork= Mod4 %>%  filter(Mod4$D_374639590!=353358909 & (Mod4$D_828801156==759356722 | Mod4$D_828801156==185036360)) %>%  
  mutate(Address1= case_when(is.na(D_596318751_D_411791779) & is.na(D_596318751_D_493984171)& is.na(D_596318751_D_253017624) & is.na(D_596318751_D_959804472)& 
                               is.na(D_596318751_D_774707280)& is.na(D_596318751_D_182144476)& is.na(D_596318751_D_294634899) ~"Skipped All Employer Info"))

dt_curwork_summary <- curwork %>% dplyr::group_by(Address1) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address1, n, percentage)
dt_curwork_summary <- dt_curwork_summary[1,]

dt_curwork_summary[2,1] <- "Skipped Employer Street Name" 
dt_curwork_summary[2,2] <- sum(is.na(curwork$D_596318751_D_411791779))
dt_curwork_summary[2,3] <- (sum(is.na(curwork$D_596318751_D_411791779))/dim(curwork)[[1]])*100

dt_curwork_summary[3,1] <- "Skipped Employer Street Number" 
dt_curwork_summary[3,2] <- sum(is.na(curwork$D_596318751_D_493984171))
dt_curwork_summary[3,3] <- (sum(is.na(curwork$D_596318751_D_493984171))/dim(curwork)[[1]])*100

dt_curwork_summary[4,1] <- "Skipped Employer Street Name" 
dt_curwork_summary[4,2] <- sum(is.na(curwork$D_596318751_D_253017624))
dt_curwork_summary[4,3] <- (sum(is.na(curwork$D_596318751_D_253017624))/dim(curwork)[[1]])*100

dt_curwork_summary[5,1] <- "Skipped Employer City" 
dt_curwork_summary[5,2] <- sum(is.na(curwork$D_596318751_D_959804472))
dt_curwork_summary[5,3] <- (sum(is.na(curwork$D_596318751_D_959804472))/dim(curwork)[[1]])*100

dt_curwork_summary[6,1] <- "Skipped Employer State" 
dt_curwork_summary[6,2] <- sum(is.na(curwork$D_596318751_D_774707280))
dt_curwork_summary[6,3] <- (sum(is.na(curwork$D_596318751_D_774707280))/dim(curwork)[[1]])*100

dt_curwork_summary[7,1] <- "Skipped Employer ZIP" 
dt_curwork_summary[7,2] <- sum(is.na(curwork$D_596318751_D_182144476 ))
dt_curwork_summary[7,3] <- (sum(is.na(curwork$D_596318751_D_182144476 ))/dim(curwork)[[1]])*100

dt_curwork_summary[8,1] <- "Skipped Employer Country" 
dt_curwork_summary[8,2] <- sum(is.na(curwork$D_596318751_D_294634899))
dt_curwork_summary[8,3] <- (sum(is.na(curwork$D_596318751_D_294634899))/dim(curwork)[[1]])*100



dt_curwork_summary %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Current Employer (Most Often Commuted to)")) %>% 
  cols_label(n= md("**Number of Participants**"),Address1 = md("**Question**"), percentage = md("**%**")) %>% 
  #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
    stub.font.weight = "bold"
  ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address1,
    )
  )






curwork2= Mod4 %>%  filter(Mod4$D_374639590!=353358909 & Mod4$D_263588196_D_263588196!="[178420302]" & (Mod4$D_828801156==759356722 | Mod4$D_828801156==185036360)) %>%  
  mutate(Address1= case_when(is.na(D_596318751_D_959804472) & is.na(D_263588196_D_583500714) ~"Skipped City"))

dt_curwork2_summary <- curwork2 %>% dplyr::group_by(Address1) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address1, n, percentage)
dt_curwork2_summary <- dt_curwork2_summary[1,]

dt_curwork2_summary[2,1] <- "Skipped Employer State" 
dt_curwork2_summary[2,2] <- sum(is.na(curwork2$D_596318751_D_774707280) & is.na(curwork2$D_263588196_D_742105146))
dt_curwork2_summary[2,3] <- (sum(is.na(curwork2$D_596318751_D_774707280) & is.na(curwork2$D_263588196_D_742105146))/dim(curwork2)[[1]])*100

dt_curwork2_summary[3,1] <- "Skipped Employer ZIP" 
dt_curwork2_summary[3,2] <- sum(is.na(curwork2$D_596318751_D_182144476) & is.na(curwork2$D_263588196_D_101341673))
dt_curwork2_summary[3,3] <- (sum(is.na(curwork2$D_596318751_D_182144476) & is.na(curwork2$D_263588196_D_101341673))/dim(curwork2)[[1]])*100

dt_curwork2_summary[4,1] <- "Skipped Employer Country" 
dt_curwork2_summary[4,2] <- sum(is.na(curwork2$D_596318751_D_294634899) & is.na(curwork2$D_263588196_D_237204853))
dt_curwork2_summary[4,3] <- (sum(is.na(curwork2$D_596318751_D_294634899) & is.na(curwork2$D_263588196_D_237204853))/dim(curwork2)[[1]])*100



dt_curwork2_summary %>%  gt::gt() %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Current Employer Address Follow-Up")) %>% 
  cols_label(n= md("**Number of Participants**"),Address1 = md("**Question**"), percentage = md("**%**")) %>% 
  #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
    stub.font.weight = "bold"
  ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address1,
    )
  )





CURWORK3= Mod4 %>% #select(D_845811202_D_510435329, D_845811202_D_520264332) %>% 
  filter((Mod4$D_828801156==759356722 | Mod4$D_828801156==185036360) &
           Mod4$D_845811202_D_845811202!="[178420302]" & Mod4$D_374639590!=353358909 &
           is.na(Mod4$D_596318751_D_493984171) & is.na(Mod4$D_596318751_D_253017624) & ((!is.na(Mod4$D_596318751_D_959804472) | !is.na(Mod4$D_596318751_D_774707280) | 
                                                                                           !is.na(Mod4$D_596318751_D_182144476) | !is.na(Mod4$D_596318751_D_294634899)) | 
                                                                                          (!is.na(Mod4$D_263588196_D_583500714) | !is.na(Mod4$D_263588196_D_742105146) |
                                                                                             !is.na(Mod4$D_263588196_D_101341673) |!is.na(Mod4$D_263588196_D_237204853))))


CURWORK3= CURWORK3 %>%  mutate(Address1= case_when(is.na(D_845811202_D_510435329) ~"Skipped Cross Street 1"))

dt_CURWORK3_summary <- CURWORK3 %>% dplyr::group_by(Address1) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address1, n, percentage)
dt_CURWORK3_summary <- dt_CURWORK3_summary[1,]

dt_CURWORK3_summary[2,1] <- "Skipped Cross Street 2" 
dt_CURWORK3_summary[2,2] <- sum(is.na(CURWORK3$D_845811202_D_520264332))
dt_CURWORK3_summary[2,3] <- (sum(is.na(CURWORK3$D_845811202_D_520264332))/dim(CURWORK3)[[1]])*100

dt_CURWORK3_summary <- dt_CURWORK3_summary[2,]
dt_CURWORK3_summary %>%  gt::gt() %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Current Employer Buidling Cross Streets")) %>% 
  cols_label(n= md("**Number of Participants**"),Address1 = md("**Question**"), percentage = md("**%**")) %>% 
  #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
    stub.font.weight = "bold"
  ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address1,
    )
  )






CURWORKYR1_MOS= Mod4 %>%   
  filter(Mod4$D_374639590!=353358909 & (Mod4$D_828801156==759356722 | Mod4$D_828801156==185036360))


CURWORKYR1_MOS= CURWORKYR1_MOS %>%  mutate(Address1= case_when(is.na(D_380579855_D_824151724) ~"Skipped Month Job Started"))

dt_CURWORKYR1_MOS_summary <- CURWORKYR1_MOS %>% dplyr::group_by(Address1) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address1, n, percentage)
dt_CURWORKYR1_MOS_summary <- dt_CURWORKYR1_MOS_summary[1,]

dt_CURWORKYR1_MOS_summary[2,1] <- "Skipped Year Job Started" 
dt_CURWORKYR1_MOS_summary[2,2] <- sum(is.na(CURWORKYR1_MOS$D_380579855_D_596301593))
dt_CURWORKYR1_MOS_summary[2,3] <- (sum(is.na(CURWORKYR1_MOS$D_380579855_D_596301593))/dim(CURWORKYR1_MOS)[[1]])*100

dt_CURWORKYR1_MOS_summary[3,1] <- "Skipped Months a Year Commuting" 
dt_CURWORKYR1_MOS_summary[3,2] <- sum(is.na(CURWORKYR1_MOS$D_138397553))
dt_CURWORKYR1_MOS_summary[3,3] <- (sum(is.na(CURWORKYR1_MOS$D_138397553))/dim(CURWORKYR1_MOS)[[1]])*100

dt_CURWORKYR1_MOS_summary %>%  gt::gt() %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Commuting to Current Employer")) %>% 
  cols_label(n= md("**Number of Participants**"),Address1 = md("**Question**"), percentage = md("**%**")) %>% 
  #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
    stub.font.weight = "bold"
  ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address1,
    )
  )






CURWORKT1= Mod4 %>%   
  filter(Mod4$D_374639590!=353358909 & (Mod4$D_828801156==759356722 | Mod4$D_828801156==185036360))

CURWORKT1= CURWORKT1 %>%  mutate(Address1= case_when(is.na(D_635467479_D_635467479_D_158795242) ~"Skipped if Commute Inlcudes a Car"))

dt_CURWORKT1_summary <- CURWORKT1 %>% dplyr::group_by(Address1) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address1, n, percentage)
dt_CURWORKT1_summary <- dt_CURWORKT1_summary[1,]

dt_CURWORKT1_summary[2,1] <- "Skipped if Commute Inlcudes a Taxi" 
dt_CURWORKT1_summary[2,2] <- sum(is.na(CURWORKT1$D_635467479_D_635467479_D_443596662))
dt_CURWORKT1_summary[2,3] <- (sum(is.na(CURWORKT1$D_635467479_D_635467479_D_443596662))/dim(CURWORKT1)[[1]])*100

dt_CURWORKT1_summary[3,1] <- "Skipped if Commute Inlcudes a Motorcycle" 
dt_CURWORKT1_summary[3,2] <- sum(is.na(CURWORKT1$D_635467479_D_635467479_D_892894242))
dt_CURWORKT1_summary[3,3] <- (sum(is.na(CURWORKT1$D_635467479_D_635467479_D_892894242))/dim(CURWORKT1)[[1]])*100

dt_CURWORKT1_summary[4,1] <- "Skipped if Commute Inlcudes a Bus" 
dt_CURWORKT1_summary[4,2] <- sum(is.na(CURWORKT1$D_635467479_D_635467479_D_177539753))
dt_CURWORKT1_summary[4,3] <- (sum(is.na(CURWORKT1$D_635467479_D_635467479_D_177539753))/dim(CURWORKT1)[[1]])*100

dt_CURWORKT1_summary[5,1] <- "Skipped if Commute Inlcudes a Subway" 
dt_CURWORKT1_summary[5,2] <- sum(is.na(CURWORKT1$D_635467479_D_635467479_D_107659596))
dt_CURWORKT1_summary[5,3] <- (sum(is.na(CURWORKT1$D_635467479_D_635467479_D_107659596))/dim(CURWORKT1)[[1]])*100

dt_CURWORKT1_summary[6,1] <- "Skipped if Commute Inlcudes Biking" 
dt_CURWORKT1_summary[6,2] <- sum(is.na(CURWORKT1$D_635467479_D_635467479_D_575883949))
dt_CURWORKT1_summary[6,3] <- (sum(is.na(CURWORKT1$D_635467479_D_635467479_D_575883949))/dim(CURWORKT1)[[1]])*100

dt_CURWORKT1_summary[7,1] <- "Skipped if Commute Inlcudes Walking" 
dt_CURWORKT1_summary[7,2] <- sum(is.na(CURWORKT1$D_635467479_D_635467479_D_248168118))
dt_CURWORKT1_summary[7,3] <- (sum(is.na(CURWORKT1$D_635467479_D_635467479_D_248168118))/dim(CURWORKT1)[[1]])*100

dt_CURWORKT1_summary[8,1] <- "Skipped if Commute Inlcudes Another Method" 
dt_CURWORKT1_summary[8,2] <- sum(is.na(CURWORKT1$D_635467479_D_635467479_D_509121242) & is.na(CURWORKT1$D_635467479_D_902077989))
dt_CURWORKT1_summary[8,3] <- (sum(is.na(CURWORKT1$D_635467479_D_635467479_D_509121242) & is.na(CURWORKT1$D_635467479_D_902077989))/dim(CURWORKT1)[[1]])*100


dt_CURWORKT1_summary %>%  gt::gt() %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Commuting Methods to Work (Current Position)")) %>% 
  cols_label(n= md("**Number of Participants**"),Address1 = md("**Question**"), percentage = md("**%**")) %>% 
  #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
    stub.font.weight = "bold"
  ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address1,
    )
  )





CURWORKT2A_H= Mod4 %>%   
  filter( (is.na(D_440093675_D_593010802) & D_635467479_D_635467479_D_158795242==1 | 
             is.na(D_440093675_D_453004768) & D_635467479_D_635467479_D_443596662==1 |
             is.na(D_440093675_D_511991969) & D_635467479_D_635467479_D_892894242==1 |
             is.na(D_440093675_D_546570171) & D_635467479_D_635467479_D_177539753==1 |
             is.na(D_440093675_D_242761203) & D_635467479_D_635467479_D_107659596==1 |
             is.na(D_440093675_D_587434250) & D_635467479_D_635467479_D_575883949==1 |
             is.na(D_440093675_D_569993305) & D_635467479_D_635467479_D_248168118==1 |
             is.na(D_440093675_D_662584384) & D_635467479_D_902077989==1 ) &
            Mod4$D_374639590!=353358909 & (Mod4$D_828801156==759356722 | Mod4$D_828801156==185036360) & 
           (Mod4$D_635467479_D_635467479_D_443596662==1 | Mod4$D_635467479_D_635467479_D_158795242==1 | Mod4$D_635467479_D_635467479_D_892894242==1 |
              Mod4$D_635467479_D_635467479_D_177539753==1 | is.na(Mod4$D_440093675_D_453004768) | is.na(Mod4$D_440093675_D_453004768)))

CURWORKT2A_H= CURWORKT2A_H %>%  
  mutate(Address1= case_when(is.na(D_440093675_D_593010802) & D_635467479_D_635467479_D_158795242==1 ~"Skipped Time Spent in a Car"))

dt_CURWORKT2A_H_summary <- CURWORKT2A_H %>% dplyr::group_by(Address1) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address1, n, percentage)
dt_CURWORKT2A_H_summary <- dt_CURWORKT2A_H_summary[1,]

dt_CURWORKT2A_H_summary[2,1] <- "Skipped Time Spent in a Taxi" 
taxi <- CURWORKT2A_H %>% filter(D_635467479_D_635467479_D_443596662==1)
dt_CURWORKT2A_H_summary[2,2] <- sum(is.na(taxi$D_440093675_D_453004768))
dt_CURWORKT2A_H_summary[2,3] <- (sum(is.na(taxi$D_440093675_D_453004768))/dim(taxi)[[1]])*100

dt_CURWORKT2A_H_summary[3,1] <- "Skipped Time Spent in a Motorcycle" 
motorcycle <- CURWORKT2A_H %>% filter(D_635467479_D_635467479_D_892894242==1)
dt_CURWORKT2A_H_summary[3,2] <- sum(is.na(motorcycle$D_440093675_D_511991969))
dt_CURWORKT2A_H_summary[3,3] <- (sum(is.na(motorcycle$D_440093675_D_511991969))/dim(motorcycle)[[1]])*100

dt_CURWORKT2A_H_summary[4,1] <- "Skipped Time Spent in a Bus" 
bus <- CURWORKT2A_H %>% filter(D_635467479_D_635467479_D_177539753==1)
dt_CURWORKT2A_H_summary[4,2] <- sum(is.na(bus$D_440093675_D_546570171))
dt_CURWORKT2A_H_summary[4,3] <- (sum(is.na(bus$D_440093675_D_546570171))/dim(bus)[[1]])*100

dt_CURWORKT2A_H_summary[5,1] <- "Skipped Time Spent in a Subway" 
subway <- CURWORKT2A_H %>% filter(D_635467479_D_635467479_D_107659596==1)
dt_CURWORKT2A_H_summary[5,2] <- sum(is.na(subway$D_440093675_D_242761203))
dt_CURWORKT2A_H_summary[5,3] <- (sum(is.na(subway$D_440093675_D_242761203))/dim(subway)[[1]])*100

dt_CURWORKT2A_H_summary[6,1] <- "Skipped Time Spent Biking" 
bike <- CURWORKT2A_H %>% filter(D_635467479_D_635467479_D_575883949==1)
dt_CURWORKT2A_H_summary[6,2] <- sum(is.na(bike$D_440093675_D_587434250))
dt_CURWORKT2A_H_summary[6,3] <- (sum(is.na(bike$D_440093675_D_587434250))/dim(bike)[[1]])*100

dt_CURWORKT2A_H_summary[7,1] <- "Skipped Time Spent Walking" 
walk <- CURWORKT2A_H %>% filter(D_635467479_D_635467479_D_248168118==1)
dt_CURWORKT2A_H_summary[7,2] <- sum(is.na(walk$D_440093675_D_569993305))
dt_CURWORKT2A_H_summary[7,3] <- (sum(is.na(walk$D_440093675_D_569993305))/dim(walk)[[1]])*100

dt_CURWORKT2A_H_summary[8,1] <- "Skipped Time Spent in Another Method" 
method <- CURWORKT2A_H %>% filter(D_635467479_D_902077989==1)
dt_CURWORKT2A_H_summary[8,2] <- sum(is.na(method$D_440093675_D_662584384))
dt_CURWORKT2A_H_summary[8,3] <- (sum(is.na(method$D_440093675_D_662584384))/dim(method)[[1]])*100


dt_CURWORKT2A_H_summary %>%  gt::gt() %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Time Spent in Each Commuting Method (Current Position)")) %>% 
  cols_label(n= md("**Number of Participants**"),Address1 = md("**Question**"), percentage = md("**%**")) %>% 
  #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
    stub.font.weight = "bold"
  ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address1,
    )
  )




CURWORKT3_4_5= Mod4 %>%  filter( (is.na(Mod4$D_155199731) | is.na(Mod4$D_181422361) | is.na(Mod4$D_333362587)) & 
                                   Mod4$D_374639590!=353358909 & (Mod4$D_828801156==759356722 | Mod4$D_828801156==185036360) &
            (Mod4$D_440093675_D_593010802!=428999623 & !is.na(Mod4$D_440093675_D_593010802)) | (Mod4$D_440093675_D_453004768!=428999623 & !is.na(Mod4$D_440093675_D_453004768)) |
            (Mod4$D_440093675_D_511991969!=428999623 & !is.na(Mod4$D_440093675_D_511991969)) | (Mod4$D_440093675_D_546570171!=428999623 & !is.na(Mod4$D_440093675_D_546570171)) |
            (Mod4$D_440093675_D_242761203!=428999623 & !is.na(Mod4$D_440093675_D_242761203)) | (Mod4$D_440093675_D_587434250!=428999623 & !is.na(Mod4$D_440093675_D_587434250)) |
            (Mod4$D_440093675_D_569993305!=428999623 & !is.na(Mod4$D_440093675_D_569993305)) |(Mod4$D_440093675_D_662584384!=428999623 & !is.na(Mod4$D_440093675_D_662584384))) %>% 
  mutate(Address1= case_when(is.na(D_155199731) ~"Skipped Time on Highways"))

dt_CURWORKT3_4_5_summary <- CURWORKT3_4_5 %>% dplyr::group_by(Address1) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address1, n, percentage)
dt_CURWORKT3_4_5_summary <- dt_CURWORKT3_4_5_summary[1,]

dt_CURWORKT3_4_5_summary[2,1] <- "Skipped Time on Major Roads" 
dt_CURWORKT3_4_5_summary[2,2] <- sum(is.na(CURWORKT3_4_5$D_181422361))
dt_CURWORKT3_4_5_summary[2,3] <- (sum(is.na(CURWORKT3_4_5$D_181422361))/dim(CURWORKT3_4_5)[[1]])*100

dt_CURWORKT3_4_5_summary[3,1] <- "Skipped Time on  Local Roads" 
dt_CURWORKT3_4_5_summary[3,2] <- sum(is.na(CURWORKT3_4_5$D_333362587))
dt_CURWORKT3_4_5_summary[3,3] <- (sum(is.na(CURWORKT3_4_5$D_333362587))/dim(CURWORKT3_4_5)[[1]])*100


dt_CURWORKT3_4_5_summary %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Time Commuting on Road Types (Current Position)")) %>% 
  cols_label(n= md("**Number of Participants**"),Address1 = md("**Question**"), percentage = md("**%**")) %>% 
  #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
    stub.font.weight = "bold"
  ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address1,
    )
  )



CURWORKT6_summary <- Mod4 %>% filter(Mod4$D_374639590!=353358909 & (Mod4$D_828801156==759356722 | Mod4$D_828801156==185036360) & is.na(D_839454121) ) %>% 
  mutate(Address1= case_when(is.na(D_839454121) ~"Skipped CURWORKT6"))
CURWORKT6 <- CURWORKT6_summary %>% dplyr::group_by(Address1) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address1, n, percentage)
CURWORKT6 <- CURWORKT6[1,]


CURWORKT6 %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Days per Week Commuting to Current Workplace")) %>% 
  cols_label(n= md("**Number of Participants**"),Address1 = md("**Question**"), percentage = md("**%**")) %>% 
  #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
    stub.font.weight = "bold"
  ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address1,
    )
  )


CURWORKT7_summary <- Mod4 %>% filter(Mod4$D_374639590!=353358909 & (Mod4$D_828801156==759356722 | Mod4$D_828801156==185036360) & is.na(D_684542266)) %>% 
  mutate(Address1= case_when(is.na(D_684542266) ~"Skipped CURWORKT7"))
CURWORKT7 <- CURWORKT7_summary %>% dplyr::group_by(Address1) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address1, n, percentage)
CURWORKT7 <- CURWORKT7[1,]


CURWORKT7 %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Same Type of Transportation on Commute Home (Current Position)")) %>% 
  cols_label(n= md("**Number of Participants**"),Address1 = md("**Question**"), percentage = md("**%**")) %>% 
  #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
    stub.font.weight = "bold"
  ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address1,
    )
  )



CURWORKT8= Mod4  %>%  filter(Mod4$D_684542266==353358909 & Mod4$D_374639590!=353358909 & (Mod4$D_828801156==759356722 | Mod4$D_828801156==185036360)) %>%  mutate(Address1= case_when(is.na(D_203943120) ~"Skipped CURWORKT8"))
         
dt_CURWORKT8_summary <- CURWORKT8 %>% dplyr::group_by(Address1) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address1, n, percentage)
dt_CURWORKT8_summary <- dt_CURWORKT8_summary[1,]

dt_CURWORKT8_summary %>%  gt::gt() %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Time of Commute Home versus Commute to Work (Current Position)")) %>% 
  cols_label(n= md("**Number of Participants**"),Address1 = md("**Question**"), percentage = md("**%**")) %>% 
  #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
    stub.font.weight = "bold"
  ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address1,
    )
  )




CURWORKT9= Mod4 %>%   
  filter(Mod4$D_684542266!=353358909 & Mod4$D_694113343==353358909)

CURWORKT9= CURWORKT9 %>%  mutate(Address1= case_when(is.na(D_404697804_D_404697804_D_581991828) ~"Skipped if Commute Inlcudes a Car"))

dt_CURWORKT9_summary <- CURWORKT9 %>% dplyr::group_by(Address1) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address1, n, percentage)
dt_CURWORKT9_summary <- dt_CURWORKT9_summary[1,]

dt_CURWORKT9_summary[2,1] <- "Skipped if Commute Inlcudes a Taxi" 
dt_CURWORKT9_summary[2,2] <- sum(is.na(CURWORKT9$D_404697804_D_404697804_D_846844103))
dt_CURWORKT9_summary[2,3] <- (sum(is.na(CURWORKT9$D_404697804_D_404697804_D_846844103))/dim(CURWORKT9)[[1]])*100

dt_CURWORKT9_summary[3,1] <- "Skipped if Commute Inlcudes a Motorcycle" 
dt_CURWORKT9_summary[3,2] <- sum(is.na(CURWORKT9$D_404697804_D_404697804_D_660927579))
dt_CURWORKT9_summary[3,3] <- (sum(is.na(CURWORKT9$D_404697804_D_404697804_D_660927579))/dim(CURWORKT9)[[1]])*100

dt_CURWORKT9_summary[4,1] <- "Skipped if Commute Inlcudes a Bus" 
dt_CURWORKT9_summary[4,2] <- sum(is.na(CURWORKT9$D_404697804_D_404697804_D_940452831))
dt_CURWORKT9_summary[4,3] <- (sum(is.na(CURWORKT9$D_404697804_D_404697804_D_940452831))/dim(CURWORKT9)[[1]])*100

dt_CURWORKT9_summary[5,1] <- "Skipped if Commute Inlcudes a Subway" 
dt_CURWORKT9_summary[5,2] <- sum(is.na(CURWORKT9$D_404697804_D_404697804_D_669359763))
dt_CURWORKT9_summary[5,3] <- (sum(is.na(CURWORKT9$D_404697804_D_404697804_D_669359763))/dim(CURWORKT9)[[1]])*100

dt_CURWORKT9_summary[6,1] <- "Skipped if Commute Inlcudes Biking" 
dt_CURWORKT9_summary[6,2] <- sum(is.na(CURWORKT9$D_404697804_D_404697804_D_950972496))
dt_CURWORKT9_summary[6,3] <- (sum(is.na(CURWORKT9$D_404697804_D_404697804_D_950972496))/dim(CURWORKT9)[[1]])*100

dt_CURWORKT9_summary[7,1] <- "Skipped if Commute Inlcudes Walking" 
dt_CURWORKT9_summary[7,2] <- sum(is.na(CURWORKT9$D_404697804_D_404697804_D_137216656))
dt_CURWORKT9_summary[7,3] <- (sum(is.na(CURWORKT9$D_404697804_D_404697804_D_137216656))/dim(CURWORKT9)[[1]])*100

dt_CURWORKT9_summary[8,1] <- "Skipped if Commute Inlcudes Another Method" 
dt_CURWORKT9_summary[8,2] <- sum(is.na(CURWORKT9$D_404697804_D_404697804_D_244488084) & is.na(CURWORKT9$D_404697804_D_631088397))
dt_CURWORKT9_summary[8,3] <- (sum(is.na(CURWORKT9$D_404697804_D_404697804_D_244488084) & is.na(CURWORKT9$D_404697804_D_631088397))/dim(CURWORKT9)[[1]])*100


dt_CURWORKT9_summary %>%  gt::gt() %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Commuting Methods Home From Work (Current Position)")) %>% 
  cols_label(n= md("**Number of Participants**"),Address1 = md("**Question**"), percentage = md("**%**")) %>% 
  #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
    stub.font.weight = "bold"
  ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address1,
    )
  )





CURWORKT10A= Mod4 %>%   
  filter(is.na(Mod4$D_786253125_D_659799855) & Mod4$D_203943120!=353358909 & Mod4$D_374639590!=353358909 & (Mod4$D_828801156==759356722 | Mod4$D_828801156==185036360) &
           ifelse(Mod4$D_684542266==104430631, Mod4$D_404697804_D_404697804_D_581991828==1,
                  ifelse(is.na(Mod4$D_684542266), Mod4$D_404697804_D_404697804_D_581991828==1,
                         ifelse(Mod4$D_203943120==104430631, Mod4$D_635467479_D_635467479_D_158795242==1,
                                ifelse(is.na(Mod4$D_203943120), Mod4$D_635467479_D_635467479_D_158795242==1, TRUE))))) ##should this be else true or else NA? Doesn't seem to change outcome
CURWORKT10A= CURWORKT10A %>%  mutate(Address1= case_when(is.na(D_786253125_D_659799855) ~"Skipped CURWORKT10A"))

dt_CURWORKT10A_summary <- CURWORKT10A %>% dplyr::group_by(Address1) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address1, n, percentage)


dt_CURWORKT10A_summary %>%  gt::gt() %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Time Commuting Home in the Car (Current Position)")) %>% 
  cols_label(n= md("**Number of Participants**"),Address1 = md("**Question**"), percentage = md("**%**")) %>% 
  #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
    stub.font.weight = "bold"
  ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address1,
    )
  )




CURWORKT10B= Mod4 %>%   
  filter(is.na(Mod4$D_786253125_D_552410034) & Mod4$D_203943120!=353358909 & Mod4$D_374639590!=353358909 & (Mod4$D_828801156==759356722 | Mod4$D_828801156==185036360) &
           ifelse(Mod4$D_684542266==104430631, Mod4$D_404697804_D_404697804_D_846844103==1,
                  ifelse(is.na(Mod4$D_684542266), Mod4$D_404697804_D_404697804_D_846844103==1,
                         ifelse(Mod4$D_203943120==104430631, Mod4$D_635467479_D_635467479_D_443596662==1,
                                ifelse(is.na(Mod4$D_203943120), Mod4$D_635467479_D_635467479_D_443596662==1, NA)))))
CURWORKT10B= CURWORKT10B %>%  mutate(Address1= case_when(is.na(D_786253125_D_552410034) ~"Skipped CURWORKT10B"))

dt_CURWORKT10B_summary <- CURWORKT10B %>% dplyr::group_by(Address1) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address1, n, percentage)


dt_CURWORKT10B_summary %>%  gt::gt() %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Time Commuting Home in a Taxi (Current Position)")) %>% 
  cols_label(n= md("**Number of Participants**"),Address1 = md("**Question**"), percentage = md("**%**")) %>% 
  #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
    stub.font.weight = "bold"
  ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address1,
    )
  )




CURWORKT10C= Mod4 %>%  
  filter(is.na(Mod4$D_786253125_D_772382520)  & Mod4$D_203943120!=353358909 & Mod4$D_374639590!=353358909 & (Mod4$D_828801156==759356722 | Mod4$D_828801156==185036360) &
           ifelse(Mod4$D_684542266==104430631, Mod4$D_404697804_D_404697804_D_660927579==1,
                  ifelse(is.na(Mod4$D_684542266), Mod4$D_404697804_D_404697804_D_660927579==1,
                         ifelse(Mod4$D_203943120==104430631, Mod4$D_635467479_D_635467479_D_892894242==1,
                                ifelse(is.na(Mod4$D_203943120), Mod4$D_635467479_D_635467479_D_892894242==1, NA)))))
CURWORKT10C= CURWORKT10C %>%  mutate(Address1= case_when(is.na(D_786253125_D_772382520) ~"Skipped CURWORKT10C"))

dt_CURWORKT10C_summary <- CURWORKT10C %>% dplyr::group_by(Address1) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address1, n, percentage)


# dt_CURWORKT10C_summary %>%  gt::gt() %>%  
#   fmt_number(columns = "percentage", decimals = 2) %>% 
#   tab_header(title = md("Time Commuting Home in a Motorcycle (Current Position)")) %>% 
#   cols_label(n= md("**Number of Participants**"),Address1 = md("**Question**"), percentage = md("**%**")) %>% 
#   #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
#   tab_options(
#     stub.font.weight = "bold"
#   ) %>%
#   tab_style(
#     style = list(
#       cell_text(weight = "bold")
#     ),
#     locations = cells_body(
#       columns = Address1,
#     )
#   )




CURWORKT10D= Mod4 %>%   
  filter(is.na(Mod4$D_786253125_D_146307133) & Mod4$D_203943120!=353358909 & Mod4$D_374639590!=353358909 & (Mod4$D_828801156==759356722 | Mod4$D_828801156==185036360) &
           ifelse(Mod4$D_684542266==104430631, Mod4$D_404697804_D_404697804_D_940452831==1,
                  ifelse(is.na(Mod4$D_684542266), Mod4$D_404697804_D_404697804_D_940452831==1,
                         ifelse(Mod4$D_203943120==104430631, Mod4$D_635467479_D_635467479_D_177539753==1,
                                ifelse(is.na(Mod4$D_203943120), Mod4$D_635467479_D_635467479_D_177539753==1, NA)))))
CURWORKT10D= CURWORKT10D %>%  mutate(Address1= case_when(is.na(D_786253125_D_146307133) ~"Skipped CURWORKT10D"))

dt_CURWORKT10D_summary <- CURWORKT10D %>% dplyr::group_by(Address1) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address1, n, percentage)


dt_CURWORKT10D_summary %>%  gt::gt() %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Time Commuting Home on a Bus (Current Position)")) %>% 
  cols_label(n= md("**Number of Participants**"),Address1 = md("**Question**"), percentage = md("**%**")) %>% 
  #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
    stub.font.weight = "bold"
  ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address1,
    )
  )




CURWORKT10E= Mod4 %>%  
  filter(is.na(Mod4$D_786253125_D_100591237) & Mod4$D_203943120!=353358909 & Mod4$D_374639590!=353358909 & (Mod4$D_828801156==759356722 | Mod4$D_828801156==185036360) &
           ifelse(Mod4$D_684542266==104430631, Mod4$D_404697804_D_404697804_D_669359763==1,
                  ifelse(is.na(Mod4$D_684542266), Mod4$D_404697804_D_404697804_D_669359763==1,
                         ifelse(Mod4$D_203943120==104430631, Mod4$D_635467479_D_635467479_D_107659596==1,
                                ifelse(is.na(Mod4$D_203943120), Mod4$D_635467479_D_635467479_D_107659596==1, NA)))))
CURWORKT10E= CURWORKT10E %>%  mutate(Address1= case_when(is.na(D_786253125_D_100591237) ~"Skipped CURWORKT10E"))

dt_CURWORKT10E_summary <- CURWORKT10E %>% dplyr::group_by(Address1) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address1, n, percentage)


dt_CURWORKT10E_summary %>%  gt::gt() %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Time Commuting Home on a Subway (Current Position)")) %>% 
  cols_label(n= md("**Number of Participants**"),Address1 = md("**Question**"), percentage = md("**%**")) %>% 
  #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
    stub.font.weight = "bold"
  ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address1,
    )
  )




CURWORKT10F= Mod4 %>%   
  filter(is.na(Mod4$D_786253125_D_823402922) & Mod4$D_203943120!=353358909 & Mod4$D_374639590!=353358909 & (Mod4$D_828801156==759356722 | Mod4$D_828801156==185036360) &
           ifelse(Mod4$D_684542266==104430631, Mod4$D_404697804_D_404697804_D_950972496==1,
                  ifelse(is.na(Mod4$D_684542266), Mod4$D_404697804_D_404697804_D_950972496==1,
                         ifelse(Mod4$D_203943120==104430631, Mod4$D_635467479_D_635467479_D_575883949==1,
                                ifelse(is.na(Mod4$D_203943120), Mod4$D_635467479_D_635467479_D_575883949==1, NA)))))
CURWORKT10F= CURWORKT10F %>%  mutate(Address1= case_when(is.na(D_786253125_D_823402922) ~"Skipped CURWORKT10F"))

dt_CURWORKT10F_summary <- CURWORKT10F %>% dplyr::group_by(Address1) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address1, n, percentage)


dt_CURWORKT10F_summary %>%  gt::gt() %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Time Commuting Home on a Bike (Current Position)")) %>% 
  cols_label(n= md("**Number of Participants**"),Address1 = md("**Question**"), percentage = md("**%**")) %>% 
  #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
    stub.font.weight = "bold"
  ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address1,
    )
  )




CURWORKT10G= Mod4 %>%  
  filter(is.na(Mod4$D_786253125_D_289302451) & Mod4$D_203943120!=353358909 & Mod4$D_374639590!=353358909 & (Mod4$D_828801156==759356722 | Mod4$D_828801156==185036360) &
           ifelse(Mod4$D_684542266==104430631, Mod4$D_404697804_D_404697804_D_137216656==1,
                  ifelse(is.na(Mod4$D_684542266), Mod4$D_404697804_D_404697804_D_137216656==1,
                         ifelse(Mod4$D_203943120==104430631, Mod4$D_635467479_D_635467479_D_248168118==1,
                                ifelse(is.na(Mod4$D_203943120), Mod4$D_635467479_D_635467479_D_248168118==1, NA)))))
CURWORKT10F= CURWORKT10F %>%  mutate(Address1= case_when(is.na(D_786253125_D_289302451) ~"Skipped CURWORKT10F"))

dt_CURWORKT10F_summary <- CURWORKT10F %>% dplyr::group_by(Address1) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address1, n, percentage)


dt_CURWORKT10F_summary %>%  gt::gt() %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Time Commuting Home by Walking (Current Position)")) %>% 
  cols_label(n= md("**Number of Participants**"),Address1 = md("**Question**"), percentage = md("**%**")) %>% 
  #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
    stub.font.weight = "bold"
  ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address1,
    )
  )




# CURWORKT10H= Mod4 %>%  select(D_786253125_D_419151253) %>%  
#   filter(Mod4$D_203943120!=353358909 & Mod4$D_374639590!=353358909 & (Mod4$D_828801156==759356722 | Mod4$D_828801156==185036360) &
#            ifelse(Mod4$D_684542266==104430631, is.na(Mod4$D_404697804_D_404697804_D_631088397),
#                   ifelse(is.na(Mod4$D_684542266), is.na(Mod4$D_404697804_D_404697804_D_631088397),
#                          ifelse(Mod4$D_203943120==104430631, is.na(Mod4$D_635467479_D_635467479_D_902077989),
#                                 ifelse(is.na(Mod4$D_203943120), is.na(Mod4$D_635467479_D_635467479_D_902077989), NA)))))
# vis_miss(CURWORKT10H)+labs(y= "Participants", title="CURWORKT10H")



CURWORKT11_12_13= Mod4 %>%   
  filter( Mod4$D_374639590!=353358909 & (Mod4$D_828801156==759356722 | Mod4$D_828801156==185036360) &
            (Mod4$D_786253125_D_659799855!=428999623 & !is.na(Mod4$D_786253125_D_659799855)) | (Mod4$D_786253125_D_552410034!=428999623 & !is.na(Mod4$D_786253125_D_552410034)) |
            (Mod4$D_786253125_D_772382520!=428999623 & !is.na(Mod4$D_786253125_D_772382520)) | (Mod4$D_786253125_D_146307133!=428999623 & !is.na(Mod4$D_786253125_D_146307133)) |
            (Mod4$D_786253125_D_100591237!=428999623 & !is.na(Mod4$D_786253125_D_100591237)) | (Mod4$D_786253125_D_823402922!=428999623 & !is.na(Mod4$D_786253125_D_823402922)) |
            (Mod4$D_786253125_D_289302451!=428999623 & !is.na(Mod4$D_786253125_D_289302451)) |(Mod4$D_786253125_D_419151253!=428999623 & !is.na(Mod4$D_786253125_D_419151253)))



curworkT11_12_13= CURWORKT11_12_13 %>%  mutate(Address1= case_when(is.na(D_186636914) ~"Skipped if it Includes Highways"))

dt_curworkT11_12_13_summary <- curworkT11_12_13 %>% dplyr::group_by(Address1) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address1, n, percentage)
dt_curworkT11_12_13_summary <- dt_curworkT11_12_13_summary[1,]

dt_curworkT11_12_13_summary[2,1] <- "Skipped if it Includes Major Roads" 
dt_curworkT11_12_13_summary[2,2] <- sum(is.na(curworkT11_12_13$D_936393993))
dt_curworkT11_12_13_summary[2,3] <- (sum(is.na(curworkT11_12_13$D_936393993))/dim(curworkT11_12_13)[[1]])*100

dt_curworkT11_12_13_summary[3,1] <- "Skipped if it Includes Local Roads" 
dt_curworkT11_12_13_summary[3,2] <- sum(is.na(curworkT11_12_13$D_168563469))
dt_curworkT11_12_13_summary[3,3] <- (sum(is.na(curworkT11_12_13$D_168563469))/dim(curworkT11_12_13)[[1]])*100

dt_curworkT11_12_13_summary <- dt_curworkT11_12_13_summary[c(2,3),]
dt_curworkT11_12_13_summary %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Travel Commute Type (Current Position)")) %>% 
  cols_label(n= md("**Number of Participants**"),Address1 = md("**Question**"), percentage = md("**%**")) %>% 
  #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
    stub.font.weight = "bold"
  ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address1,
    )
  )







CURWORKT14= Mod4 %>%  filter(Mod4$D_374639590!=353358909 & (Mod4$D_828801156==759356722 | Mod4$D_828801156==185036360)) %>% 
  mutate(Address1= case_when(is.na(D_219893040) ~"Skipped CURWORKT14"))

dt_CURWORKT14_summary <- CURWORKT14 %>% dplyr::group_by(Address1) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address1, n, percentage)
dt_CURWORKT14_summary <- dt_CURWORKT14_summary[1,]

dt_CURWORKT14_summary %>%  gt::gt() %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Days per Week Commuting Home (Current Position)")) %>% 
  cols_label(n= md("**Number of Participants**"),Address1 = md("**Question**"), percentage = md("**%**")) %>% 
  #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
    stub.font.weight = "bold"
  ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address1,
    )
  )



```

## Work Commutes in the Past
```{r PastCommute, warning=FALSE, echo=FALSE, message=FALSE}

PREWORK= Mod4 %>%  mutate(Address1= case_when(is.na(D_995620555) ~"Skipped PREWORK"))

dt_PREWORK_summary <- PREWORK %>% dplyr::group_by(Address1) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address1, n, percentage)
dt_PREWORK_summary <- dt_PREWORK_summary[1,]

dt_PREWORK_summary %>%  gt::gt() %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Commute Weekly Over the Past 20 Years")) %>% 
  cols_label(n= md("**Number of Participants**"),Address1 = md("**Question**"), percentage = md("**%**")) %>% 
  #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
    stub.font.weight = "bold"
  ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address1,
    )
  )



PREWORKRES= Mod4 %>%  filter(Mod4$D_995620555==353358909 & is.na(Mod4$D_980007418)) %>%  mutate(Address1= case_when(is.na(D_980007418) ~"Skipped PREWORKRES",
TRUE ~ "Answered"))


dt_PREWORKRES_summary <- PREWORKRES %>% dplyr::group_by(Address1) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address1, n, percentage)
dt_PREWORKRES_summary <- dt_PREWORKRES_summary[1,]

dt_PREWORKRES_summary %>%  gt::gt() %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Daily Work Responsibilities Include Driving (Longest Held Position)")) %>% 
  cols_label(n= md("**Number of Participants**"),Address1 = md("**Question**"), percentage = md("**%**")) %>% 
  #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
    stub.font.weight = "bold"
  ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address1,
    )
  )



PREWORK1A= Mod4 %>%   filter(Mod4$D_980007418!=353358909 & Mod4$D_995620555==353358909) %>%  
  mutate(Address1= case_when(is.na(D_291959537) ~"Skipped PREWORK1A"))

dt_PREWORK1A_summary <- PREWORK1A %>% dplyr::group_by(Address1) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address1, n, percentage)
dt_PREWORK1A_summary <- dt_PREWORK1A_summary[1,]

dt_PREWORK1A_summary %>%  gt::gt() %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Current Job Also the Longest Held Job")) %>% 
  cols_label(n= md("**Number of Participants**"),Address1 = md("**Question**"), percentage = md("**%**")) %>% 
  #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
    stub.font.weight = "bold"
  ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address1,
    )
  )






PREWORK1B= Mod4 %>%  filter(Mod4$D_291959537==104430631) %>%  
  mutate(Address1= case_when(is.na(D_992180692_D_452053599) ~"Skipped Employer Name"))

dt_PREWORK1B_summary <- PREWORK1B %>% dplyr::group_by(Address1) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address1, n, percentage)
dt_PREWORK1B_summary <- dt_PREWORK1B_summary[1,]

dt_PREWORK1B_summary[2,1] <- "Skipped Employer Street Number" 
dt_PREWORK1B_summary[2,2] <- sum(is.na(PREWORK1B$D_992180692_D_903896611))
dt_PREWORK1B_summary[2,3] <- (sum(is.na(PREWORK1B$D_992180692_D_903896611))/dim(PREWORK1B)[[1]])*100

dt_PREWORK1B_summary[3,1] <- "Skipped Employer Street Name" 
dt_PREWORK1B_summary[3,2] <- sum(is.na(PREWORK1B$D_992180692_D_855583262))
dt_PREWORK1B_summary[3,3] <- (sum(is.na(PREWORK1B$D_992180692_D_855583262))/dim(PREWORK1B)[[1]])*100

dt_PREWORK1B_summary[4,1] <- "Skipped Employer City" 
dt_PREWORK1B_summary[4,2] <- sum(is.na(PREWORK1B$D_992180692_D_962868433))
dt_PREWORK1B_summary[4,3] <- (sum(is.na(PREWORK1B$D_992180692_D_962868433))/dim(PREWORK1B)[[1]])*100

dt_PREWORK1B_summary[5,1] <- "Skipped Employer State" 
dt_PREWORK1B_summary[5,2] <- sum(is.na(PREWORK1B$D_992180692_D_108530997))
dt_PREWORK1B_summary[5,3] <- (sum(is.na(PREWORK1B$D_992180692_D_108530997))/dim(PREWORK1B)[[1]])*100

dt_PREWORK1B_summary[6,1] <- "Skipped Employer ZIP" 
dt_PREWORK1B_summary[6,2] <- sum(is.na(PREWORK1B$D_992180692_D_110852652))
dt_PREWORK1B_summary[6,3] <- (sum(is.na(PREWORK1B$D_992180692_D_110852652))/dim(PREWORK1B)[[1]])*100

dt_PREWORK1B_summary[7,1] <- "Skipped Employer Country" 
dt_PREWORK1B_summary[7,2] <- sum(is.na(PREWORK1B$D_992180692_D_867109611))
dt_PREWORK1B_summary[7,3] <- (sum(is.na(PREWORK1B$D_992180692_D_867109611))/dim(PREWORK1B)[[1]])*100



dt_PREWORK1B_summary %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Employer Info of Longest Held Job ")) %>% 
  cols_label(n= md("**Number of Participants**"),Address1 = md("**Question**"), percentage = md("**%**")) %>% 
  #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
    stub.font.weight = "bold"
  ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address1,
    )
  )




PREWORK2= Mod4 %>%  filter(Mod4$D_291959537==104430631 & Mod4$D_350394531_D_350394531!="[178420302]" & 
                             (is.na(Mod4$D_350394531_D_652022112) & is.na(Mod4$D_992180692_D_962868433)) |
                             (is.na(Mod4$D_350394531_D_730666903) & is.na(Mod4$D_992180692_D_108530997)) |
                             (is.na(Mod4$D_350394531_D_168091937) & is.na(Mod4$D_992180692_D_110852652)) |
                             (is.na(Mod4$D_350394531_D_132779701) & is.na(Mod4$D_992180692_D_867109611))) %>%  
  mutate(Address1= case_when(is.na(D_350394531_D_652022112) & is.na(D_992180692_D_962868433) ~"Skipped Employer City"))

dt_PREWORK2_summary <- PREWORK2 %>% dplyr::group_by(Address1) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address1, n, percentage)
dt_PREWORK2_summary <- dt_PREWORK2_summary[1,]

dt_PREWORK2_summary[2,1] <- "Skipped Employer State" 
dt_PREWORK2_summary[2,2] <- sum(is.na(PREWORK2$D_350394531_D_730666903) & is.na(PREWORK2$D_992180692_D_108530997) )
dt_PREWORK2_summary[2,3] <- (sum(is.na(PREWORK2$D_350394531_D_730666903) & is.na(PREWORK2$D_992180692_D_962868433) )/dim(PREWORK2)[[1]])*100

dt_PREWORK2_summary[3,1] <- "Skipped Employer ZIP" 
dt_PREWORK2_summary[3,2] <- sum(is.na(PREWORK2$D_350394531_D_168091937) & is.na(PREWORK2$D_992180692_D_110852652))
dt_PREWORK2_summary[3,3] <- (sum(is.na(PREWORK2$D_350394531_D_168091937) & is.na(PREWORK2$D_992180692_D_108530997))/dim(PREWORK2)[[1]])*100

dt_PREWORK2_summary[4,1] <- "Skipped Employer Country" 
dt_PREWORK2_summary[4,2] <- sum(is.na(PREWORK2$D_350394531_D_132779701) & is.na(PREWORK2$D_992180692_D_867109611))
dt_PREWORK2_summary[4,3] <- (sum(is.na(PREWORK2$D_350394531_D_132779701) & is.na(PREWORK2$D_992180692_D_867109611))/dim(PREWORK2)[[1]])*100




dt_PREWORK2_summary %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Follow-up Workplace Address of Longest Held Position")) %>% 
  cols_label(n= md("**Number of Participants**"),Address1 = md("**Question**"), percentage = md("**%**")) %>% 
  #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
    stub.font.weight = "bold"
  ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address1,
    )
  )





PREWORK3_1= Mod4 %>%  
  filter(Mod4$D_733317111_D_733317111!="[178420302]" & Mod4$D_291959537==104430631 &
           is.na(Mod4$D_992180692_D_903896611) & is.na(Mod4$D_992180692_D_855583262) & 
           ((!is.na(Mod4$D_992180692_D_962868433) | !is.na(Mod4$D_992180692_D_108530997) | 
               !is.na(Mod4$D_992180692_D_110852652) | !is.na(Mod4$D_992180692_D_867109611)) | 
              (!is.na(Mod4$D_350394531_D_652022112) | !is.na(Mod4$D_350394531_D_730666903) |
                 !is.na(Mod4$D_350394531_D_168091937) |!is.na(Mod4$D_350394531_D_132779701))))
PREWORK3_1= PREWORK3_1 %>%  mutate(Address1= case_when(is.na(D_733317111_D_584350267) ~"Skipped Cross Street 1"))

dt_PREWORK3_1_summary <- PREWORK3_1 %>% dplyr::group_by(Address1) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address1, n, percentage)
dt_PREWORK3_1_summary <- dt_PREWORK3_1_summary[1,]

dt_PREWORK3_1_summary[2,1] <- "Skipped Cross Street 2" 
dt_PREWORK3_1_summary[2,2] <- sum(is.na(PREWORK3_1$D_733317111_D_840147245))
dt_PREWORK3_1_summary[2,3] <- (sum(is.na(PREWORK3_1$D_733317111_D_840147245))/dim(PREWORK3_1)[[1]])*100

dt_PREWORK3_1_summary %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Cross Streets of Longest Held Position Workplace Address")) %>% 
  cols_label(n= md("**Number of Participants**"),Address1 = md("**Question**"), percentage = md("**%**")) %>% 
  #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
    stub.font.weight = "bold"
  ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address1,
    )
  )




PREWORKYR1_2= Mod4 %>% filter(Mod4$D_291959537==104430631) %>%  
  mutate(Address1= case_when(is.na(D_569375463) ~"Skipped First Year"))

dt_PREWORKYR1_2_summary <- PREWORKYR1_2 %>% dplyr::group_by(Address1) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address1, n, percentage)
dt_PREWORKYR1_2_summary <- dt_PREWORKYR1_2_summary[1,]

dt_PREWORKYR1_2_summary[2,1] <- "Skipped Last Year" 
dt_PREWORKYR1_2_summary[2,2] <- sum(is.na(PREWORKYR1_2$D_822005593))
dt_PREWORKYR1_2_summary[2,3] <- (sum(is.na(PREWORKYR1_2$D_822005593))/dim(PREWORKYR1_2)[[1]])*100

dt_PREWORKYR1_2_summary %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("First and Last Year of Commute to Longest Held Position")) %>% 
  cols_label(n= md("**Number of Participants**"),Address1 = md("**Question**"), percentage = md("**%**")) %>% 
  #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
    stub.font.weight = "bold"
  ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address1,
    )
  )




PREWORKT1= Mod4 %>% filter(Mod4$D_291959537==104430631) %>%  
  mutate(Address1= case_when(is.na(D_311891586_D_311891586_D_172103427) ~"Skipped if Commute Inlcudes a Car"))

dt_PREWORKT1_summary <- PREWORKT1 %>% dplyr::group_by(Address1) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address1, n, percentage)
dt_PREWORKT1_summary <- dt_PREWORKT1_summary[1,]

dt_PREWORKT1_summary[2,1] <- "Skipped if Commute Inlcudes a Taxi" 
dt_PREWORKT1_summary[2,2] <- sum(is.na(PREWORKT1$D_311891586_D_311891586_D_794959813))
dt_PREWORKT1_summary[2,3] <- (sum(is.na(PREWORKT1$D_311891586_D_311891586_D_794959813))/dim(PREWORKT1)[[1]])*100

dt_PREWORKT1_summary[3,1] <- "Skipped if Commute Inlcudes a Motorcycle" 
dt_PREWORKT1_summary[3,2] <- sum(is.na(PREWORKT1$D_311891586_D_311891586_D_683306241))
dt_PREWORKT1_summary[3,3] <- (sum(is.na(PREWORKT1$D_311891586_D_311891586_D_683306241))/dim(PREWORKT1)[[1]])*100

dt_PREWORKT1_summary[4,1] <- "Skipped if Commute Inlcudes a Bus" 
dt_PREWORKT1_summary[4,2] <- sum(is.na(PREWORKT1$D_311891586_D_311891586_D_116442173))
dt_PREWORKT1_summary[4,3] <- (sum(is.na(PREWORKT1$D_311891586_D_311891586_D_116442173))/dim(PREWORKT1)[[1]])*100

dt_PREWORKT1_summary[5,1] <- "Skipped if Commute Inlcudes a Subway" 
dt_PREWORKT1_summary[5,2] <- sum(is.na(PREWORKT1$D_311891586_D_311891586_D_639735881))
dt_PREWORKT1_summary[5,3] <- (sum(is.na(PREWORKT1$D_311891586_D_311891586_D_639735881))/dim(PREWORKT1)[[1]])*100

dt_PREWORKT1_summary[6,1] <- "Skipped if Commute Inlcudes Biking" 
dt_PREWORKT1_summary[6,2] <- sum(is.na(PREWORKT1$D_311891586_D_311891586_D_296254034))
dt_PREWORKT1_summary[6,3] <- (sum(is.na(PREWORKT1$D_311891586_D_311891586_D_296254034))/dim(PREWORKT1)[[1]])*100

dt_PREWORKT1_summary[7,1] <- "Skipped if Commute Inlcudes Walking" 
dt_PREWORKT1_summary[7,2] <- sum(is.na(PREWORKT1$D_311891586_D_311891586_D_807973203))
dt_PREWORKT1_summary[7,3] <- (sum(is.na(PREWORKT1$D_311891586_D_311891586_D_807973203))/dim(PREWORKT1)[[1]])*100

dt_PREWORKT1_summary[8,1] <- "Skipped if Commute Inlcudes Another Method" 
dt_PREWORKT1_summary[8,2] <- sum(is.na(PREWORKT1$D_311891586_D_311891586_D_766970054) & is.na(PREWORKT1$D_311891586_D_886203785))
dt_PREWORKT1_summary[8,3] <- (sum(is.na(PREWORKT1$D_311891586_D_311891586_D_766970054) & is.na(PREWORKT1$D_311891586_D_886203785))/dim(PREWORKT1)[[1]])*100


dt_PREWORKT1_summary %>%  gt::gt() %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Commuting Methods to Work (Longest Held Position)")) %>% 
  cols_label(n= md("**Number of Participants**"),Address1 = md("**Question**"), percentage = md("**%**")) %>% 
  #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
    stub.font.weight = "bold"
  ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address1,
    )
  )






PREWORKT2A_H= Mod4 %>%   
  filter(D_291959537==104430631) %>%  
  mutate(Address1= case_when(is.na(D_968388901_D_169499951) & D_311891586_D_311891586_D_172103427==1 ~"Skipped Time Spent in a Car"))

dt_PREWORKT2A_H_summary <- PREWORKT2A_H %>% dplyr::group_by(Address1) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address1, n, percentage)
dt_PREWORKT2A_H_summary <- dt_PREWORKT2A_H_summary[1,]

dt_PREWORKT2A_H_summary[2,1] <- "Skipped Time Spent in a Taxi" 
taxi <- PREWORKT2A_H %>% filter(D_311891586_D_311891586_D_794959813==1)
dt_PREWORKT2A_H_summary[2,2] <- sum(is.na(taxi$D_968388901_D_343406242))
dt_PREWORKT2A_H_summary[2,3] <- (sum(is.na(taxi$D_968388901_D_343406242))/dim(taxi)[[1]])*100

dt_PREWORKT2A_H_summary[3,1] <- "Skipped Time Spent in a Motorcycle" 
motorcycle <- PREWORKT2A_H %>% filter(D_311891586_D_311891586_D_683306241==1)
dt_PREWORKT2A_H_summary[3,2] <- sum(is.na(motorcycle$D_968388901_D_116882225))
dt_PREWORKT2A_H_summary[3,3] <- (sum(is.na(motorcycle$D_968388901_D_116882225))/dim(motorcycle)[[1]])*100

dt_PREWORKT2A_H_summary[4,1] <- "Skipped Time Spent in a Bus" 
bus <- PREWORKT2A_H %>% filter(D_311891586_D_311891586_D_116442173==1)
dt_PREWORKT2A_H_summary[4,2] <- sum(is.na(bus$D_968388901_D_478513687))
dt_PREWORKT2A_H_summary[4,3] <- (sum(is.na(bus$D_968388901_D_478513687))/dim(bus)[[1]])*100

dt_PREWORKT2A_H_summary[5,1] <- "Skipped Time Spent in a Subway" 
subway <- PREWORKT2A_H %>% filter(D_311891586_D_311891586_D_639735881==1)
dt_PREWORKT2A_H_summary[5,2] <- sum(is.na(subway$D_968388901_D_861097935))
dt_PREWORKT2A_H_summary[5,3] <- (sum(is.na(subway$D_968388901_D_861097935))/dim(subway)[[1]])*100

dt_PREWORKT2A_H_summary[6,1] <- "Skipped Time Spent Biking" 
bike <- PREWORKT2A_H %>% filter(D_311891586_D_311891586_D_296254034==1)
dt_PREWORKT2A_H_summary[6,2] <- sum(is.na(bike$D_968388901_D_109431893))
dt_PREWORKT2A_H_summary[6,3] <- (sum(is.na(bike$D_968388901_D_109431893))/dim(bike)[[1]])*100

dt_PREWORKT2A_H_summary[7,1] <- "Skipped Time Spent Walking" 
walk <- PREWORKT2A_H %>% filter(D_311891586_D_311891586_D_807973203==1)
dt_PREWORKT2A_H_summary[7,2] <- sum(is.na(walk$D_968388901_D_494357137))
dt_PREWORKT2A_H_summary[7,3] <- (sum(is.na(walk$D_968388901_D_494357137))/dim(walk)[[1]])*100

dt_PREWORKT2A_H_summary[8,1] <- "Skipped Time Spent in Another Method" 
method <- PREWORKT2A_H %>% filter(D_311891586_D_311891586_D_766970054==1)
dt_PREWORKT2A_H_summary[8,2] <- sum(is.na(method$D_968388901_D_786244297))
dt_PREWORKT2A_H_summary[8,3] <- (sum(is.na(method$D_968388901_D_786244297))/dim(method)[[1]])*100


dt_PREWORKT2A_H_summary %>%  gt::gt() %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Time Spent in Each Commuting Method (Lonest Held Position)")) %>% 
  cols_label(n= md("**Number of Participants**"),Address1 = md("**Question**"), percentage = md("**%**")) %>% 
  #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
    stub.font.weight = "bold"
  ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address1,
    )
  )



PREWORKT3= Mod4 %>%   filter(Mod4$D_291959537==104430631) %>%  
  mutate(Address1= case_when(is.na(D_335218615) ~"Skipped PREWORKT3"))

dt_PREWORKT3_summary <- PREWORKT3 %>% dplyr::group_by(Address1) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address1, n, percentage)
dt_PREWORKT3_summary <- dt_PREWORKT3_summary[1,]

dt_PREWORKT3_summary %>%  gt::gt() %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Days per Week Commuting (Longest Held Job)")) %>% 
  cols_label(n= md("**Number of Participants**"),Address1 = md("**Question**"), percentage = md("**%**")) %>% 
  #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
    stub.font.weight = "bold"
  ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address1,
    )
  )



PREWORKT4= Mod4 %>%   filter(Mod4$D_291959537==104430631) %>%  
  mutate(Address1= case_when(is.na(D_564557026) ~"Skipped PREWORKT4"))

dt_PREWORKT4_summary <- PREWORKT4 %>% dplyr::group_by(Address1) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address1, n, percentage)
dt_PREWORKT4_summary <- dt_PREWORKT4_summary[1,]

dt_PREWORKT4_summary %>%  gt::gt() %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Same Transportation Commuting to Work as Commuting Home (Longest Held Job)")) %>% 
  cols_label(n= md("**Number of Participants**"),Address1 = md("**Question**"), percentage = md("**%**")) %>% 
  #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
    stub.font.weight = "bold"
  ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address1,
    )
  )





PREWORKT5= Mod4 %>%   filter(Mod4$D_291959537==104430631 & Mod4$D_564557026==353358909) %>%  
  mutate(Address1= case_when(is.na(D_839233937) ~"Skipped PREWORKT5"))

dt_PREWORKT5_summary <- PREWORKT5 %>% dplyr::group_by(Address1) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address1, n, percentage)
dt_PREWORKT5_summary <- dt_PREWORKT5_summary[1,]

dt_PREWORKT5_summary %>%  gt::gt() %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Commuting Time to Work the Same as Commuting Time Home (Longest Held Job)")) %>% 
  cols_label(n= md("**Number of Participants**"),Address1 = md("**Question**"), percentage = md("**%**")) %>% 
  #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
    stub.font.weight = "bold"
  ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address1,
    )
  )






PREWORKT6= Mod4 %>%   
  filter(Mod4$D_291959537==104430631 & Mod4$D_564557026!=353358909)

PREWORKT6= PREWORKT6 %>%  mutate(Address1= case_when(is.na(D_251048648_D_251048648_D_450075248) ~"Skipped if Commute Inlcudes a Car"))

dt_PREWORKT6_summary <- PREWORKT6 %>% dplyr::group_by(Address1) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address1, n, percentage)
dt_PREWORKT6_summary <- dt_PREWORKT6_summary[1,]

dt_PREWORKT6_summary[2,1] <- "Skipped if Commute Inlcudes a Taxi" 
dt_PREWORKT6_summary[2,2] <- sum(is.na(PREWORKT6$D_251048648_D_251048648_D_471142791))
dt_PREWORKT6_summary[2,3] <- (sum(is.na(PREWORKT6$D_251048648_D_251048648_D_471142791))/dim(PREWORKT6)[[1]])*100

dt_PREWORKT6_summary[3,1] <- "Skipped if Commute Inlcudes a Motorcycle" 
dt_PREWORKT6_summary[3,2] <- sum(is.na(PREWORKT6$D_251048648_D_251048648_D_197093427))
dt_PREWORKT6_summary[3,3] <- (sum(is.na(PREWORKT6$D_251048648_D_251048648_D_197093427))/dim(PREWORKT6)[[1]])*100

dt_PREWORKT6_summary[4,1] <- "Skipped if Commute Inlcudes a Bus" 
dt_PREWORKT6_summary[4,2] <- sum(is.na(PREWORKT6$D_251048648_D_251048648_D_779421821))
dt_PREWORKT6_summary[4,3] <- (sum(is.na(PREWORKT6$D_251048648_D_251048648_D_779421821))/dim(PREWORKT6)[[1]])*100

dt_PREWORKT6_summary[5,1] <- "Skipped if Commute Inlcudes a Subway" 
dt_PREWORKT6_summary[5,2] <- sum(is.na(PREWORKT6$D_251048648_D_251048648_D_925663113))
dt_PREWORKT6_summary[5,3] <- (sum(is.na(PREWORKT6$D_251048648_D_251048648_D_925663113))/dim(PREWORKT6)[[1]])*100

dt_PREWORKT6_summary[6,1] <- "Skipped if Commute Inlcudes Biking" 
dt_PREWORKT6_summary[6,2] <- sum(is.na(PREWORKT6$D_251048648_D_251048648_D_368973683))
dt_PREWORKT6_summary[6,3] <- (sum(is.na(PREWORKT6$D_251048648_D_251048648_D_368973683))/dim(PREWORKT6)[[1]])*100

dt_PREWORKT6_summary[7,1] <- "Skipped if Commute Inlcudes Walking" 
dt_PREWORKT6_summary[7,2] <- sum(is.na(PREWORKT6$D_251048648_D_251048648_D_830201925))
dt_PREWORKT6_summary[7,3] <- (sum(is.na(PREWORKT6$D_251048648_D_251048648_D_830201925))/dim(PREWORKT6)[[1]])*100

dt_PREWORKT6_summary[8,1] <- "Skipped if Commute Inlcudes Another Method" 
dt_PREWORKT6_summary[8,2] <- sum(is.na(PREWORKT6$D_251048648_D_251048648_D_572643998) & is.na(PREWORKT6$D_251048648_D_158678876))
dt_PREWORKT6_summary[8,3] <- (sum(is.na(PREWORKT6$D_251048648_D_251048648_D_572643998) & is.na(PREWORKT6$D_251048648_D_158678876))/dim(PREWORKT6)[[1]])*100


dt_PREWORKT6_summary %>%  gt::gt() %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Commuting Methods Home From Work (Longest Held Position)")) %>% 
  cols_label(n= md("**Number of Participants**"),Address1 = md("**Question**"), percentage = md("**%**")) %>% 
  #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
    stub.font.weight = "bold"
  ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address1,
    )
  )



# PREWORKT7A= Mod4 %>% 
#   filter(Mod4$D_291959537==104430631 & Mod4$D_839233937!=353358909 & 
#            ifelse(Mod4$D_564557026==104430631, Mod4$D_251048648_D_251048648_D_450075248==1,
#                   ifelse(is.na(Mod4$D_564557026), Mod4$D_251048648_D_251048648_D_450075248==1,
#                          ifelse(Mod4$D_839233937==104430631, Mod4$D_311891586_D_311891586_D_172103427==1,
#                                 ifelse(is.na(Mod4$D_839233937), Mod4$D_311891586_D_311891586_D_172103427==1, NA))))) ##review when variables re-added
# 
# PREWORKT7A= PREWORKT7A %>%  mutate(Address1= case_when(is.na(D_475144270) ~"Skipped PREWORKT7A"))
# 
# dt_PREWORKT7A_summary <- PREWORKT7A %>% dplyr::group_by(Address1) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address1, n, percentage)
# dt_PREWORKT7A_summary <- dt_PREWORKT7A_summary[1,]
# 
# dt_PREWORKT7A_summary %>%  gt::gt() %>%  
#   fmt_number(columns = "percentage", decimals = 2) %>% 
#   tab_header(title = md("Use a Car to Commute Home (Longest Held Job)")) %>% 
#   cols_label(n= md("**Number of Participants**"),Address1 = md("**Question**"), percentage = md("**%**")) %>% 
#   #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
#   tab_options(
#     stub.font.weight = "bold"
#   ) %>%
#   tab_style(
#     style = list(
#       cell_text(weight = "bold")
#     ),
#     locations = cells_body(
#       columns = Address1,
#     )
#   )
# 
# 
# 
# 
# PREWORKT7B= Mod4 %>% 
#   filter(Mod4$D_291959537==104430631 & Mod4$D_839233937!=353358909 &
#            ifelse(Mod4$D_564557026==104430631, Mod4$D_251048648_D_251048648_D_471142791==1,
#                   ifelse(is.na(Mod4$D_564557026), Mod4$D_251048648_D_251048648_D_471142791==1,
#                          ifelse(Mod4$D_839233937==104430631, Mod4$D_311891586_D_311891586_D_794959813==1,
#                                 ifelse(is.na(Mod4$D_839233937), Mod4$D_311891586_D_311891586_D_794959813==1, NA)))))
# 
# PREWORKT7B= PREWORKT7B %>%  mutate(Address1= case_when(is.na(D_475144270) ~"Skipped PREWORKT7B"))
# 
# dt_PREWORKT7B_summary <- PREWORKT7B %>% dplyr::group_by(Address1) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address1, n, percentage)
# dt_PREWORKT7B_summary <- dt_PREWORKT7B_summary[1,]
# 
# dt_PREWORKT7B_summary %>%  gt::gt() %>%  
#   fmt_number(columns = "percentage", decimals = 2) %>% 
#   tab_header(title = md("Use a Taxi to Commute Home (Longest Held Job)")) %>% 
#   cols_label(n= md("**Number of Participants**"),Address1 = md("**Question**"), percentage = md("**%**")) %>% 
#   #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
#   tab_options(
#     stub.font.weight = "bold"
#   ) %>%
#   tab_style(
#     style = list(
#       cell_text(weight = "bold")
#     ),
#     locations = cells_body(
#       columns = Address1,
#     )
#   )
# 
# 
# 
# 
# PREWORKT7C= Mod4 %>% 
#   filter(Mod4$D_291959537==104430631 & Mod4$D_839233937!=353358909 &
#            ifelse(Mod4$D_564557026==104430631, Mod4$D_251048648_D_251048648_D_197093427==1,
#                   ifelse(is.na(Mod4$D_564557026), Mod4$D_251048648_D_251048648_D_197093427==1,
#                          ifelse(Mod4$D_839233937==104430631, Mod4$D_311891586_D_311891586_D_683306241==1,
#                                 ifelse(is.na(Mod4$D_839233937), Mod4$D_311891586_D_311891586_D_683306241==1, NA)))))
# PREWORKT7C= PREWORKT7C %>%  mutate(Address1= case_when(is.na(D_475144270) ~"Skipped PREWORKT7C"))
# 
# dt_PREWORKT7C_summary <- PREWORKT7C %>% dplyr::group_by(Address1) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address1, n, percentage)
# dt_PREWORKT7C_summary <- dt_PREWORKT7C_summary[1,]
# 
# dt_PREWORKT7C_summary %>%  gt::gt() %>%  
#   fmt_number(columns = "percentage", decimals = 2) %>% 
#   tab_header(title = md("Use a Motorcycle to Commute Home (Longest Held Job)")) %>% 
#   cols_label(n= md("**Number of Participants**"),Address1 = md("**Question**"), percentage = md("**%**")) %>% 
#   #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
#   tab_options(
#     stub.font.weight = "bold"
#   ) %>%
#   tab_style(
#     style = list(
#       cell_text(weight = "bold")
#     ),
#     locations = cells_body(
#       columns = Address1,
#     )
#   )
# 
# 
# 
# 
# PREWORKT7D= Mod4 %>% 
#   filter(Mod4$D_291959537==104430631 & Mod4$D_839233937!=353358909 &
#            ifelse(Mod4$D_564557026==104430631, Mod4$D_251048648_D_251048648_D_779421821==1,
#                   ifelse(is.na(Mod4$D_564557026), Mod4$D_251048648_D_251048648_D_779421821==1,
#                          ifelse(Mod4$D_839233937==104430631, Mod4$D_311891586_D_311891586_D_116442173==1,
#                                 ifelse(is.na(Mod4$D_839233937), Mod4$D_311891586_D_311891586_D_116442173==1, NA)))))
# 
# PREWORKT7D= PREWORKT7D %>%  mutate(Address1= case_when(is.na(D_475144270) ~"Skipped PREWORKT7D"))
# 
# dt_PREWORKT7D_summary <- PREWORKT7D %>% dplyr::group_by(Address1) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address1, n, percentage)
# dt_PREWORKT7D_summary <- dt_PREWORKT7D_summary[1,]
# 
# dt_PREWORKT7D_summary %>%  gt::gt() %>%  
#   fmt_number(columns = "percentage", decimals = 2) %>% 
#   tab_header(title = md("Use a Bus to Commute Home (Longest Held Job)")) %>% 
#   cols_label(n= md("**Number of Participants**"),Address1 = md("**Question**"), percentage = md("**%**")) %>% 
#   #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
#   tab_options(
#     stub.font.weight = "bold"
#   ) %>%
#   tab_style(
#     style = list(
#       cell_text(weight = "bold")
#     ),
#     locations = cells_body(
#       columns = Address1,
#     )
#   )
# 
# 
# 
# 
# PREWORKT7E= Mod4 %>% 
#   filter(Mod4$D_291959537==104430631 & Mod4$D_839233937!=353358909 &
#            ifelse(Mod4$D_564557026==104430631, Mod4$D_251048648_D_251048648_D_925663113==1,
#                   ifelse(is.na(Mod4$D_564557026), Mod4$D_251048648_D_251048648_D_925663113==1,
#                          ifelse(Mod4$D_839233937==104430631, Mod4$D_311891586_D_311891586_D_639735881==1,
#                                 ifelse(is.na(Mod4$D_839233937), Mod4$D_311891586_D_311891586_D_639735881==1, NA)))))
# 
# PREWORKT7E= PREWORKT7E %>%  mutate(Address1= case_when(is.na(D_475144270) ~"Skipped PREWORKT7E"))
# 
# dt_PREWORKT7E_summary <- PREWORKT7E %>% dplyr::group_by(Address1) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address1, n, percentage)
# dt_PREWORKT7E_summary <- dt_PREWORKT7E_summary[1,]
# 
# dt_PREWORKT7E_summary %>%  gt::gt() %>%  
#   fmt_number(columns = "percentage", decimals = 2) %>% 
#   tab_header(title = md("Use a Subway to Commute Home (Longest Held Job)")) %>% 
#   cols_label(n= md("**Number of Participants**"),Address1 = md("**Question**"), percentage = md("**%**")) %>% 
#   #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
#   tab_options(
#     stub.font.weight = "bold"
#   ) %>%
#   tab_style(
#     style = list(
#       cell_text(weight = "bold")
#     ),
#     locations = cells_body(
#       columns = Address1,
#     )
#   )
# 
# 
# 
# 
# PREWORKT7F= Mod4 %>% 
#   filter(Mod4$D_291959537==104430631 & Mod4$D_839233937!=353358909 &
#            ifelse(Mod4$D_564557026==104430631, Mod4$D_251048648_D_251048648_D_368973683==1,
#                   ifelse(is.na(Mod4$D_564557026), Mod4$D_251048648_D_251048648_D_368973683==1,
#                          ifelse(Mod4$D_839233937==104430631, Mod4$D_311891586_D_311891586_D_296254034==1,
#                                 ifelse(is.na(Mod4$D_839233937), Mod4$D_311891586_D_311891586_D_296254034==1, NA)))))
# 
# PREWORKT7F= PREWORKT7F %>%  mutate(Address1= case_when(is.na(D_475144270) ~"Skipped PREWORKT7F"))
# 
# dt_PREWORKT7F_summary <- PREWORKT7F %>% dplyr::group_by(Address1) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address1, n, percentage)
# dt_PREWORKT7F_summary <- dt_PREWORKT7F_summary[1,]
# 
# dt_PREWORKT7F_summary %>%  gt::gt() %>%  
#   fmt_number(columns = "percentage", decimals = 2) %>% 
#   tab_header(title = md("Use a Bike to Commute Home (Longest Held Job)")) %>% 
#   cols_label(n= md("**Number of Participants**"),Address1 = md("**Question**"), percentage = md("**%**")) %>% 
#   #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
#   tab_options(
#     stub.font.weight = "bold"
#   ) %>%
#   tab_style(
#     style = list(
#       cell_text(weight = "bold")
#     ),
#     locations = cells_body(
#       columns = Address1,
#     )
#   )
# 
# 
# 
# 
# PREWORKT7G= Mod4 %>%
#   filter(Mod4$D_291959537==104430631 & Mod4$D_839233937!=353358909 &
#            ifelse(Mod4$D_564557026==104430631, Mod4$D_251048648_D_251048648_D_830201925==1,
#                   ifelse(is.na(Mod4$D_564557026), Mod4$D_251048648_D_251048648_D_830201925==1,
#                          ifelse(Mod4$D_839233937==104430631, Mod4$D_311891586_D_311891586_D_807973203==1,
#                                 ifelse(is.na(Mod4$D_839233937), Mod4$D_311891586_D_311891586_D_807973203==1, NA)))))
# 
# PREWORKT7G= PREWORKT7G %>%  mutate(Address1= case_when(is.na(D_475144270) ~"Skipped PREWORKT7G"))
# 
# dt_PREWORKT7G_summary <- PREWORKT7G %>% dplyr::group_by(Address1) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address1, n, percentage)
# dt_PREWORKT7G_summary <- dt_PREWORKT7G_summary[1,]
# 
# dt_PREWORKT7G_summary %>%  gt::gt() %>%  
#   fmt_number(columns = "percentage", decimals = 2) %>% 
#   tab_header(title = md("Walking to Commute Home (Longest Held Job)")) %>% 
#   cols_label(n= md("**Number of Participants**"),Address1 = md("**Question**"), percentage = md("**%**")) %>% 
#   #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
#   tab_options(
#     stub.font.weight = "bold"
#   ) %>%
#   tab_style(
#     style = list(
#       cell_text(weight = "bold")
#     ),
#     locations = cells_body(
#       columns = Address1,
#     )
#   )
# 
# 
# 
# 
# PREWORKT7H= Mod4 %>%
#   filter(Mod4$D_291959537==104430631 & Mod4$D_839233937!=353358909 &
#            ifelse(Mod4$D_564557026==104430631, Mod4$D_251048648_D_251048648_D_572643998==1,
#                   ifelse(is.na(Mod4$D_564557026), Mod4$D_251048648_D_251048648_D_572643998==1,
#                          ifelse(Mod4$D_839233937==104430631, Mod4$D_311891586_D_311891586_D_766970054==1,
#                                 ifelse(is.na(Mod4$D_839233937), Mod4$D_311891586_D_311891586_D_766970054==1, NA)))))
# 
# PREWORKT7H= PREWORKT7H %>%  mutate(Address1= case_when(is.na(D_475144270) ~"Skipped PREWORKT7H"))
# 
# dt_PREWORKT7H_summary <- PREWORKT7H %>% dplyr::group_by(Address1) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address1, n, percentage)
# dt_PREWORKT7H_summary <- dt_PREWORKT7H_summary[1,]
# 
# dt_PREWORKT7H_summary %>%  gt::gt() %>%  
#   fmt_number(columns = "percentage", decimals = 2) %>% 
#   tab_header(title = md("Use Another Method to Commute Home (Longest Held Job)")) %>% 
#   cols_label(n= md("**Number of Participants**"),Address1 = md("**Question**"), percentage = md("**%**")) %>% 
#   #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
#   tab_options(
#     stub.font.weight = "bold"
#   ) %>%
#   tab_style(
#     style = list(
#       cell_text(weight = "bold")
#     ),
#     locations = cells_body(
#       columns = Address1,
#     )
#   )
# 





PREWORKT8= Mod4 %>%   filter(Mod4$D_291959537==104430631) %>%  
  mutate(Address1= case_when(is.na(D_475144270) ~"Skipped PREWORKT8"))

dt_PREWORKT8_summary <- PREWORKT8 %>% dplyr::group_by(Address1) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address1, n, percentage)
dt_PREWORKT8_summary <- dt_PREWORKT8_summary[1,]

dt_PREWORKT8_summary %>%  gt::gt() %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Days per Week Commuting Home (Longest Held Job)")) %>% 
  cols_label(n= md("**Number of Participants**"),Address1 = md("**Question**"), percentage = md("**%**")) %>% 
  #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
    stub.font.weight = "bold"
  ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address1,
    )
  )



```

## Commute School Commute
```{r School, warning=FALSE, echo=FALSE, message=FALSE}

STU= Mod4 %>% filter(Mod4$D_784967158==551525967 | Mod4$D_784967158==738284740)


CURSCHCOM= STU %>% mutate(Address1= case_when(is.na(D_449752653) ~"Skipped CURSCHCOM"))

dt_CURSCHCOM_summary <- CURSCHCOM %>% dplyr::group_by(Address1) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address1, n, percentage)
dt_CURSCHCOM_summary <- dt_CURSCHCOM_summary[1,]

dt_CURSCHCOM_summary %>%  gt::gt() %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Commute to School at Least Once per Week")) %>% 
  cols_label(n= md("**Number of Participants**"),Address1 = md("**Question**"), percentage = md("**%**")) %>% 
  tab_options(
    stub.font.weight = "bold"
  ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address1,
    )
  )




CURSCHCOM2= STU %>%  filter(STU$D_449752653==353358909) %>% mutate(Address1= case_when(is.na(D_959371875) ~"Skipped CURSCHCOM2"))

dt_CURSCHCOM2_summary <- CURSCHCOM2 %>% dplyr::group_by(Address1) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address1, n, percentage)
dt_CURSCHCOM2_summary <- dt_CURSCHCOM2_summary[1,]

dt_CURSCHCOM2_summary %>%  gt::gt() %>%
  fmt_number(columns = "percentage", decimals = 2) %>%
  tab_header(title = md("Number of Schools Commuter to per Week")) %>%
  cols_label(n= md("**Number of Participants**"),Address1 = md("**Question**"), percentage = md("**%**")) %>%
  tab_options(
    stub.font.weight = "bold"
  ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address1,
    )
  )



#table(STU$D_449752653) #only 4 commute
stu_addressFU= STU %>%  filter(STU$D_449752653==353358909 & STU$D_668887646_D_668887646!="[178420302]") %>%  
  mutate(Address1= case_when(is.na(D_668887646_D_225725599)  & is.na(D_914696832_D_161170041)~"Skipped City Follow-up"))

dt_stu_addressFU_summary <- stu_addressFU %>% dplyr::group_by(Address1) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address1, n, percentage)
dt_stu_addressFU_summary <- dt_stu_addressFU_summary[1,]

dt_stu_addressFU_summary[2,1] <- "Skipped State Follow-up" 
dt_stu_addressFU_summary[2,2] <- sum(is.na(stu_addressFU$D_668887646_D_977086216) & is.na(stu_addressFU$D_914696832_D_660217075))
dt_stu_addressFU_summary[2,3] <- (sum(is.na(stu_addressFU$D_668887646_D_977086216) & is.na(stu_addressFU$D_914696832_D_660217075))/dim(stu_addressFU)[[1]])*100

dt_stu_addressFU_summary[3,1] <- "Skipped ZIP Follow-up" 
dt_stu_addressFU_summary[3,2] <- sum(is.na(stu_addressFU$D_668887646_D_997041632) & is.na(stu_addressFU$D_914696832_D_884494489))
dt_stu_addressFU_summary[3,3] <- (sum(is.na(stu_addressFU$D_668887646_D_997041632) & is.na(stu_addressFU$D_914696832_D_884494489))/dim(stu_addressFU)[[1]])*100

dt_stu_addressFU_summary[4,1] <- "Skipped Country Follow-up" 
dt_stu_addressFU_summary[4,2] <- sum(is.na(stu_addressFU$D_668887646_D_147113671) & is.na(stu_addressFU$D_914696832_D_403679963))
dt_stu_addressFU_summary[4,3] <- (sum(is.na(stu_addressFU$D_668887646_D_147113671) & is.na(stu_addressFU$D_914696832_D_403679963))/dim(stu_addressFU)[[1]])*100

dt_stu_addressFU_summary <- dt_stu_addressFU_summary[c(2:4),]
dt_stu_addressFU_summary %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("School Address Follow-up")) %>% 
  cols_label(n= md("**Number of Participants**"),Address1 = md("**Question**"), percentage = md("**%**")) %>% 
  tab_options(
    stub.font.weight = "bold"
  ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address1,
    )
  )





CURSCH3= STU %>% 
  filter(STU$D_443679537_D_443679537!="[178420302]" &
           is.na(STU$D_914696832_D_970996351) & is.na(STU$D_914696832_D_249657148) & 
           ((!is.na(STU$D_914696832_D_161170041) | !is.na(STU$D_914696832_D_660217075) | !is.na(STU$D_914696832_D_884494489) |
               !is.na(STU$D_914696832_D_403679963)) | (!is.na(STU$D_668887646_D_225725599) | !is.na(STU$D_668887646_D_977086216) |
                                                         !is.na(STU$D_668887646_D_997041632) |!is.na(STU$D_668887646_D_147113671))))

CURSCH3= STU %>%  filter(STU$D_449752653==353358909 & STU$D_668887646_D_668887646!="[178420302]") %>%  
  mutate(Address1= case_when(is.na(D_443679537_D_494271326)~"Skipped Cross-Street 1"))

dt_CURSCH3_summary <- CURSCH3 %>% dplyr::group_by(Address1) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address1, n, percentage)
dt_CURSCH3_summary <- dt_CURSCH3_summary[1,]

dt_CURSCH3_summary[2,1] <- "Skipped Cross-Street 2" 
dt_CURSCH3_summary[2,2] <- sum(is.na(CURSCH3$D_443679537_D_952170182))
dt_CURSCH3_summary[2,3] <- (sum(is.na(CURSCH3$D_443679537_D_952170182))/dim(CURSCH3)[[1]])*100

dt_CURSCH3_summary %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("School Address Cross-Streets")) %>% 
  cols_label(n= md("**Number of Participants**"),Address1 = md("**Question**"), percentage = md("**%**")) %>% 
  tab_options(
    stub.font.weight = "bold"
  ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address1,
    )
  )





CURSCHYR1= STU %>%  filter(STU$D_449752653==353358909) %>%  
  mutate(Address1= case_when(is.na(D_224209278_D_744987950)~"Skipped Month Commuting Started"))

dt_CURSCHYR1_summary <- CURSCHYR1 %>% dplyr::group_by(Address1) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address1, n, percentage)
dt_CURSCHYR1_summary <- dt_CURSCHYR1_summary[1,]

dt_CURSCHYR1_summary[2,1] <- "Skipped Year Commutng Started" 
dt_CURSCHYR1_summary[2,2] <- sum(is.na(CURSCHYR1$D_224209278_D_770959058))
dt_CURSCHYR1_summary[2,3] <- (sum(is.na(CURSCHYR1$D_224209278_D_770959058))/dim(CURSCHYR1)[[1]])*100

dt_CURSCHYR1_summary[3,1] <- "Skipped Months per Year Commuting" 
dt_CURSCHYR1_summary[3,2] <- sum(is.na(CURSCHYR1$D_659744749))
dt_CURSCHYR1_summary[3,3] <- (sum(is.na(CURSCHYR1$D_659744749))/dim(CURSCHYR1)[[1]])*100

dt_CURSCHYR1_summary %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Timeframe Commuting to School")) %>% 
  cols_label(n= md("**Number of Participants**"),Address1 = md("**Question**"), percentage = md("**%**")) %>% 
  tab_options(
    stub.font.weight = "bold"
  ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address1,
    )
  )




CURSCHT1= STU %>% filter(STU$D_449752653==353358909) %>% 
  mutate(Address1= case_when(is.na(D_404863614_D_404863614_D_782113721) ~"Skipped if Commute Inlcudes a Car"))

dt_CURSCHT1_summary <- CURSCHT1 %>% dplyr::group_by(Address1) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address1, n, percentage)
dt_CURSCHT1_summary <- dt_CURSCHT1_summary[1,]

dt_CURSCHT1_summary[2,1] <- "Skipped if Commute Inlcudes a Taxi" 
dt_CURSCHT1_summary[2,2] <- sum(is.na(CURSCHT1$D_404863614_D_404863614_D_207263450))
dt_CURSCHT1_summary[2,3] <- (sum(is.na(CURSCHT1$D_404863614_D_404863614_D_207263450))/dim(CURSCHT1)[[1]])*100


dt_CURSCHT1_summary[3,1] <- "Skipped if Commute Inlcudes a Motorcycle" 
dt_CURSCHT1_summary[3,2] <- ifelse (exists("CURSCHT1$D_404863614_D_404863614_D_638833327"), sum(is.na(CURSCHT1$D_404863614_D_404863614_D_638833327)), 0)
dt_CURSCHT1_summary[3,3] <- (sum(is.na(CURSCHT1$D_404863614_D_404863614_D_638833327))/dim(CURSCHT1)[[1]])*100


dt_CURSCHT1_summary[4,1] <- "Skipped if Commute Inlcudes a Bus" 
dt_CURSCHT1_summary[4,2] <- sum(is.na(CURSCHT1$D_404863614_D_404863614_D_736981982))
dt_CURSCHT1_summary[4,3] <- (sum(is.na(CURSCHT1$D_404863614_D_404863614_D_736981982))/dim(CURSCHT1)[[1]])*100

dt_CURSCHT1_summary[5,1] <- "Skipped if Commute Inlcudes a Subway" 
dt_CURSCHT1_summary[5,2] <- sum(is.na(CURSCHT1$D_404863614_D_404863614_D_932195315))
dt_CURSCHT1_summary[5,3] <- (sum(is.na(CURSCHT1$D_404863614_D_404863614_D_932195315))/dim(CURSCHT1)[[1]])*100

dt_CURSCHT1_summary[6,1] <- "Skipped if Commute Inlcudes Biking" 
dt_CURSCHT1_summary[6,2] <- sum(is.na(CURSCHT1$D_404863614_D_404863614_D_279026426))
dt_CURSCHT1_summary[6,3] <- (sum(is.na(CURSCHT1$D_404863614_D_404863614_D_279026426))/dim(CURSCHT1)[[1]])*100

dt_CURSCHT1_summary[7,1] <- "Skipped if Commute Inlcudes Walking" 
dt_CURSCHT1_summary[7,2] <- sum(is.na(CURSCHT1$D_404863614_D_404863614_D_691579493))
dt_CURSCHT1_summary[7,3] <- (sum(is.na(CURSCHT1$D_404863614_D_404863614_D_691579493))/dim(CURSCHT1)[[1]])*100

dt_CURSCHT1_summary[8,1] <- "Skipped if Commute Inlcudes Another Method" 
dt_CURSCHT1_summary[8,2] <- sum(is.na(CURSCHT1$D_404863614_D_404863614_D_211269389) & is.na(CURSCHT1$D_404863614_D_255860829))
dt_CURSCHT1_summary[8,3] <- (sum(is.na(CURSCHT1$D_404863614_D_404863614_D_211269389) & is.na(CURSCHT1$D_404863614_D_255860829))/dim(CURSCHT1)[[1]])*100


dt_CURSCHT1_summary %>%  gt::gt() %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Commuting Methods to School")) %>% 
  cols_label(n= md("**Number of Participants**"),Address1 = md("**Question**"), percentage = md("**%**")) %>% 
  #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
    stub.font.weight = "bold"
  ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address1,
    )
  )




CURSCHT2A_H= STU %>% filter(STU$D_449752653==353358909) %>%  
  mutate(Address1= case_when(is.na(D_716117817_D_135529881_D_891237683) & D_404863614_D_404863614_D_782113721==1 ~"Skipped Time Spent in a Car"))

dt_CURSCHT2A_H_summary <- CURSCHT2A_H %>% dplyr::group_by(Address1) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address1, n, percentage)
dt_CURSCHT2A_H_summary <- dt_CURSCHT2A_H_summary[1,]

dt_CURSCHT2A_H_summary[2,1] <- "Skipped Time Spent in a Taxi" 
taxi <- CURSCHT2A_H %>% filter(D_404863614_D_404863614_D_207263450==1)
dt_CURSCHT2A_H_summary[2,2] <- sum(is.na(taxi$D_716117817_D_135529881_D_980695076))
dt_CURSCHT2A_H_summary[2,3] <- (sum(is.na(taxi$D_716117817_D_135529881_D_980695076))/dim(taxi)[[1]])*100

dt_CURSCHT2A_H_summary[3,1] <- "Skipped Time Spent in a Motorcycle" 
#ifelse (exists("D_404863614_D_404863614_D_638833327"), motorcycle <- CURSCHT2A_H %>% filter(D_404863614_D_404863614_D_638833327==1), motorcycle <- CURSCHT2A_H)
dt_CURSCHT2A_H_summary[3,2] <- ifelse (exists("D_716117817_D_135529881_D_265423096"),  sum(is.na(motorcycle$D_716117817_D_135529881_D_265423096)), 0)
dt_CURSCHT2A_H_summary[3,3] <- ifelse (exists("D_716117817_D_135529881_D_265423096"), (sum(is.na(motorcycle$D_716117817_D_135529881_D_265423096))/dim(motorcycle)[[1]])*100, 0)

dt_CURSCHT2A_H_summary[4,1] <- "Skipped Time Spent in a Bus" 
bus <- CURSCHT2A_H %>% filter(D_404863614_D_404863614_D_736981982==1)
dt_CURSCHT2A_H_summary[4,2] <- sum(is.na(bus$D_716117817_D_135529881_D_185533250))
dt_CURSCHT2A_H_summary[4,3] <- (sum(is.na(bus$D_716117817_D_135529881_D_185533250))/dim(bus)[[1]])*100

dt_CURSCHT2A_H_summary[5,1] <- "Skipped Time Spent in a Subway" 
subway <- CURSCHT2A_H %>% filter(D_404863614_D_404863614_D_932195315==1)
dt_CURSCHT2A_H_summary[5,2] <- sum(is.na(subway$D_716117817_D_135529881_D_769785846))
dt_CURSCHT2A_H_summary[5,3] <- (sum(is.na(subway$D_716117817_D_135529881_D_769785846))/dim(subway)[[1]])*100

dt_CURSCHT2A_H_summary[6,1] <- "Skipped Time Spent Biking" 
bike <- CURSCHT2A_H %>% filter(D_404863614_D_404863614_D_279026426==1)
dt_CURSCHT2A_H_summary[6,2] <- sum(is.na(bike$D_716117817_D_135529881_D_330492115))
dt_CURSCHT2A_H_summary[6,3] <- (sum(is.na(bike$D_716117817_D_135529881_D_330492115))/dim(bike)[[1]])*100

dt_CURSCHT2A_H_summary[7,1] <- "Skipped Time Spent Walking" 
walk <- CURSCHT2A_H %>% filter(D_404863614_D_404863614_D_691579493==1)
dt_CURSCHT2A_H_summary[7,2] <- sum(is.na(walk$D_716117817_D_135529881_D_173979298))
dt_CURSCHT2A_H_summary[7,3] <- (sum(is.na(walk$D_716117817_D_135529881_D_173979298))/dim(walk)[[1]])*100

dt_CURSCHT2A_H_summary[8,1] <- "Skipped Time Spent in Another Method" 
method <- CURSCHT2A_H %>% filter(D_404863614_D_404863614_D_211269389==1)
dt_CURSCHT2A_H_summary[8,2] <- sum(is.na(method$D_716117817_D_135529881_D_154229258))
dt_CURSCHT2A_H_summary[8,3] <- (sum(is.na(method$D_716117817_D_135529881_D_154229258))/dim(method)[[1]])*100


dt_CURSCHT2A_H_summary %>%  gt::gt() %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Time Spent in Each Commuting Method (Current Position)")) %>% 
  cols_label(n= md("**Number of Participants**"),Address1 = md("**Question**"), percentage = md("**%**")) %>% 
  #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
    stub.font.weight = "bold"
  ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address1,
    )
  )




CURSCHT3_4_5= STU %>%  select(D_136660779, D_107050954, D_559488982) %>%
  filter(STU$D_449752653==353358909 & 
           (STU$D_716117817_D_135529881_D_891237683!=428999623 & !is.na(STU$D_716117817_D_135529881_D_891237683)) |
           (STU$D_716117817_D_135529881_D_980695076!=428999623 & !is.na(STU$D_716117817_D_135529881_D_980695076)) |
           (STU$D_716117817_D_135529881_D_265423096!=428999623 & !is.na(STU$D_716117817_D_135529881_D_265423096)) |
           (STU$D_716117817_D_135529881_D_185533250!=428999623 & !is.na(STU$D_716117817_D_135529881_D_185533250)) |
           (STU$D_716117817_D_135529881_D_769785846!=428999623 & !is.na(STU$D_716117817_D_135529881_D_769785846)) |
           (STU$D_716117817_D_135529881_D_330492115!=428999623 & !is.na(STU$D_716117817_D_135529881_D_330492115)) |
           (STU$D_716117817_D_135529881_D_173979298!=428999623 & !is.na(STU$D_716117817_D_135529881_D_173979298)) |
           (STU$D_716117817_D_135529881_D_154229258!=428999623 & !is.na(STU$D_716117817_D_135529881_D_154229258)))

CURSCHT3_4_5= CURSCHT3_4_5 %>%   
  mutate(Address1= case_when(is.na(D_136660779) ~"Skipped if Includes Highway(s)"))

dt_CURSCHT3_4_5_summary <- CURSCHT3_4_5 %>% dplyr::group_by(Address1) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address1, n, percentage)
dt_CURSCHT3_4_5_summary <- dt_CURSCHT3_4_5_summary[1,]

dt_CURSCHT3_4_5_summary[2,1] <- "Skipped if Includes Major Road(s)" 
dt_CURSCHT3_4_5_summary[2,2] <- sum(is.na(CURSCHT3_4_5$D_107050954))
dt_CURSCHT3_4_5_summary[2,3] <- (sum(is.na(CURSCHT3_4_5$D_107050954))/dim(dt_CURSCHT3_4_5_summary)[[1]])*100

dt_CURSCHT3_4_5_summary[3,1] <- "Skipped if Includes Local Road(s)" 
dt_CURSCHT3_4_5_summary[3,2] <- sum(is.na(CURSCHT3_4_5$D_559488982))
dt_CURSCHT3_4_5_summary[3,3] <- (sum(is.na(CURSCHT3_4_5$D_559488982))/dim(dt_CURSCHT3_4_5_summary)[[1]])*100


# dt_CURSCHT3_4_5_summary %>%  gt::gt() %>%  
#   fmt_number(columns = "percentage", decimals = 2) %>% 
#   tab_header(title = md("Road Type for School Commute")) %>% 
#   cols_label(n= md("**Number of Participants**"),Address1 = md("**Question**"), percentage = md("**%**")) %>% 
#   tab_options(
#     stub.font.weight = "bold"
#   ) %>%
#   tab_style(
#     style = list(
#       cell_text(weight = "bold")
#     ),
#     locations = cells_body(
#       columns = Address1,
#     )
#   )





CURSCHT6= STU %>%  filter(STU$D_449752653==353358909) %>% 
  mutate(Address1= case_when(is.na(D_940631293) ~"Skipped CURSCHT6"))

dt_CURSCHT6_summary <- CURSCHT6 %>% dplyr::group_by(Address1) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address1, n, percentage)
dt_CURSCHT6_summary <- dt_CURSCHT6_summary[1,]

dt_CURSCHT6_summary %>%  gt::gt() %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Days per Week Commuting from School")) %>% 
  cols_label(n= md("**Number of Participants**"),Address1 = md("**Question**"), percentage = md("**%**")) %>% 
  #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
    stub.font.weight = "bold"
  ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address1,
    )
  )



CURSCHT7= STU %>%  filter(STU$D_449752653==353358909 & is.na(D_496801729)) %>%  
  mutate(Address1= case_when(is.na(D_496801729) ~"Skipped CURSCHT7"))

dt_CURSCHT7_summary <- CURSCHT7 %>% dplyr::group_by(Address1) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address1, n, percentage)
dt_CURSCHT7_summary <- dt_CURSCHT7_summary[1,]

dt_CURSCHT7_summary %>%  gt::gt() %>%
  fmt_number(columns = "percentage", decimals = 2) %>%
  tab_header(title = md("Same Transportation Type To and From School")) %>%
  cols_label(n= md("**Number of Participants**"),Address1 = md("**Question**"), percentage = md("**%**")) %>%
  #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
    stub.font.weight = "bold"
  ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address1,
    )
  )




CURSCHT8= STU %>%  filter(STU$D_449752653==353358909 & STU$D_496801729==353358909)  %>% 
  mutate(Address1= case_when(is.na(D_230528407) ~"Skipped CURSCHT8"))

dt_CURSCHT8_summary <- CURSCHT8 %>% dplyr::group_by(Address1) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address1, n, percentage)
dt_CURSCHT8_summary <- dt_CURSCHT8_summary[1,]

# dt_CURSCHT8_summary %>%  gt::gt() %>%  
#   fmt_number(columns = "percentage", decimals = 2) %>% 
#   tab_header(title = md("Commuting Timw To and From School the Same")) %>% 
#   cols_label(n= md("**Number of Participants**"),Address1 = md("**Question**"), percentage = md("**%**")) %>% 
#   #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
#   tab_options(
#     stub.font.weight = "bold"
#   ) %>%
#   tab_style(
#     style = list(
#       cell_text(weight = "bold")
#     ),
#     locations = cells_body(
#       columns = Address1,
#     )
#   )





CURSCHT9= STU %>% filter(STU$D_449752653==353358909 & STU$D_496801729!=353358909) %>% 
  mutate(Address1= case_when(is.na(D_345355061_D_345355061_D_467242967) ~"Skipped if Commute Inlcudes a Car"))

dt_CURSCHT9_summary <- CURSCHT9 %>% dplyr::group_by(Address1) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address1, n, percentage)
dt_CURSCHT9_summary <- dt_CURSCHT9_summary[1,]

dt_CURSCHT9_summary[2,1] <- "Skipped if Commute Inlcudes a Taxi" 
dt_CURSCHT9_summary[2,2] <- sum(is.na(CURSCHT9$D_345355061_D_345355061_D_645051966))
dt_CURSCHT9_summary[2,3] <- (sum(is.na(CURSCHT9$D_345355061_D_345355061_D_645051966))/dim(CURSCHT9)[[1]])*100

dt_CURSCHT9_summary[3,1] <- "Skipped if Commute Inlcudes a Motorcycle" 
dt_CURSCHT9_summary[3,2] <- sum(is.na(CURSCHT9$D_345355061_D_345355061_D_756061540))
dt_CURSCHT9_summary[3,3] <- (sum(is.na(CURSCHT9$D_345355061_D_345355061_D_756061540))/dim(CURSCHT9)[[1]])*100

dt_CURSCHT9_summary[4,1] <- "Skipped if Commute Inlcudes a Bus" 
dt_CURSCHT9_summary[4,2] <- sum(is.na(CURSCHT9$D_345355061_D_345355061_D_198883577))
dt_CURSCHT9_summary[4,3] <- (sum(is.na(CURSCHT9$D_345355061_D_345355061_D_198883577))/dim(CURSCHT9)[[1]])*100

dt_CURSCHT9_summary[5,1] <- "Skipped if Commute Inlcudes a Subway" 
dt_CURSCHT9_summary[5,2] <- sum(is.na(CURSCHT9$D_345355061_D_345355061_D_634680635))
dt_CURSCHT9_summary[5,3] <- (sum(is.na(CURSCHT9$D_345355061_D_345355061_D_634680635))/dim(CURSCHT9)[[1]])*100

dt_CURSCHT9_summary[6,1] <- "Skipped if Commute Inlcudes Biking" 
dt_CURSCHT9_summary[6,2] <- sum(is.na(CURSCHT9$D_345355061_D_345355061_D_790657437))
dt_CURSCHT9_summary[6,3] <- (sum(is.na(CURSCHT9$D_345355061_D_345355061_D_790657437))/dim(CURSCHT9)[[1]])*100

dt_CURSCHT9_summary[7,1] <- "Skipped if Commute Inlcudes Walking" 
dt_CURSCHT9_summary[7,2] <- sum(is.na(CURSCHT9$D_345355061_D_345355061_D_107428524))
dt_CURSCHT9_summary[7,3] <- (sum(is.na(CURSCHT9$D_345355061_D_345355061_D_107428524))/dim(CURSCHT9)[[1]])*100

dt_CURSCHT9_summary[8,1] <- "Skipped if Commute Inlcudes Another Method" 
dt_CURSCHT9_summary[8,2] <- sum(is.na(CURSCHT9$D_345355061_D_345355061_D_804918983) & is.na(CURSCHT9$D_345355061_D_656067463))
dt_CURSCHT9_summary[8,3] <- (sum(is.na(CURSCHT9$D_345355061_D_345355061_D_804918983) & is.na(CURSCHT9$D_345355061_D_656067463))/dim(CURSCHT9)[[1]])*100


dt_CURSCHT9_summary %>%  gt::gt() %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Commuting Methods to School")) %>% 
  cols_label(n= md("**Number of Participants**"),Address1 = md("**Question**"), percentage = md("**%**")) %>% 
  #grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
    stub.font.weight = "bold"
  ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address1,
    )
  )





# CURSCHT10A= STU %>%  select(D_219317801_D_990162153) %>% filter(STU$D_449752653==353358909 & STU$D_230528407!=353358909 &
#                                                                   ifelse(STU$D_496801729==104430631, STU$D_345355061_D_345355061_D_467242967==1,
#                                                                          ifelse(is.na(STU$D_496801729), STU$D_345355061_D_345355061_D_467242967==1,
#                                                                                 ifelse(STU$D_230528407==104430631, STU$D_404863614_D_404863614_D_782113721==1,
#                                                                                        ifelse(is.na(STU$D_230528407), STU$D_404863614_D_404863614_D_782113721==1, NA))))) 
# vis_miss(CURSCHT10A) +labs(y= "Participants", title="CURSCHT10A")
# 
# 
# 
# CURSCHT10B= STU %>%  select(D_219317801_D_576149634) %>% filter(STU$D_449752653==353358909 & STU$D_230528407!=353358909)  ##REVIEW
# #vis_miss(CURSCHT10B)+labs(y= "Participants", title="CURSCHT10B")
# 
# 
# CURSCHT10C= STU %>%  select(D_219317801_D_291458877) %>% filter(STU$D_449752653==353358909 & STU$D_230528407!=353358909)  ##REVIEW
# #vis_miss(CURSCHT10C)+labs(y= "Participants", title="CURSCHT10C")
# 
# 
# CURSCHT10D= STU %>%  select(D_219317801_D_453417964) %>% filter(STU$D_449752653==353358909 & STU$D_230528407!=353358909)  ##REVIEW
# #vis_miss(CURSCHT10D)+labs(y= "Participants", title="CURSCHT10D")
# 
# 
# CURSCHT10E= STU %>%  select(D_219317801_D_550646850) %>% filter(STU$D_449752653==353358909 & STU$D_230528407!=353358909)  ##REVIEW
# #vis_miss(CURSCHT10E)+labs(y= "Participants", title="CURSCHT10E")
# 
# 
# CURSCHT10F= STU %>%  select(D_219317801_D_949549557) %>% filter(STU$D_449752653==353358909 & STU$D_230528407!=353358909)  ##REVIEW
# #vis_miss(CURSCHT10F)+labs(y= "Participants", title="CURSCHT10F")
# 
# 
# CURSCHT10G= STU %>%  select(D_219317801_D_214274185) %>% filter(STU$D_449752653==353358909 & STU$D_230528407!=353358909)  ##REVIEW
# #vis_miss(CURSCHT10G)+labs(y= "Participants", title="CURSCHT10G")
# 
# 
# CURSCHT10H= STU %>%  select(D_219317801_D_533003859) %>% filter(STU$D_449752653==353358909 & STU$D_230528407!=353358909)  ##REVIEW
# #vis_miss(CURSCHT10H)+labs(y= "Participants", title="CURSCHT10H")
# 


CURSCHT11_12_13= STU %>%  
  filter(STU$D_449752653==353358909  & 
           ((STU$D_219317801_D_990162153!=428999623 & !is.na(STU$D_219317801_D_990162153)) |
              (STU$D_219317801_D_576149634!=428999623 & !is.na(STU$D_219317801_D_576149634)) |
              (STU$D_219317801_D_291458877!=428999623 & !is.na(STU$D_219317801_D_291458877)) |
              (STU$D_219317801_D_453417964!=428999623 & !is.na(STU$D_219317801_D_453417964)) |
              (STU$D_219317801_D_550646850!=428999623 & !is.na(STU$D_219317801_D_550646850)) |
              (STU$D_219317801_D_949549557!=428999623 & !is.na(STU$D_219317801_D_949549557)) |
              (STU$D_219317801_D_214274185!=428999623 & !is.na(STU$D_219317801_D_214274185)) |
              (STU$D_219317801_D_533003859!=428999623 & !is.na(STU$D_219317801_D_533003859)))) 

CURSCHT11_12_13= CURSCHT11_12_13 %>%   
  mutate(Address1= case_when(is.na(D_705673076) ~"Skipped if Includes Highway(s)"))

dt_CURSCHT11_12_13_summary <- CURSCHT11_12_13 %>% dplyr::group_by(Address1) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address1, n, percentage)
dt_CURSCHT11_12_13_summary <- dt_CURSCHT11_12_13_summary[1,]

dt_CURSCHT11_12_13_summary[2,1] <- "Skipped if Includes Major Road(s)" 
dt_CURSCHT11_12_13_summary[2,2] <- sum(is.na(CURSCHT11_12_13$D_333852852))
dt_CURSCHT11_12_13_summary[2,3] <- (sum(is.na(CURSCHT11_12_13$D_333852852))/dim(dt_CURSCHT11_12_13_summary)[[1]])*100

dt_CURSCHT11_12_13_summary[3,1] <- "Skipped if Includes Local Road(s)" 
dt_CURSCHT11_12_13_summary[3,2] <- sum(is.na(CURSCHT11_12_13$D_776580384))
dt_CURSCHT11_12_13_summary[3,3] <- (sum(is.na(CURSCHT11_12_13$D_776580384))/dim(dt_CURSCHT11_12_13_summary)[[1]])*100

dt_CURSCHT11_12_13_summary <- dt_CURSCHT11_12_13_summary[c(2,3),]
dt_CURSCHT11_12_13_summary %>%  gt::gt() %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Road Type for School Commute Home")) %>% 
  cols_label(n= md("**Number of Participants**"),Address1 = md("**Question**"), percentage = md("**%**")) %>% 
  tab_options(
    stub.font.weight = "bold"
  ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address1,
    )
  )




CURSCHT14= STU %>% filter(STU$D_449752653==353358909 & is.na(D_849811593)) %>%   
  mutate(Address1= case_when(is.na(D_849811593) ~"Skipped CURSCHT14"))

dt_CURSCHT14_summary <- CURSCHT14 %>% dplyr::group_by(Address1) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address1, n, percentage)
dt_CURSCHT14_summary <- dt_CURSCHT14_summary[1,]

dt_CURSCHT14_summary %>%  gt::gt() %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Days per Week Commuting Home from School")) %>% 
  cols_label(n= md("**Number of Participants**"),Address1 = md("**Question**"), percentage = md("**%**")) %>% 
  tab_options(
    stub.font.weight = "bold"
  ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address1,
    )
  )


```
