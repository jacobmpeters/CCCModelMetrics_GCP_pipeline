---
title: "Merged Module 1 Summary Statistics"
author: "Kelsey Sanchez"
date: "`r Sys.Date()`"
output: pdf_document
---


This report gives the distribution of all Module 1 responses for those that completed either version 1 or version 2 of this survey. If a participant was somehow able to complete both versions, only the version 2 data is kept.

```{r intro, include=FALSE}

# This report analysis the responses of all Module 1 questions and visualizes the distributions of answers (ex: age at diagnosis)
# All libraries are listed up top; authentication for BQ will be necessary
# Functions used included before the start of the analysis 
```




```{r libraries, include=FALSE}

#All libraries are listed up top; authentication for BQ will be necessary.
#Functions used included before the start of the analysis .



rm(list = ls())
library(bigrquery)
library(foreach)
library(stringr)
#library(plyr)
#library(expss) ###to add labels
library(epiDisplay) ##recommended applied here crosstable, tab1
library(gmodels) ##recommended
library(magrittr)
library(arsenal)
library(gtsummary)
library(rio)



library(ggplot2)
library(gridExtra)
library(scales)
library(gt)
#install(tinytex)
library(tinytex)
library(data.table) ###to write or read and data management 
library(tidyverse) ###for data management
library(dplyr) ###data management
library(reshape)  ###to work on transition from long to wide or wide to long data
library(listr) ###to work on a list of vector, files or..
library(sqldf) ##sql
library(lubridate) ###date time
library(stringr) ###to work on patterns, charaters
library(kableExtra)


options(tinytex.verbose = TRUE)

bq_auth()
```


```{r M1merge, include=FALSE}

#Data Dictionary for column names
dictionary <- rio::import("https://episphere.github.io/conceptGithubActions/aggregate.json",format = "json")
dd <- dplyr::bind_rows(dictionary,.id="CID")
dd <-rbindlist(dictionary,fill=TRUE,use.names=TRUE,idcol="CID")
dd$`Variable Label`[is.na(dd$`Variable Label`)] <- replace_na(dd$'Variable Name')
dd <- as.data.frame.matrix(do.call("rbind",dictionary)) 
dd$CID <- rownames(dd)
#https://shaivyakodan.medium.com/7-useful-r-packages-for-analysis-7f60d28dca98
devtools::install_github("tidyverse/reprex")





## BQ Pull from the participants table just to use for versioning
project <- "nih-nci-dceg-connect-prod-6d04"
billing <- "nih-nci-dceg-connect-prod-6d04" 
recr_M1 <- bq_project_query(project, query="SELECT token,Connect_ID, d_821247024, d_914594314,  d_827220437,d_512820379,
                            d_949302066 , d_517311251  FROM  `nih-nci-dceg-connect-prod-6d04.FlatConnect.participants_JP` WHERE  d_821247024='197316935' and d_949302066 ='231311385'")
recr_m1 <- bq_table_download(recr_M1,bigint = "integer64")
cnames <- names(recr_m1)
# Check that it doesn't match any non-number
numbers_only <- function(x) !grepl("\\D", x)
# to check variables in recr_noinact_wl1
for (i in 1: length(cnames)){
  varname <- cnames[i]
  var<-pull(recr_m1,varname)
  recr_m1[,cnames[i]] <- ifelse(numbers_only(var), as.numeric(as.character(var)), var)
}




#### Handling participants that somehow completed both Mod1 version 1 and Mod1 version 2

sql_M1_1 <- bq_project_query(project, query = "SELECT * FROM `nih-nci-dceg-connect-prod-6d04.FlatConnect.module1_v1_JP` WHERE Connect_ID IS NOT NULL")
sql_M1_2 <- bq_project_query(project, query = "SELECT * FROM `nih-nci-dceg-connect-prod-6d04.FlatConnect.module1_v2_JP` WHERE Connect_ID IS NOT NULL")

M1_V1 <- bq_table_download(sql_M1_1, bigint = "integer64")
M1_V2 <- bq_table_download(sql_M1_2, bigint = "integer64")

# Select matching column names
M1_V1_vars <- colnames(M1_V1)
M1_V2_vars <- colnames(M1_V2)
common_vars <- intersect(M1_V1_vars, M1_V2_vars)

# Subset to common columns
M1_V1_common <- M1_V1[, common_vars]
M1_V2_common <- M1_V2[, common_vars]

# Add version indicator
M1_V1_common$version <- 1
M1_V2_common$version <- 2

# Identify columns with mismatched types
mismatched_cols <- names(M1_V1_common)[sapply(names(M1_V1_common), function(col) {
  class(M1_V1_common[[col]]) != class(M1_V2_common[[col]])
})]

# Convert mismatched columns to character for consistency
M1_V1_common <- M1_V1_common %>%
  mutate(across(all_of(mismatched_cols), as.character))
M1_V2_common <- M1_V2_common %>%
  mutate(across(all_of(mismatched_cols), as.character))

# Combine both versions for participants who completed both
M1_common <- bind_rows(M1_V1_common, M1_V2_common) %>%
  arrange(Connect_ID, desc(version))

# For columns unique to each version
V1_only_vars <- setdiff(M1_V1_vars, common_vars)
V2_only_vars <- setdiff(M1_V2_vars, common_vars)

# Subset each version for unique columns and add version indicator
m1_v1_only <- M1_V1[, c("Connect_ID", V1_only_vars)] %>%
  mutate(version = 1)
m1_v2_only <- M1_V2[, c("Connect_ID", V2_only_vars)] %>%
  mutate(version = 2)

# Combine the unique and common data
m1_common_v1 <- left_join(M1_common, m1_v1_only, by = c("Connect_ID", "version"))
m1_combined_v1v2 <- left_join(m1_common_v1, m1_v2_only, by = c("Connect_ID", "version"))

# Filter for complete cases where specific completion criteria are met
m1_complete <- m1_combined_v1v2 %>%
  filter(Connect_ID %in% recr_m1$Connect_ID[recr_m1$d_949302066 == 231311385]) %>%
  arrange(desc(version))

# Remove duplicates, keeping only the most recent version for each Connect_ID
m1_complete_nodup <- m1_complete[!duplicated(m1_complete$Connect_ID),]

m1_complete_nodup$Connect_ID <- as.numeric(m1_complete_nodup$Connect_ID)


### Define requirements of the data: active or passive,  user profile done, consented, mod1 done, verified
parts <- "SELECT Connect_ID, token
FROM `nih-nci-dceg-connect-prod-6d04.FlatConnect.participants_JP` 
where Connect_ID IS NOT NULL and (d_512820379='486306141' OR d_512820379='854703046') and d_821247024='197316935' and
(d_919254129='353358909') and (d_699625233='353358909') and (d_949302066='231311385')"
parts_table <- bq_project_query(project, parts)
parts_data <- bq_table_download(parts_table, bigint = "integer64")

parts_data$Connect_ID <- as.numeric(parts_data$Connect_ID) ###need to convert type- m1... is double and parts is character

module1= left_join(parts_data, m1_complete_nodup, by="Connect_ID") 
dim(module1)
```


```{r counts, warning=FALSE, echo=FALSE}

cat("Participants with Module 1 Completion:", dim(module1)[[1]])


data_tib_m1 <- as_tibble(module1)
#dim(module1)

knitr::opts_chunk$set(comment = NA)



```


```{r functions, warning=FALSE, include=FALSE}
#Created Functions for this code

#Histogram 
hist_funct <- function(CID,Title, Xlab, Ylab) {
  CID_SYM <- rlang::ensym(CID)
  module1 %>% mutate(!!CID_SYM:=as.numeric(!!CID_SYM)) %>%
    filter(!is.na(!!CID_SYM)) %>%
    ggplot(aes(x=!!CID_SYM))+
     xlab(Xlab) + ylab(Ylab) + geom_histogram()+  ggtitle(Title)+
    geom_histogram(color="black")+ scale_y_continuous(breaks=pretty_breaks()) +
    geom_vline(aes(xintercept=mean(!!CID_SYM, na.rm=T)), colour="#2973A5", linetype="solid")
  
}



#Boxplot
boxp_funct <- function(CID,Title, Xlab) {
  CID_SYM <- rlang::ensym(CID)
  module1 %>% mutate(!!CID_SYM:=as.numeric(!!CID_SYM)) %>%
    filter(!is.na(!!CID_SYM)) %>%
    ggplot(aes(x=!!CID_SYM))+
    xlab(Xlab) + geom_boxplot()+  ggtitle(Title)+
    theme(axis.text.y=element_blank(),  #remove y axis labels
        axis.ticks.y=element_blank()  #remove y axis ticks
        )
}



##GT TABLE: Questions that all participants asked, update dictionary as new answer options come up

dict <- list("104430631"="No", "353358909"="Yes", "589959753"="A little shorter", "623310018"="A lot shorter", "978204320"= "Grade School(Grades 1-8)", "935502060"="Some High School, No Diploma", "404564707"= "High School Graduate or GED", "432193665"="Some College, No Degree", "890756124"="Technical or Trade School After High School", "766964355"="Associate's Degree", "875342283"="Bachelor's Degree", "598242454"="Advanced Degree", "709650750"="Biological Child", "810290359"="Adopted Child", "509607548"="Step Child", "784922042"="Related to me in some other way", "288105839"=" Yes, fraternal twins", "626558982"="Yes, triplets or higher multiple birth", "178420302"="Do not Know", "536341288"="Female", "576796184"="Intersex or Other", "654207589"="Male","555374628"="Full Sibling", "871673221"="Half Sibling, Same Mother",  "198654048"="Half Sibling, Same Father", "807835037"="Other", "274062548"="More than 3 months ago", "958538953"="In the past 3 months", "317567178"="In the past month", "484055234"="In the past year",  "802197176"="More than 1 year ago", "[]"="Answered with number", "[178420302]"="Answered Don't Know", "274062548"="More than 3 months ago","958538953"="In the past 3 months",  "490796638"="Not Flexible","719954633"="Extremely Flexible","929148006"="A Little Flexible","988873962"="Somewhat Flexible", "764708931"="Very flexible","0"="No", "1"="Yes", "536341288"="Female", "218837028"="Woman", "983318667"="Man"  , "654207589"="Male","746038746"="Prefer Not to Answer", "805712793"="Genderqueer","486192236"="Non-Binary", "807835037"="Other","873138103"="Transgender Woman","405267600"="Transgender Man", "220083334"="Very Feminine","541300533"="Mostly Feminine","878286618"="Somewhat Feminine","910745276"="Equally feminine and masculine","915528806"="Very masculine","265452386"="Mostly Masculine","510148951"="Somewhat Masculine","271882746"="Straight or heterosexual", "903084185"="Lesbian, gay, or homosexual", "999994434"="Bisexual", "197935377" ="Queer", "210894509"	= "No labels", "727200870" = "Asexual", "832978839"	 = "Mostly Straight", "854349138" = "Pansexual", "584368278"="Retired", "475665841"="Homemaker", "656816477"="Unemployed", "756948639"="Unble to Work (Disabled)", "181769837"="Other Employment Status","551525967"="Yes, Full-Time Student", "738284740"="Yes, Part Time Student", "288321056"="Married", "514080822"="Never Married","522680498"="Never Married but living with Partner","649436542"="Divorced","522680498"="Partner", "741094625"="Separated","733527132"="Widow", "131550264" = "Fair","138752522" = "Poor", "565881164" = "Very Good","670680466" = "Excellent","719933364" = "Good",  "988858078" = "1","156095877" = "2","162668459" = "3","278139969" = "4", "676824724" = "5", "512144428" = "6", "125674414" = "7", "406650257" = "8", "700080862" = "9", "616621065" = "10", "111520945" = "Not At All","548628123" = "A Little Bit", "597477164" = "A Lot", "927925620" = "(0)No hair loss", "552278254"= "(1) Mild Loss on Sides", "267104669"= "(2) Mild Loss on Top", "619337179"= "(3) Mild to Moderate","601381820"= "(4) Moderate Loss on Top", "151394571"= "(5) Severe Loss on Top", "917379905"= "(6) Severe Loss and Thinning","746328729"= "(7) Severe Loss Top and Forehead", "452963767"= "(8) All over Loss", "629452816" = "(1) Mild Loss on Sides","915557297" = "(2) Moderate Loss on Side","103565678" = "(3) Mild Loss and Thinning","381878591" = "(4) Moderate w/Crown Balding","446794016" = "(5) Thin Hair Strip Left Only","526238862" = "(6) Moderate to Severe","173625583" = "(7) Thin Hair Strip Around the Head","782282163" = "(8) Mild Loss at Forehead","693010445" = "(9) Moderate Loss at Forehead","732008197" = "(10) Severe Loss at Forehead","734998477" = "(11) Mild Loss at Forehead, Beyond Ears", "209571450" = "35,000-49,000","212249150" = "50,000-74,000","374508062" = "0-9,000","530094502" = "Error- Unlisted Response Selected", "742032816" = "200,000+", "745561936" = "25,000-34,000","746038746" = "Prefer not to Answer","777814771" = "75,000-99,000","913602274" = "150,000-199,000", "922395188" = "100,000-149,000",
"976555124" = "10,000-24,000", "275706407"="Someone on behalf of Participant", "589702540"="Completed by Participant", "176904165"="Thinner than Average","902131456"="About Average Build", "839266527"="Heavier than Average", "325478778"="Shorter than average","730757606"="About avg", "897599966"="Taller than average", "146477090"="Type 1", "573635975"="Type 2")



simple_funct <- function(CID, Title){  
  CID_SYM <- rlang::ensym(CID)
  dt_select <- data_tib_m1 %>%  select(Connect_ID, !!CID_SYM)
  gt_yn <- dt_select  %>% dplyr::group_by(!!CID_SYM) %>% dplyr::summarize(n=n(), percentage=100*n/nrow(.)) %>% dplyr::ungroup() %>% dplyr::mutate(answer=recode(!!CID_SYM, !!!dict)) %>% replace_na(list(answer="Skipped this Question")) %>%  dplyr::select(answer, n, percentage)
  
  gt_yn %>%  gt::gt(rowname_col = "row_lab")  %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md(Title)) %>% 
  cols_label(n= md("**N**"), answer = md("**Answer**"), percentage = md("**%**")) %>%  
  # summary_rows( groups=F,
  #   columns = c(n,percentage),    
  #   fns= list(
  #     Sum= ~sum(.)
  #   ), decimals=0) %>%
    grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = answer,
    )
  ) 
}


#GT table with one filter/skip logic
one_logic_funct <- function(CID, CID_prev, Prev_Answer, Title){  
  CID_SYM <- rlang::ensym(CID)
  CID_SYM_P <- rlang::ensym(CID_prev)
  dt_select <- data_tib_m1 %>%  filter(!!CID_SYM_P == Prev_Answer) %>%  select(Connect_ID, !!CID_SYM) 
  gt_yn <- dt_select  %>% dplyr::group_by(!!CID_SYM) %>% dplyr::summarize(n=n(), percentage=100*n/nrow(.)) %>% dplyr::ungroup() %>% dplyr::mutate(answer=recode(!!CID_SYM, !!!dict)) %>% replace_na(list(answer="Skipped this Question")) %>%  dplyr::select(answer, n, percentage)
  
  gt_yn %>%  gt::gt(rowname_col = "row_lab")  %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md(Title)) %>% 
  cols_label(n= md("**N**"),  answer = md("**Answer**"), percentage = md("**%**")) %>% 
  # summary_rows( groups=F,
  #   column = c(n,percentage),
  #   fns= list(
  #     Sum= ~sum(.)
  #   ), decimals=0) %>%
    grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = answer,
    )
  ) 
}

#GT table for siblings
sib_logic_funct <- function(CID, Sib_Num, Title){  
  CID_SYM <- rlang::ensym(CID)
  data_tib_m1$D_694265648 <- as.numeric(data_tib_m1$D_694265648)
  dt_select <- data_tib_m1 %>%  filter(D_694265648 >= Sib_Num) %>%  select(Connect_ID, !!CID_SYM) 
  gt_yn <- dt_select  %>% dplyr::group_by(!!CID_SYM) %>% dplyr::summarize(n=n(), percentage=100*n/nrow(.)) %>% dplyr::ungroup() %>% dplyr::mutate(answer=recode(!!CID_SYM, !!!dict)) %>% replace_na(list(answer="Skipped this Question")) %>%  dplyr::select(answer, n, percentage)
  
  gt_yn %>%  gt::gt(rowname_col = "row_lab")  %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md(Title)) %>% 
  cols_label(n= md("**N**"),  answer = md("**Answer**"), percentage = md("**%**")) %>% 
  # summary_rows( groups=F,
  #   column = c(n,percentage),
  #   fns= list(
  #     Sum= ~sum(.)
  #   ), decimals=0) %>%
    grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = answer,
    )
  ) 
}

#GT table for children
child_logic_funct <- function(CID, Child_Num, Title){  
  CID_SYM <- rlang::ensym(CID)
  data_tib_m1$D_446999144 <- as.numeric(data_tib_m1$D_446999144)
  dt_select <- data_tib_m1 %>%  filter(D_446999144 >= Child_Num) %>%  select(Connect_ID, !!CID_SYM) 
  gt_yn <- dt_select  %>% dplyr::group_by(!!CID_SYM) %>% dplyr::summarize(n=n(), percentage=100*n/nrow(.)) %>% dplyr::ungroup() %>% dplyr::mutate(answer=recode(!!CID_SYM, !!!dict)) %>% replace_na(list(answer="Skipped this Question")) %>%  dplyr::select(answer, n, percentage)
  
  gt_yn %>%  gt::gt(rowname_col = "row_lab")  %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md(Title)) %>% 
  cols_label(n= md("**N**"),  answer = md("**Answer**"), percentage = md("**%**")) %>% 
    grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = answer,
    )
  ) 
}

#GT TABLE: Weight loss method



```

\newpage
# Section 1: Background Information 
## Age 
```{r Age, warning=FALSE, echo=FALSE, message=FALSE}

##Age Verification
simple_funct(D_479353866,"AGECOR: Age Reported Correct")


```

```{r Age_num, warning=FALSE, echo=FALSE, message=FALSE, include=FALSE}

#Inputting 'correct' age has been removed from Module 1


# Had to separate this. For whatever reason the printed cat function was ending with a ">"
#dim(difference_age)[[1]]

#cat("Entered an Age Different Than What was Calculated:", dim(difference_age)[[1]])



#How old today
#hist_funct(D_150344905, "Age if Age Verification Not Correct", "Age", "Frequency")
#cat("Number of Participants with Incorrect Ages:", sum(!is.na(module1$D_150344905)))

```

## Marital Status 
```{r marital, warning=FALSE, echo=FALSE, message=FALSE}
##Marital Status 
simple_funct(D_783167257, "MARITAL: Marital Status")


```

## Race, and Ethnicity
```{r race, warning=FALSE, echo=FALSE, message=FALSE}
all_races <- data_tib_m1[ , c("Connect_ID", "D_384191091_D_384191091_D_583826374", "D_384191091_D_384191091_D_636411467", "D_384191091_D_384191091_D_458435048",
                                 "D_384191091_D_384191091_D_706998638", "D_384191091_D_384191091_D_973565052", "D_384191091_D_384191091_D_586825330",
                                 "D_384191091_D_384191091_D_412790539", "D_384191091_D_384191091_D_807835037", "D_384191091_D_747350323", "D_384191091_D_384191091_D_746038746")] 







## Multi-racial

multi_race=0    
for (i in 1:length(module1$Connect_ID)){
  AI=ifelse((module1$D_384191091_D_384191091_D_583826374[[i]]==1 & (module1$D_384191091_D_384191091_D_636411467[[i]]==1 | module1$D_384191091_D_384191091_D_458435048[[i]]==1|
                                               module1$D_384191091_D_384191091_D_706998638[[i]]==1 | module1$D_384191091_D_384191091_D_973565052[[i]]==1 |
                                               module1$D_384191091_D_384191091_D_586825330[[i]]==1 | module1$D_384191091_D_384191091_D_412790539[[i]]==1 |
                                               module1$D_384191091_D_384191091_D_807835037[[i]]==1)), 1, 0)
  As=ifelse((module1$D_384191091_D_384191091_D_636411467[[i]]==1 & (module1$D_384191091_D_384191091_D_583826374[[i]]==1 | module1$D_384191091_D_384191091_D_458435048[[i]]==1|
                                                        module1$D_384191091_D_384191091_D_706998638[[i]]==1 | module1$D_384191091_D_384191091_D_973565052[[i]]==1 |
                                                        module1$D_384191091_D_384191091_D_586825330[[i]]==1 | module1$D_384191091_D_384191091_D_412790539[[i]]==1 |
                                                        module1$D_384191091_D_384191091_D_807835037[[i]]==1)), 1, 0)
  Bl=ifelse((module1$D_384191091_D_384191091_D_458435048[[i]]==1 & (module1$D_384191091_D_384191091_D_583826374[[i]]==1 | module1$D_384191091_D_384191091_D_636411467[[i]]==1|
                                                        module1$D_384191091_D_384191091_D_706998638[[i]]==1 | module1$D_384191091_D_384191091_D_973565052[[i]]==1 |
                                                        module1$D_384191091_D_384191091_D_586825330[[i]]==1 | module1$D_384191091_D_384191091_D_412790539[[i]]==1 |
                                                        module1$D_384191091_D_384191091_D_807835037[[i]]==1)), 1, 0)
  Hs=ifelse((module1$D_384191091_D_384191091_D_706998638[[i]]==1 & (module1$D_384191091_D_384191091_D_583826374[[i]]==1 | module1$D_384191091_D_384191091_D_636411467[[i]]==1|
                                                        module1$D_384191091_D_384191091_D_458435048[[i]]==1 | module1$D_384191091_D_384191091_D_973565052[[i]]==1 |
                                                        module1$D_384191091_D_384191091_D_586825330[[i]]==1 | module1$D_384191091_D_384191091_D_412790539[[i]]==1 |
                                                        module1$D_384191091_D_384191091_D_807835037[[i]]==1)), 1, 0)
  Me=ifelse((module1$D_384191091_D_384191091_D_973565052[[i]]==1 & (module1$D_384191091_D_384191091_D_583826374[[i]]==1 | module1$D_384191091_D_384191091_D_636411467[[i]]==1|
                                                        module1$D_384191091_D_384191091_D_458435048[[i]]==1 | module1$D_384191091_D_384191091_D_706998638[[i]]==1 |
                                                        module1$D_384191091_D_384191091_D_586825330[[i]]==1 | module1$D_384191091_D_384191091_D_412790539[[i]]==1 |
                                                        module1$D_384191091_D_384191091_D_807835037[[i]]==1)), 1, 0)
  Hw=ifelse((module1$D_384191091_D_384191091_D_586825330[[i]]==1 & (module1$D_384191091_D_384191091_D_583826374[[i]]==1 | module1$D_384191091_D_384191091_D_636411467[[i]]==1|
                                                        module1$D_384191091_D_384191091_D_458435048[[i]]==1 | module1$D_384191091_D_384191091_D_706998638[[i]]==1 |
                                                        module1$D_384191091_D_384191091_D_973565052[[i]]==1 | module1$D_384191091_D_384191091_D_412790539[[i]]==1 |
                                                        module1$D_384191091_D_384191091_D_807835037[[i]]==1)), 1, 0)
  Wh=ifelse((module1$D_384191091_D_384191091_D_412790539[[i]]==1 & (module1$D_384191091_D_384191091_D_583826374[[i]]==1 | module1$D_384191091_D_384191091_D_636411467[[i]]==1|
                                                        module1$D_384191091_D_384191091_D_458435048[[i]]==1 | module1$D_384191091_D_384191091_D_706998638[[i]]==1 |
                                                        module1$D_384191091_D_384191091_D_586825330[[i]]==1 | module1$D_384191091_D_384191091_D_973565052[[i]]==1 |
                                                        module1$D_384191091_D_384191091_D_807835037[[i]]==1)), 1, 0)
  Ot=ifelse((module1$D_384191091_D_384191091_D_807835037[[i]]==1 & (module1$D_384191091_D_384191091_D_583826374[[i]]==1 | module1$D_384191091_D_384191091_D_636411467[[i]]==1|
                                                        module1$D_384191091_D_384191091_D_458435048[[i]]==1 | module1$D_384191091_D_384191091_D_706998638[[i]]==1 |
                                                        module1$D_384191091_D_384191091_D_586825330[[i]]==1 | module1$D_384191091_D_384191091_D_973565052[[i]]==1 |
                                                        module1$D_384191091_D_384191091_D_412790539[[i]]==1)), 1, 0)
  multi_race= multi_race + sum(AI+As+Bl+Hs+Me+Hw+Wh+Ot, na.rm=T)

}

  

data_tib_m1$multi_racial <- c(rep(1, times=multi_race), rep(0, times=(dim(data_tib_m1)[1]- multi_race)))



## RACE

which_race= data_tib_m1 %>%  mutate(race= case_when(multi_racial==1 ~ "Multi-Racial",
                                                     D_384191091_D_384191091_D_583826374==1 ~ "American Indian or Native American",
                                                     D_384191091_D_384191091_D_636411467==1 ~ "Asian/Asian American",
                                                     D_384191091_D_384191091_D_458435048==1 ~ "Black, African American, or African",
                                                     D_384191091_D_384191091_D_706998638==1 ~ "Hispanic, Latino, or Spanish",
                                                     D_384191091_D_384191091_D_973565052==1 ~ "Middle Eastern or North African",
                                                     D_384191091_D_384191091_D_586825330==1 ~ "Hawaiian or Pacific Islander",
                                                     D_384191091_D_384191091_D_412790539==1 ~ "White",
                                                     (D_384191091_D_384191091_D_807835037==1 | !is.na(D_384191091_D_747350323)) ~ "Other",
                                                     D_384191091_D_384191091_D_746038746==1 ~ "Prefer Not to Answer",
                                                     TRUE  ~ "Skipped this question "))

dt_all_races_summary <- which_race  %>% dplyr::group_by(race) %>% dplyr::summarize(n=n(), percentage=100*n/nrow(.)) %>% dplyr::ungroup()  %>%  dplyr::select(race, n, percentage)

dt_all_races_summary %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Race/Ethnicity of Participants Who Completed BOH Section of First Survey")) %>% 
  cols_label(n= md("**N**"), race = md("**Answer**"), percentage = md("**%**")) %>% 
  # summary_rows( groups=F,
  #   column = c(n,percentage),
  #   fns= list(
  #     Sum= ~sum(.)
  #   ), decimals=0) %>%
  grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = race,
    )
  ) #
```

```{r RacePieChart, include=FALSE}

library(RColorBrewer)
library(ggrepel)
display.brewer.all(colorblindFriendly = TRUE) 
mycolors <- c("#FDBE19" ,"#9A9DA3","#CC7D15","#797D83","#DAB384","#8BAAC7","#3C989E","#F8D991","#164C71","#2973A5","#309EBD")
names(mycolors) <- levels(dt_all_races_summary$race)
##this is the best plot I can make

dt_all_races_summary$pct <- paste0(round(as.numeric((dt_all_races_summary$percentage)), digits=2), "%") 

  race_M1plot <- dt_all_races_summary %>%
  mutate(csum = rev(cumsum(rev(n))), 
         pos = n/2 + lead(csum, 1),
         pos = if_else(is.na(pos), n/2, pos),
         percentage = n/sum(n)) %>% 
  ggplot(aes(x = "", y = n, fill = fct_inorder(race))) + 
  scale_fill_manual(values = mycolors,name = "Race Ethnicity") +
  scale_colour_manual(values= mycolors) +
  labs(x = "", y = "", title = "Race/Ethnicity of Participants Who Completed BOH Section of First Survey",
       fill = "race_ethnic") +   
  geom_col(width = 3.5, color = 1) +
  geom_label_repel(aes(y = pos,
                       label = pct, 
                       fill = race),
                   size = 3,color="white",
                   nudge_x = 3,
                   show.legend = FALSE) +
  labs(  fill = "Subtype" ) +
  coord_polar(theta = "y") +   theme_void() 
  
  race_M1plot   #if pie chart is needed again

```


```{r AllRacePlot, echo=FALSE, warning=FALSE}

# ALL RACES PIE CHART 
race_M1plot
```


```{r Ethnicity, warning=FALSE, echo=FALSE, message=FALSE}


#American Indian/Native American
dt_am_ind_ethn= data_tib_m1 %>%  filter(data_tib_m1$D_384191091_D_384191091_D_583826374==1)  


dt_am_ind_ethn= dt_am_ind_ethn %>%  mutate(multb2 = ifelse(D_362270886_D_362270886_D_249603425==1, 1, 0) + ifelse(D_362270886_D_362270886_D_530063091==1, 1, 0) + ifelse(D_362270886_D_362270886_D_643489668==1, 1, 0) + 
                                             ifelse(D_362270886_D_362270886_D_807835037==1, 1, 0) + ifelse(D_362270886_D_362270886_D_746038746==1, 1, 0))


amer_eth= dt_am_ind_ethn %>%  mutate(ethnicity= case_when(as.numeric(multb2)>1 ~ "Multi-Ethnic",
                                                          D_362270886_D_362270886_D_249603425==1 ~ "American Indian",
                                             D_362270886_D_362270886_D_530063091==1 ~ "Alaska Native",
                                             D_362270886_D_362270886_D_643489668==1 ~ "Central or South American Indian",
                                             (D_362270886_D_362270886_D_807835037==1 | !is.na(D_362270886_D_650100414)) ~ "Other",
                                             D_362270886_D_362270886_D_746038746==1 ~ "Prefer Not to Answer",
                                             TRUE ~ "Skipped this Question"))

dt_am_ind_ethn_summary <- amer_eth %>% group_by(ethnicity) %>%    dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(ethnicity, n, percentage) 
gtm3_print <- gt::gt(dt_am_ind_ethn_summary)


dt_am_ind_ethn_summary %>%  gt::gt(rowname_col = "row_lab") %>%
  fmt_number(columns = "percentage", decimals = 2) %>%
  tab_header(title = md("Ethnicity of American Indian/Native American Participants")) %>%
  cols_label(n= md("**N**"), ethnicity = md("**Answer**"), percentage = md("**%**")) %>%
  # summary_rows( groups=F,
  #   column = c(n,percentage),
  #   fns= list(
  #     Sum= ~sum(.)
  #   ), decimals=0) %>%
    grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = ethnicity,
    )
  )  %>%
  tab_footnote(
    footnote = md("The denomination of this table is all participants who selected this race/etnicity only, as well as multi-racial participants that selected this race/ethnicity as well as other race/ethnicities."),
  locations = cells_column_labels(columns = n),
  placement = c("left")
) %>%
  tab_footnote(
    footnote = md("Multi-ethnic in this table is defined as participants that selected multiple ethnicity responses."),
  locations = cells_column_labels(columns = ethnicity),
  placement = c("left")
)


#Asian/Asian American
dt_asian= data_tib_m1 %>% filter(data_tib_m1$D_384191091_D_384191091_D_636411467==1)  

dt_asian= dt_asian %>%  mutate(multb2 = ifelse(D_525535977_D_525535977_D_773844957==1, 1, 0) + ifelse(D_525535977_D_525535977_D_901439277==1, 1, 0) + ifelse(D_525535977_D_525535977_D_750168061==1, 1, 0) + 
                                             ifelse(D_525535977_D_525535977_D_326604981==1, 1, 0) + ifelse(D_525535977_D_525535977_D_469918550==1, 1, 0) + ifelse(D_525535977_D_525535977_D_288079668==1, 1, 0) + ifelse(D_525535977_D_525535977_D_240721579==1, 1, 0) + ifelse(D_525535977_D_525535977_D_571633051==1, 1, 0) + ifelse(D_525535977_D_525535977_D_964924704==1, 1, 0) + ifelse(D_525535977_D_525535977_D_807835037==1, 1, 0) + ifelse(D_525535977_D_525535977_D_746038746==1, 1, 0))


                                                          
which_eth= dt_asian %>%  mutate(ethnicity= case_when(as.numeric(multb2)>1 ~ "Multi-Ethnic",
                                                     D_525535977_D_525535977_D_773844957==1 ~ "Asian indian",
                                             D_525535977_D_525535977_D_901439277==1 ~ "Cambodian",
                                             D_525535977_D_525535977_D_750168061==1 ~ "Chinese",
                                             D_525535977_D_525535977_D_326604981==1 ~ "Filipino",
                                             D_525535977_D_525535977_D_469918550==1 ~ "Hmong",
                                             D_525535977_D_525535977_D_288079668==1 ~ "Japanese",
                                             D_525535977_D_525535977_D_240721579==1 ~ "Korean",
                                             D_525535977_D_525535977_D_571633051==1 ~ "Pakastani",
                                             D_525535977_D_525535977_D_964924704==1 ~ "Vietnamese",
                                             (D_525535977_D_525535977_D_807835037==1 | !is.na(D_525535977_D_396618548)) ~ "Other",
                                             D_525535977_D_525535977_D_746038746==1 ~ "Prefer Not to Answer",
                                             TRUE ~ "Skipped this Question"))

dt_asian_summary <- which_eth %>% group_by(ethnicity) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(ethnicity, n, percentage) 

dt_asian_summary %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Ethnicity of Asian and Asian American Participants")) %>% 
  cols_label(n= md("**N**"), ethnicity = md("**Answer**"), percentage = md("**%**")) %>% 
  # summary_rows( groups=F,
  #   column = c(n,percentage),
  #   fns= list(
  #     Sum= ~sum(.)
  #   ), decimals=0) %>%
    grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = ethnicity,
    )
  )  %>%
  tab_footnote(
    footnote = md("The denomination of this table is all participants who selected this race/etnicity only, as well as multi-racial participants that selected this race/ethnicity as well as other race/ethnicities."),
  locations = cells_column_labels(columns = n),
  placement = c("left")
) %>%
  tab_footnote(
    footnote = md("Multi-ethnic in this table is defined as participants that selected multiple ethnicity responses."),
  locations = cells_column_labels(columns = ethnicity),
  placement = c("left")
)


#Black/African/African American 
dt_black= data_tib_m1 %>% filter(data_tib_m1$D_384191091_D_384191091_D_458435048==1)  

dt_black= dt_black %>%  mutate(multb2 = ifelse(D_976808005_D_976808005_D_704774349==1, 1, 0) + ifelse(D_976808005_D_976808005_D_240854115==1, 1, 0) + ifelse(D_976808005_D_976808005_D_280957170==1, 1, 0) + 
                                             ifelse(D_976808005_D_976808005_D_533776046==1, 1, 0) + ifelse(D_976808005_D_976808005_D_647105074==1, 1, 0) + ifelse(D_976808005_D_976808005_D_618222258==1, 1, 0) + ifelse(D_976808005_D_976808005_D_487027241==1, 1, 0) + ifelse(D_976808005_D_976808005_D_900838463==1, 1, 0) + ifelse(D_976808005_D_976808005_D_379093069==1, 1, 0) + ifelse(D_976808005_D_976808005_D_304643362==1, 1, 0) + ifelse(D_976808005_D_976808005_D_151821009==1, 1, 0) + ifelse(D_976808005_D_976808005_D_807835037==1, 1, 0) + ifelse(D_976808005_D_976808005_D_746038746==1, 1, 0))



which_eth= dt_black %>%  mutate(ethnicity= case_when(as.numeric(multb2)>1 ~ "Multi-Ethnic",
                                                     D_976808005_D_976808005_D_704774349==1 ~ "African American",
                                             D_976808005_D_976808005_D_240854115==1 ~ "Barbadian",
                                             D_976808005_D_976808005_D_280957170==1 ~ "Caribbean",
                                             D_976808005_D_976808005_D_533776046==1 ~ "Ethiopian",
                                             D_976808005_D_976808005_D_647105074==1 ~ "Ghanauin",
                                             D_976808005_D_976808005_D_618222258==1 ~ "Haitian",
                                             D_976808005_D_976808005_D_487027241==1 ~ "Jamaican",
                                             D_976808005_D_976808005_D_900838463==1 ~ "Liberian",
                                             D_976808005_D_976808005_D_379093069==1 ~ "Nigerian",
                                             D_976808005_D_976808005_D_304643362==1 ~ "Somali",
                                             D_976808005_D_976808005_D_151821009==1 ~ "South African",
                                             (D_976808005_D_976808005_D_807835037==1 | !is.na(D_976808005_D_852296096)) ~ "Other",
                                             D_976808005_D_976808005_D_746038746==1 ~ "Prefer Not to Answer",
                                             TRUE   ~ "Skipped this Question"))



dt_black_summary <- which_eth %>% group_by(ethnicity) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(ethnicity, n, percentage)

dt_black_summary %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Ethnicity of Black/African/African American Participants")) %>% 
  cols_label(n= md("**N**"), ethnicity = md("**Answer**"), percentage = md("**%**")) %>% 
  # summary_rows( groups=F,
  #   column = c(n,percentage),
  #   fns= list(
  #     Sum= ~sum(.)
  #   ), decimals=0) %>%
    grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = ethnicity,
    )
  )  %>%
  tab_footnote(
    footnote = md("The denomination of this table is all participants who selected this race/etnicity only, as well as multi-racial participants that selected this race/ethnicity as well as other race/ethnicities."),
  locations = cells_column_labels(columns = n),
  placement = c("left")
) %>%
  tab_footnote(
    footnote = md("Multi-ethnic in this table is defined as participants that selected multiple ethnicity responses."),
  locations = cells_column_labels(columns = ethnicity),
  placement = c("left")
)


#Hispanic/Latino/Spanish
dt_hisp= data_tib_m1  %>% filter(data_tib_m1$D_384191091_D_384191091_D_706998638==1) 

dt_hisp= dt_hisp %>%  mutate(multb2 = ifelse(D_308014437_D_308014437_D_810637250==1, 1, 0) + ifelse(D_308014437_D_308014437_D_248444252==1, 1, 0) + ifelse(D_308014437_D_308014437_D_764331628==1, 1, 0) + 
                                             ifelse(D_308014437_D_308014437_D_412757551==1, 1, 0) + ifelse(D_308014437_D_308014437_D_981774939==1, 1, 0) + ifelse(D_308014437_D_308014437_D_432305109==1, 1, 0) + ifelse(D_308014437_D_308014437_D_862718552==1, 1, 0) + ifelse(D_308014437_D_308014437_D_988121468==1, 1, 0) + ifelse(D_308014437_D_308014437_D_773342525==1, 1, 0) + ifelse(D_308014437_D_308014437_D_807835037==1, 1, 0) + ifelse(D_308014437_D_308014437_D_746038746==1, 1, 0))



which_eth= dt_hisp %>%  mutate(ethnicity= case_when(as.numeric(multb2)>1 ~ "Multi-Ethnic",
                                                    D_308014437_D_308014437_D_810637250==1 ~ "Columbian",
                                             D_308014437_D_308014437_D_248444252==1 ~ "Cuban",
                                             D_308014437_D_308014437_D_764331628==1 ~ "Dominican",
                                             D_308014437_D_308014437_D_412757551==1 ~ "Ecuadorian",
                                             D_308014437_D_308014437_D_981774939==1 ~ "Hondurian",
                                             D_308014437_D_308014437_D_432305109==1 ~ "Mexican or Mexican American",
                                             D_308014437_D_308014437_D_862718552==1 ~ "Puerto Rican",
                                             D_308014437_D_308014437_D_988121468==1 ~ "Salvadorian",
                                             D_308014437_D_308014437_D_773342525==1 ~ "Spanish",
                                             (D_308014437_D_308014437_D_807835037==1 | !is.na(D_308014437_D_440307926)) ~ "Other",
                                             D_308014437_D_308014437_D_746038746==1 ~ "Prefer Not to Answer",
                                             TRUE   ~ "Skipped this Question"))

dt_hisp_summary <- which_eth %>% group_by(ethnicity) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(ethnicity, n, percentage)

dt_ethnic4 <- dt_hisp_summary %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Ethnicity of Hispanic/Latino/Spanish Participants")) %>% 
  cols_label(n= md("**N**"), ethnicity = md("**Answer**"), percentage = md("**%**")) %>% 
  # summary_rows( groups=F,
  #   column = c(n,percentage),
  #   fns= list(
  #     Sum= ~sum(.)
  #   ), decimals=0) %>%
    grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = ethnicity,
    )
  )  %>%
  tab_footnote(
    footnote = md("The denomination of this table is all participants who selected this race/etnicity only, as well as multi-racial participants that selected this race/ethnicity as well as other race/ethnicities."),
  locations = cells_column_labels(columns = n),
  placement = c("left")
) %>%
  tab_footnote(
    footnote = md("Multi-ethnic in this table is defined as participants that selected multiple ethnicity responses."),
  locations = cells_column_labels(columns = ethnicity),
  placement = c("left")
)
dt_ethnic4


#Middle Eastern or North African
dt_mideast= data_tib_m1 %>%  filter(data_tib_m1$D_384191091_D_384191091_D_973565052==1)  

dt_mideast= dt_mideast %>%  mutate(multb2 = ifelse(D_351657815_D_351657815_D_190152384==1, 1, 0) + ifelse(D_351657815_D_351657815_D_119632587==1, 1, 0) + ifelse(D_351657815_D_351657815_D_578616917==1, 1, 0) + 
                                             ifelse(D_351657815_D_351657815_D_834030167==1, 1, 0) + ifelse(D_351657815_D_351657815_D_680575651==1, 1, 0) + ifelse(D_351657815_D_351657815_D_144320785==1, 1, 0) + ifelse(D_351657815_D_351657815_D_214951746==1, 1, 0) + ifelse(D_351657815_D_351657815_D_932563284==1, 1, 0) + ifelse(D_351657815_D_351657815_D_336596477==1, 1, 0) + ifelse(D_351657815_D_351657815_D_380583570==1, 1, 0) + ifelse(D_351657815_D_351657815_D_807835037==1, 1, 0) + ifelse(D_351657815_D_351657815_D_746038746==1, 1, 0))


                                                    
which_eth= dt_mideast %>%  mutate(ethnicity= case_when(as.numeric(multb2)>1 ~ "Multi-Ethnic",
                                                       D_351657815_D_351657815_D_190152384==1 ~ "Afghan",
                                             D_351657815_D_351657815_D_119632587==1 ~ "Algerian",
                                             D_351657815_D_351657815_D_578616917==1 ~ "Egyptian",
                                             D_351657815_D_351657815_D_834030167==1 ~ "Iranian",
                                             D_351657815_D_351657815_D_680575651==1 ~ "Iraqi",
                                             D_351657815_D_351657815_D_144320785==1 ~ "Israeli",
                                             D_351657815_D_351657815_D_214951746==1 ~ "Lebanese",
                                             D_351657815_D_351657815_D_932563284==1 ~ "Moroccan",
                                             D_351657815_D_351657815_D_336596477==1 ~ "Syrian",
                                             D_351657815_D_351657815_D_380583570==1 ~ "Tunisian",
                                             (D_351657815_D_351657815_D_807835037==1 | !is.na(D_351657815_D_576646485)) ~ "Other",
                                             D_351657815_D_351657815_D_746038746==1 ~ "Prefer Not to Answer",
                                             TRUE   ~ "Skipped this Question"))

dt_mideast_summary <- which_eth %>% group_by(ethnicity) %>%   dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(ethnicity, n, percentage)

dt_mideast_summary %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Ethnicity of Middle Eastern or North African Participants")) %>% 
  cols_label(n= md("**N**"), ethnicity = md("**Answer**"), percentage = md("**%**")) %>% 
  # summary_rows( groups=F,
  #   column = c(n,percentage),
  #   fns= list(
  #     Sum= ~sum(.)
  #   ), decimals=0) %>%
    grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = ethnicity,
    )
  )  %>%
  tab_footnote(
    footnote = md("The denomination of this table is all participants who selected this race/etnicity only, as well as multi-racial participants that selected this race/ethnicity as well as other race/ethnicities."),
  locations = cells_column_labels(columns = n),
  placement = c("left")
) %>%
  tab_footnote(
    footnote = md("Multi-ethnic in this table is defined as participants that selected multiple ethnicity responses."),
  locations = cells_column_labels(columns = ethnicity),
  placement = c("left")
)


#Hawaiian/ Pacific Islander
dt_hawi= data_tib_m1 %>%  filter(data_tib_m1$D_384191091_D_384191091_D_586825330==1)  

dt_hawi= dt_hawi %>%  mutate(multb2 = ifelse(D_115616118_D_115616118_D_664730658==1, 1, 0) + ifelse(D_115616118_D_115616118_D_949727109==1, 1, 0) + ifelse(D_115616118_D_115616118_D_496132363==1, 1, 0) + 
                                             ifelse(D_115616118_D_115616118_D_453456270==1, 1, 0) + ifelse(D_115616118_D_115616118_D_819018322==1, 1, 0) + ifelse(D_115616118_D_115616118_D_685406566==1, 1, 0) + ifelse(D_115616118_D_115616118_D_786290435==1, 1, 0) + ifelse(D_115616118_D_115616118_D_167028305==1, 1, 0) + ifelse(D_115616118_D_115616118_D_345861266==1, 1, 0) +  ifelse(D_115616118_D_115616118_D_807835037==1, 1, 0) + ifelse(D_115616118_D_115616118_D_746038746==1, 1, 0))

                                                       
which_eth= dt_hawi %>%  mutate(ethnicity= case_when(as.numeric(multb2)>1 ~ "Multi-Ethnic",
                                                    D_115616118_D_115616118_D_664730658==1 ~ "Chamorro",
                                             D_115616118_D_115616118_D_949727109==1 ~ "Chuukese",
                                             D_115616118_D_115616118_D_496132363==1 ~ "Fijian",
                                             D_115616118_D_115616118_D_453456270==1 ~ "Marshallese",
                                             D_115616118_D_115616118_D_819018322==1 ~ "Hawaiian",
                                             D_115616118_D_115616118_D_685406566==1 ~ "Palauan",
                                             D_115616118_D_115616118_D_786290435==1 ~ "Samoan",
                                             D_115616118_D_115616118_D_167028305==1 ~ "Tahitian",
                                             D_115616118_D_115616118_D_345861266==1 ~ "Tongan",
                                             (D_115616118_D_115616118_D_807835037==1 | !is.na(D_115616118_D_403180970)) ~ "Other",
                                             D_115616118_D_115616118_D_746038746==1 ~ "Prefer Not to Answer",
                                             TRUE   ~ "Skipped this Question"))

dt_hawi_summary <- which_eth %>% group_by(ethnicity) %>% dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(ethnicity, n, percentage)

 dt_hawi_summary %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Ethnicity of Hawaiian or Pacific Islander Participants")) %>% 
  cols_label(n= md("**N**"), ethnicity = md("**Answer**"), percentage = md("**%**")) %>% 
  # summary_rows( groups=F,
  #   column = c(n,percentage),
  #   fns= list(
  #     Sum= ~sum(.)
  #   ), decimals=0) %>%
    grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = ethnicity,
    )
  )  %>%
  tab_footnote(
    footnote = md("The denomination of this table is all participants who selected this race/etnicity only, as well as multi-racial participants that selected this race/ethnicity as well as other race/ethnicities."),
  locations = cells_column_labels(columns = n),
  placement = c("left")
) %>%
  tab_footnote(
    footnote = md("Multi-ethnic in this table is defined as participants that selected multiple ethnicity responses."),
  locations = cells_column_labels(columns = ethnicity),
  placement = c("left")
)


#White
dt_white= data_tib_m1 %>% filter(data_tib_m1$D_384191091_D_384191091_D_412790539==1) 

dt_white= dt_white %>%  mutate(multb2 = ifelse(D_797626610_D_797626610_D_664571574==1, 1, 0) + ifelse(D_797626610_D_797626610_D_163149180==1, 1, 0) + ifelse(D_797626610_D_797626610_D_192776753==1, 1, 0) + 
                                             ifelse(D_797626610_D_797626610_D_733789220==1, 1, 0) + ifelse(D_797626610_D_797626610_D_418464677==1, 1, 0) + ifelse(D_797626610_D_797626610_D_859329001==1, 1, 0) + ifelse(D_797626610_D_797626610_D_267472307==1, 1, 0) + ifelse(D_797626610_D_797626610_D_918190932==1, 1, 0) + ifelse(D_797626610_D_797626610_D_381749264==1, 1, 0) + ifelse(D_797626610_D_797626610_D_704661219==1, 1, 0) + ifelse(D_797626610_D_797626610_D_773342525==1, 1, 0) +  ifelse(D_797626610_D_797626610_D_807835037==1, 1, 0) + ifelse(D_797626610_D_797626610_D_746038746==1, 1, 0))


which_eth= dt_white %>%  mutate(ethnicity= case_when(as.numeric(multb2)>1 ~ "Multi-Ethnic",
                                                     D_797626610_D_797626610_D_664571574==1 ~ "Ducth",
                                             D_797626610_D_797626610_D_163149180==1 ~ "English",
                                             D_797626610_D_797626610_D_192776753==1 ~ "European",
                                             D_797626610_D_797626610_D_733789220==1 ~ "French",
                                             D_797626610_D_797626610_D_418464677==1 ~ "German",
                                             D_797626610_D_797626610_D_859329001==1 ~ "Irish",
                                             D_797626610_D_797626610_D_267472307==1 ~ "Italian",
                                             D_797626610_D_797626610_D_918190932==1 ~ "Norwegian",
                                             D_797626610_D_797626610_D_381749264==1 ~ "Polish",
                                             D_797626610_D_797626610_D_704661219==1 ~ "Scottish",
                                             D_797626610_D_797626610_D_773342525==1 ~ "Spanish",
                                             (D_797626610_D_797626610_D_807835037==1 | !is.na(D_797626610_D_774928994)) ~ "Other",
                                             D_797626610_D_797626610_D_746038746==1 ~ "Prefer Not to Answer",
                                             TRUE   ~ "Skipped this Question"))

dt_white_summary <- which_eth %>% group_by(ethnicity) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(ethnicity, n, percentage)
gtm3_print <- gt::gt(dt_white_summary)

dt_white_summary %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Ethnicity of White Participants")) %>% 
  cols_label(n= md("**N**"), ethnicity = md("**Answer**"), percentage = md("**%**")) %>% 
  # summary_rows( groups=F,
  #   column = c(n,percentage),
  #   fns= list(
  #     Sum= ~sum(.)
  #   ), decimals=0) %>%
    grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = ethnicity,
    )
  )  %>%
  tab_footnote(
    footnote = md("The denomination of this table is all participants who selected this race/etnicity only, as well as multi-racial participants that selected this race/ethnicity as well as other race/ethnicities."),
  locations = cells_column_labels(columns = n),
  placement = c("left")
) %>%
  tab_footnote(
    footnote = md("Multi-ethnic in this table is defined as participants that selected multiple ethnicity responses."),
  locations = cells_column_labels(columns = ethnicity),
  placement = c("left")
)

```

```{r hisp_other, echo=FALSE, warning=FALSE, include=FALSE}



# Assuming dt_hisp is your data frame

# Define patterns and categories
patterns <- c(
  peru = "peru",
  potruguese = "portuguese",
  panama = "panama",
  nicaragua = "nicara",
  venezuela = "venez",
  hispanic = "span",
  guatemalan = "guat",
  costa_rican = "costa",
  chile = "chil",
  brazil = "brazil",
  bolivian = "boliv",
  argentinian = "argent",
  jamaican = "jamaica",
  paraguayan = "paraguay",
  mexican = "mexic",
  mixed = "mixed",
  american = "america",
  white = "white",
  unsure = "unsure"
)

categorize_ethnicity <- function(response) {
  category <- "Other"
  for (pattern in patterns) {
    if (grepl(pattern, response, ignore.case = TRUE)) {
      category <- pattern
      break
    }
  }
  return(category)
}

# Apply the categorization function to create a new column
dt_hisp <- dt_hisp %>% filter(!is.na(D_308014437_D_440307926)) %>% 
  mutate(Response_Category = sapply(D_308014437_D_440307926, categorize_ethnicity))

# Summarize counts for each category
summary_table <- dt_hisp %>% 
  group_by(Response_Category) %>%
  summarise(Count = n()) %>%
    mutate(
        Response_Category = case_when(
            Response_Category == "peru" ~ "Peruvian",
            Response_Category == "portuguese" ~ "Portuguese",
            Response_Category == "panama" ~ "Panamanian",
            Response_Category == "nicara" ~ "Nicaraguan",
            Response_Category == "venez" ~ "Venezuelan",
            Response_Category == "span" ~ "Hispanic or Spaniard",
            Response_Category == "guat" ~ "Guatemalan",
            Response_Category == "costa" ~ "Costa Rican",
            Response_Category == "chil" ~ "Chilean",
            Response_Category == "brazil" ~ "Brazilian",
            Response_Category == "boliv" ~ "Bolivian",
            Response_Category == "argent" ~ "Argentinian",
            Response_Category == "jamaica" ~ "Jamaican",
            Response_Category == "paraguay" ~ "Paraguayan",
            Response_Category == "mexic" ~ "Mexican or New Mexican",
            Response_Category == "mixed" ~ "Mixed",
            Response_Category == "america" ~ "American",
            Response_Category == "white" ~ "White",
            Response_Category == "unsure" ~ "Unsure",
            TRUE ~ "Other"
        )
    )  %>%
  arrange(desc(Count)) 

# Create a table using gt
oth_hisp_table <- summary_table %>% gt() %>%
  tab_header(
    title = "'Other' Hispanic Ethnicities Selected",
  ) %>% cols_label(Response_Category= md("**Response**"), Count=md("**N**")) %>% 
  grand_summary_rows(columns=c(Count),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) 

tab_footnote(
  oth_hisp_table,
  md("This table gives counts of each individual response type; if a participant gave several ethnicities, they are counted in each of those respective ethnicity rows."),
  locations = cells_column_labels(columns = Count),
  placement = c("left")
)


```


## LANG
```{r Language, echo=FALSE, message=FALSE}

# dt_sex2= dt_sex2 %>%  mutate(multb2 = ifelse(D_588212264_D_588212264_D_163149180==1, 1, 0) + ifelse(D_588212264_D_588212264_D_773342525==1, 1, 0) + ifelse(D_588212264_D_588212264_D_918819379==1, 1, 0) + 
#                                ifelse(D_588212264_D_588212264_D_733789220==1, 1, 0) + ifelse(D_588212264_D_588212264_D_760008937==1, 1, 0) + ifelse(D_750420077_D_582784267==1, 1, 0) + 
#                                ifelse(D_750420077_D_751402477==1, 1, 0) + ifelse(D_750420077_D_700100953==1, 1, 0)  + ifelse(D_750420077_D_700100953==1, 1, 0) +
#                               ifelse(D_750420077_D_700100953==1, 1, 0)  + ifelse(D_750420077_D_700100953==1, 1, 0)  + ifelse(D_750420077_D_700100953==1, 1, 0)  + 
#                                ifelse(D_750420077_D_700100953==1, 1, 0) + ifelse(D_750420077_D_700100953==1, 1, 0) + ifelse(D_750420077_D_700100953==1, 1, 0) +
#                                ifelse(D_750420077_D_700100953==1, 1, 0) + ifelse(D_750420077_D_700100953==1, 1, 0) + ifelse(D_750420077_D_700100953==1, 1, 0) +
#                                  ifelse(D_750420077_D_700100953==1, 1, 0) + ifelse(D_750420077_D_700100953==1, 1, 0) + ifelse(D_750420077_D_700100953==1, 1, 0) +)


data_tib_m1 <- data_tib_m1 %>%
  mutate(multc1 = 0)  # Initialize the multc1 column with zeros

# Filter columns based on pattern
columns_to_sum <- colnames(data_tib_m1)[grepl("D_207025341_D_207025341_D_", colnames(data_tib_m1))]

# Loop through each column and apply the operation
for (col in columns_to_sum) {
  data_tib_m1 <- data_tib_m1 %>%
    mutate(multc1 = ifelse(.data[[col]] == 1, 1, 0) + .data$multc1)
}

which_lang= data_tib_m1 %>%  mutate(language= case_when(as.numeric(multc1)>1 ~ "Multi-Lingual",
                                                        D_588212264_D_588212264_D_163149180==1 ~ "English",
                                                          D_588212264_D_588212264_D_773342525==1 ~ "Spanish",
                                                          D_588212264_D_588212264_D_918819379==1 ~ "Spanish Creole",
                                                          D_588212264_D_588212264_D_733789220==1 ~ "French",
                                                          D_588212264_D_588212264_D_760008937==1 ~ "French Creole",
                                                          D_588212264_D_588212264_D_267472307==1 ~ "Italian",
                                                          D_588212264_D_588212264_D_563857306==1 ~ "Portuguese",
                                                          D_588212264_D_588212264_D_418464677==1 ~ "German",
                                                          D_588212264_D_588212264_D_236546933==1 ~ "Russian",
                                                          D_588212264_D_588212264_D_381749264==1 ~ "Polish",
                                                          D_588212264_D_588212264_D_553424289==1 ~ "Hindi",
                                                          D_588212264_D_588212264_D_750168061==1 ~ "Chinese",
                                                          D_588212264_D_588212264_D_240721579==1 ~ "Korean",
                                                          D_588212264_D_588212264_D_964924704==1 ~ "Vietnamese",
                                                          D_588212264_D_588212264_D_964924704==1 ~ "Tagalog",
                                                          D_588212264_D_588212264_D_367462243==1 ~ "Ilocano",
                                                          D_588212264_D_588212264_D_288079668==1 ~ "Japanese",
                                                          D_588212264_D_588212264_D_669977999==1 ~ "Arabic",
                                                          (D_588212264_D_588212264_D_807835037==1 | !is.na(D_588212264_D_486535201)) ~ "Other",
                                                          TRUE   ~ "Skipped this Question"))

dt_language_summary <- which_lang %>% group_by(language) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(language, n, percentage)

dt_language_summary %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("LANG: Language Spoken in Childhood Home")) %>% 
  cols_label(n= md("**N**"), language = md("**Answer**"), percentage = md("**%**")) %>% 
  # summary_rows( groups=F,
  #   column = c(n,percentage),
  #   fns= list(
  #     Sum= ~sum(.)
  #   ), decimals=0) %>%
  grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
    stub.font.weight = "bold"
  ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = language,
    )
  ) 




 
# tmp1Lang<- data_tib_m1[, grepl("588212264", colnames(data_tib_m1))]
# 
# tmp1Lang <- tmp1Lang[, c(2, 18, 20,15,17,5,13,9, 3,8, 12, 16, 4, 21,  11, 7, 6, 14, 19)]
# 
# lang_dx <- NULL
# for (i in 1:19){
#   dt <- as.data.frame(tab1(tmp1Lang[,i])$output.table)
#   dt$lang_dx <- colnames(tmp1Lang)[i]
#   lang_dx <- rbind(lang_dx,dt[2,])
#   
# }
# lang_dx$lang_dx ### how are their race variables being assigned here?? wrong variable matching. Flattening issue?
# 
# lang_dx$lang_dx <- c("English", "Spanish", "Spanish Creole", "French", "French Creole", "Italian", "Portuguese", "German", "Russian", "Polish", "Hindi", "Chinese","Korean", "Vietnamese", "Tagalog", "Ilocano", "Japanese", "Arabic", "Other")
# 
# ```
# ```{r, warning=FALSE, echo=FALSE, message=FALSE}
# # colnames(lang_dx) <- c("Frequency", "Percentage" , "  %(NA-)",  "Condition")
# # mgr1_1 <- lang_dx[, c(4,1,2)]
# # 
# # colnames(lang_dx) <- c("Frequency", "Percentage" , "  %(NA+)",  "Condition")
# # mgr1_2 <- lang_dx[, c(4,1,2)]
# 
# colnames(lang_dx) <- c("Frequency", "Percentage" , "  %(NA+)",  "Condition")
# lang1 <- lang_dx[, c(4,1,2)]
# 
# skipped_lang1 <- sum(table(which_lang$language=="Skipped this Question")[2])
# lang1[as.numeric(dim(lang1)[[1]])+1,] <- c("Skipped this Question", skipped_lang1, round((skipped_lang1/dim(data_tib_m1)[[1]])*100,2))
# 
# 
# dt_lang1 <- lang1 %>%  gt::gt(rowname_col = "row_lab") %>%  
#   fmt_number(columns = "Percentage", decimals = 2) %>% 
#   tab_header(title = md("LANG: Language Spoken in Childhood Home")) %>% 
#   cols_label(Frequency= md("**N**"), Percentage=md("**Percentge of Participants**"),  Condition = md("**Answer**")) %>% 
#   # summary_rows( groups=F,
#   #   column = c(Frequency,Percentage),
#   #   fns= list(
#   #     Sum= ~sum(.)
#   #   ), decimals=0) %>%
#   #grand_summary_rows(columns=c(Frequency, Percentage),fns = ~sum(.,na.rm = T))|>
#   tab_options(
#       stub.font.weight = "bold"
#     ) %>%
#   tab_style(
#     style = list(
#       cell_text(weight = "bold")
#     ),
#     locations = cells_body(
#       columns = Condition,
#     )
#   )
# tab_footnote(
#   dt_lang1,
#   md("As this is a select all question, participants may select multiple responses."),
#   locations = cells_column_labels(columns = Percentage),
#   placement = c("left")
# )



```





## Sex at Birth, Gender, Sexual Orientation and Style 
```{r SMG, warning=FALSE, echo=FALSE, message=FALSE}


simple_funct(D_407056417, "Sex at birth")

#levels=c("Woman", "Man", "Transgender Man", "Transgender Woman", "Genderqueer", "Non-binary", "Other", "Prefer Not to Answer") #, "Skipped this Question")
#simple_funct(D_289664241_D_289664241, "Gender")

style= data_tib_m1  %>%  mutate(descr= case_when(D_289664241_D_289664241==536341288 | D_289664241_D_289664241==218837028 ~ "Woman",
                                               D_289664241_D_289664241==654207589 | D_289664241_D_289664241==983318667 ~ "Man",
                                               D_289664241_D_289664241==405267600 ~ "Transgender Man",
                                               D_289664241_D_289664241==873138103 ~ "Transgender Woman",
                                               D_289664241_D_289664241==805712793 ~ "Genderqueer",
                                               D_289664241_D_289664241==486192236 ~ "Non-binary",
                                               D_289664241_D_289664241==807835037 ~ "Other",
                                               D_289664241_D_289664241==746038746 ~ "Prefer Not to Answer",
                                               TRUE ~ "Skipped this Question"))

style$descr <- factor(style$descr,levels=c("Woman", "Man", "Transgender Man", "Transgender Woman", "Genderqueer", "Non-binary", "Other", "Prefer Not to Answer", "Skipped this Question"))

dt_appearence_summary <- style  %>% dplyr::group_by(descr) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(descr, n, percentage) 


dtgender <- dt_appearence_summary %>%  gt::gt(rowname_col = "row_lab") %>%
  fmt_number(columns = "percentage", decimals = 2) %>%
  tab_header(title = md("Gender")) %>%
  cols_label(n= md("**N**"),descr = md("**Description**"), percentage = md("**%**")) %>%
  grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = descr,
    )
   ) 
tab_footnote(
  dtgender,
  md("These response options are mutually exclusive categories; only one response may be selected."),
  locations = cells_column_labels(columns = descr),
  placement = c("left")
)



# SEX2

dt_sex2= data_tib_m1 %>% filter(D_407056417==576796184) 

dt_sex2= dt_sex2 %>%  mutate(multb2 = ifelse(D_750420077_D_846483618==1, 1, 0) + ifelse(D_750420077_D_505282171==1, 1, 0) + ifelse(D_750420077_D_578416151==1, 1, 0) + 
                               ifelse(D_750420077_D_434651539==1, 1, 0) + ifelse(D_750420077_D_108025529==1, 1, 0) + ifelse(D_750420077_D_582784267==1, 1, 0) + ifelse(D_750420077_D_751402477==1, 1, 0) +
                               ifelse(D_750420077_D_700100953==1, 1, 0) )


which_sex2= dt_sex2 %>%  mutate(body_part= case_when(as.numeric(multb2)>1 ~ "Multiple Body Parts",
                                                     D_750420077_D_582784267==1 ~ "Penis",
                                             D_750420077_D_751402477==1 ~ "Testes",
                                             D_750420077_D_700100953==1 ~ "Prostate Gland",
                                             D_750420077_D_846483618==1 ~ "Vagina",
                                             D_750420077_D_505282171==1 ~ "Cervix",
                                             D_750420077_D_578416151==1 ~ "Uterus",
                                             D_750420077_D_434651539==1 ~ "Ovaries",
                                             D_750420077_D_108025529==1 ~ "Fallopian Tubes",
                                             TRUE   ~ "Skipped this Question"))

dt_sex2_summary <- which_sex2 %>% group_by(body_part) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(body_part, n, percentage)
#gtm3_print <- gt::gt(dt_sex2_summary)

dt_sex2_summary %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Body Part of Intersex Participants")) %>% 
  cols_label(n= md("**N**"), body_part = md("**Answer**"), percentage = md("**%**")) %>% 
  # summary_rows( groups=F,
  #   column = c(n,percentage),
  #   fns= list(
  #     Sum= ~sum(.)
  #   ), decimals=0) %>%
    grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = body_part,
    )
  ) 





#Appearance/Style
data_tib_m1$D_987107433 <- factor(data_tib_m1$D_987107433, levels=c(220083334,541300533,878286618,910745276,510148951,265452386,915528806,746038746, "Skipped this Question"))
simple_funct(D_987107433, "STYLE: Appearence, Style, Dress, Mannerisms")


data_tib_m1$D_555481393_D_555481393 <- factor(data_tib_m1$D_555481393_D_555481393, levels=c(271882746,903084185,999994434,727200870,854349138,832978839,197935377,410008111,831942158,210894509,807835037,178420302,746038746, "Skipped this Question"))
simple_funct(D_555481393_D_555481393, "SEXORIET: Sexual Orienation")
#data_tib_m1 %>%  select(D_555481393_D_979809707) %>% filter(!is.na(D_555481393_D_979809707)) %>% gt::gt() %>% cols_label(D_555481393_D_979809707= md("**Response for 'Other' Sexual Orientation**"))



```

### Specific Demographics 
```{r Demogrpahics, warning=FALSE, echo=FALSE, message=FALSE}
#Specific demographics (white, straight, married females)

WMF = module1 %>% filter(D_555481393_D_555481393=="271882746") %>% filter(D_407056417==536341288) %>% filter(D_783167257==288321056) %>% 
  filter(D_384191091_D_384191091_D_412790539==1) %>% filter(D_588212264_D_588212264_D_163149180==1)
cat("Number of White, Straight, Married, Female Participants", round(((dim(WMF)[[1]])/dim(module1)[[1]])*100, digits=2), "%")

```

\newpage

# Section 2: Medical History 
## Cancer 
```{r SkinCancer, warning=FALSE, echo=FALSE, message=FALSE}
simple_funct(D_537153788, "SKINCANC: Diagnosed with Non-Melanoma Skin Cancer")



skincnc_type= data_tib_m1 %>%  filter(data_tib_m1$D_537153788==353358909) %>%  mutate(Type= case_when(D_508846529_D_864052438==1 & D_508846529_D_323177352==0~"Basal Cell",
                                                    D_508846529_D_323177352==1 & D_508846529_D_864052438==0 ~ "Squamous Cell",
                                                    D_508846529_D_323177352==1 & D_508846529_D_864052438==1 ~ "Both",
                                                    D_508846529_D_178420302==1 ~ "Unknown",
                                                    TRUE ~ "Skipped this Question"))
skincnc_type$Type <- factor(skincnc_type$Type,levels=c("Basal Cell", "Squamous Cell", "Both", "Unknown", "Skipped this Question"))

dt_skincnc_type_summary <- skincnc_type %>% dplyr::group_by(Type) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Type, n, percentage)


dt_skincnc_type_summary %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("SKINCANC2: Type(s) or Skin Cancer Diagnosed")) %>% 
  cols_label(n= md("**N**"),Type = md("**Type**"), percentage = md("**%**")) %>% 
  # summary_rows(
  #   column = c(participants,percentage),
  #   fns= list(
  #     Sum= ~sum(.)
  #   ), decimals=0) %>%
  grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Type,
    )
  ) 


boxp_funct(D_904550680_D_206625031, "Age Diagnosed with Skin Cancer", "Age")


```

\newpage

## Cardiovascular Disease
```{r MHGroup1, warning=FALSE, echo=FALSE, message=FALSE, include=FALSE}


#mhgroup1= data_tib_m1 %>%  mutate(mult1= case_when()) -- add multiple choices 

mhgroup1COUNT= data_tib_m1 %>%  mutate(cardiov= case_when(D_167101091_D_698944820==1 ~ "B-12 Deficiency",
                                             D_167101091_D_838744325==1 ~ "Coronary Artery",
                                             D_167101091_D_769790179==1 ~ "Congestive Heart Failure",
                                             D_167101091_D_699553344==1 ~ "High Cholesterol",
                                             D_167101091_D_700811160==1 ~ "Heart Attack",
                                             D_167101091_D_336505365==1 ~ "Abnormal Heart Rhythm",
                                             D_167101091_D_132548932==1 ~ "Chest Pain",
                                             D_167101091_D_747787163==1 ~ "Heart Valve Problems",
                                             D_167101091_D_693851465==1 ~ "High Blood Pressure",
                                             D_167101091_D_512012656==1 ~ "Blood Clots",
                                             D_167101091_D_619337095==1 ~ "Stroke",
                                             D_167101091_D_535003378==1 ~ "None",
                                             TRUE ~ "Skipped this Question"))
mhgroup1COUNT$cardiov <- factor(mhgroup1COUNT$cardiov,levels=c("B-12 Deficiency","Coronary Artery","Congestive Heart Failure","High Cholesterol","Heart Attack","Abnormal Heart Rhythm","Chest Pain","Heart Valve Problems","High Blood Pressure","Blood Clots","Stroke","None","Skipped this Question"))
  
dt_cardiov_summary <- mhgroup1COUNT  %>% dplyr::group_by(cardiov) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(cardiov, n, percentage) 


gt_mh1<- dt_cardiov_summary %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("MHGROUP1: Diagnosed Cardiovascular Conditions")) %>% 
  cols_label(cardiov = md("**Answer**"), n= md("**N**"),percentage = md("**%**")) %>% 
  # summary_rows(
  #   column = c(participants,percentage),
  #   fns= list(
  #     Sum= ~sum(.)
  #   ), decimals=0) %>%
  grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = cardiov,
    )
  ) 




 
tmp1<- data_tib_m1[, grepl("167101091", colnames(data_tib_m1))]
cardio_dx <- NULL
for (i in 1:12){
  dt <- as.data.frame(tab1(tmp1[,i])$output.table)
  dt$cardio_dx <- colnames(tmp1)[i]
  cardio_dx <- rbind(cardio_dx,dt[2,])
  
}
cardio_dx$cardio_dx ### how are their race variables being assigned here?? wrong variable matching. Flattening issue?

cardio_dx$cardio_dx <- c("Chest Pain","Abnormal Heart Rhythm","Blood Clots","None","Stroke","High Blood Pressure","B-12 Deficiency","High Cholesterol","Heart Attack","Heart Valve Problems","Congestive Heart Failure","Coronary Artery")
```
```{r MHGroup1Table, warning=FALSE, echo=FALSE, message=FALSE}
# colnames(cardio_dx) <- c("Frequency", "Percentage" , "  %(NA-)",  "Condition")
# mgr1_1 <- cardio_dx[, c(4,1,2)]
# 
# colnames(cardio_dx) <- c("Frequency", "Percentage" , "  %(NA+)",  "Condition")
# mgr1_2 <- cardio_dx[, c(4,1,2)]

colnames(cardio_dx) <- c("Frequency", "Percentage" , "  %(NA+)",  "Condition")
mgr1 <- cardio_dx[, c(4,1,2)]

skipped_mhg1 <- sum(table(mhgroup1COUNT$cardiov=="Skipped this Question")[2])
mgr1[as.numeric(dim(mgr1)[[1]])+1,] <- c("Skipped this Question", skipped_mhg1, round((skipped_mhg1/dim(data_tib_m1)[[1]])*100,2))


dt_mgr1 <- mgr1 %>%  gt::gt(rowname_col = "row_lab") %>%  
  tab_header(title = md("MHGROUP1: Diagnosed Cardiovascular Conditions")) %>% 
  cols_label(Frequency= md("**N**"), Percentage=md("**Percentge of Participants**"),  Condition = md("**Answer**")) %>% 
  # summary_rows( groups=F,
  #   column = c(Frequency,Percentage),
  #   fns= list(
  #     Sum= ~sum(.)
  #   ), decimals=0) %>%
  #grand_summary_rows(columns=c(Frequency, Percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Condition,
    )
  )
tab_footnote(
  dt_mgr1,
  md("As this is a select all question, participants may select multiple responses."),
  locations = cells_column_labels(columns = Percentage),
  placement = c("left")
)




```

```{r MHGroup1Diagn, warning=FALSE, echo=FALSE, message=FALSE}
##Cardiovascular 

#cat("B-12 Deficiency (Pernicious Anemia) Diagnosis")
b12_a_dg=boxp_funct(D_965917116_D_206625031,"B12 Deficiency Age at Diagnosis","Age" )
b12_y_dg=boxp_funct(D_965917116_D_261863326,"B12 Deficiency Year at Diagnosis","Year" )
grid.arrange(b12_a_dg, b12_y_dg, nrow=2)


#cat("Coronary Artery/Coronary Heart Disease Diagnosis")
chd_a_dg=boxp_funct(D_929240175_D_206625031,"CHD Age at Diagnosis","Age" )
chd_y_dg=boxp_funct(D_929240175_D_261863326,"CHD Year at Diagnosis","Year" )
grid.arrange(chd_a_dg, chd_y_dg, nrow=2)



#cat("Congestive Heart Failure Diagnosis")
chf_a_dg=boxp_funct(D_836712013_D_206625031,"CHF Age at Diagnosis","Age" ) 
chf_y_dg=boxp_funct(D_836712013_D_261863326,"CHF Year at Diagnosis","Year" )
grid.arrange(chf_a_dg, chf_y_dg, nrow=2)


#cat("High Cholesterol Diagnosis")
hc_a_dg=boxp_funct(D_836890480_D_206625031,"High Cholesterol Age at Diagnosis","Age" )
hc_y_dg=boxp_funct(D_836890480_D_261863326,"High Cholesterol Year at Diagnosis","Year" )
grid.arrange(hc_a_dg, hc_y_dg, nrow=2)



#cat("Heart Attack (Myocardial Infarction) Diagnosis")
hrt_a_dg=boxp_funct(D_624479779_D_206625031,"Heart Attack Age at Diagnosis","Age" )
hrt_y_dg=boxp_funct(D_624479779_D_261863326,"Heart Attack Year at Diagnosis","Year" )
grid.arrange(hrt_a_dg, hrt_y_dg, nrow=2)


#cat("Abnormal Heart Rhythm (Arrhythmia) Diagnosis")
ahr_a_dg=boxp_funct(D_337278854_D_206625031,"Arrhythmia Age at Diagnosis","Age" )
ahr_y_dg=boxp_funct(D_337278854_D_261863326,"Arrhythmia Year at Diagnosis","Year" )
grid.arrange(ahr_a_dg, ahr_y_dg, nrow=2)


#cat("Chest Pain (Angina) Diagnosis")
cp_a_dg=boxp_funct(D_681229479_D_206625031,"Chest Pain Age at Diagnosis","Age" )
cp_y_dg=boxp_funct(D_681229479_D_261863326,"Chest Pain Year at Diagnosis","Year" )
grid.arrange(cp_a_dg, cp_y_dg, nrow=2)


#cat("Heart Valve Problems Diagnosis")
hvp_a_dg=boxp_funct(D_660358706_D_206625031,"Heart Valve Age Problems at Diagnosis","Age" )
hvp_y_dg=boxp_funct(D_660358706_D_261863326,"Heart Valve Year Problems at Diagnosis","Year" )
grid.arrange(hvp_a_dg, hvp_y_dg, nrow=2)



#cat("High Blood Pressure (Hypertension) Diagnosis")
hbp_a_dg=boxp_funct(D_884793537_D_206625031,"High Blood Pressure Age at Diagnosis","Age" )
hbp_y_dg=boxp_funct(D_884793537_D_261863326,"High Blood Pressure Year at Diagnosis","Year" )
grid.arrange(hbp_a_dg, hbp_y_dg, nrow=2)


#cat("Blood Clots (Deep Vein Thrombosis, Pulmonary Embolism) Diagnosis")
bc_a_dg=boxp_funct(D_460062034_D_206625031,"Blood Clot Age at Diagnosis","Age")
bc_y_dg=boxp_funct(D_460062034_D_261863326,"Blood Clot Year at Diagnosis","Year")
grid.arrange(bc_a_dg, bc_y_dg, nrow=2)


#cat("Stroke Diagnosis")
stroke_a_dg=boxp_funct(D_110652436_D_206625031,"Stroke Age at Diagnosis","Age") 
stroke_y_dg=boxp_funct(D_110652436_D_261863326,"Stroke Year at Diagnosis","Year")
grid.arrange(stroke_a_dg, stroke_y_dg, nrow=2)


```

\newpage

## Respiratory Problems 
```{r MHGroup2, warning=FALSE, echo=FALSE, message=FALSE, include=FALSE}

mhgroup2= data_tib_m1 %>%  mutate(resp= case_when(D_894259747_D_359025642==1 ~ "Chronic Lung Disease",
                                             D_894259747_D_407340134==1 ~ "Asthma",
                                             D_894259747_D_427219143==1 ~ "Hay Fever",
                                             D_894259747_D_535003378==1 ~ "None",
                                             TRUE ~ "Skipped this Question"))

dt_resp_summary <- mhgroup2  %>% dplyr::group_by(resp) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(resp, n, percentage)


gt_mh2<- dt_resp_summary %>%  gt::gt(rowname_col = "row_lab") %>%
  fmt_number(columns = "percentage", decimals = 2) %>%
  tab_header(title = md("MHGROUP2: Diagnosed Respiratory Conditions")) %>%
  cols_label(n= md("**N**"), resp = md("**Answer**"), percentage = md("**%**")) %>%
  # summary_rows(
  #   column = c(participants,percentage),
  #   fns= list(
  #     Sum= ~sum(.)
  #   ), decimals=0) %>%
  grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = resp,
    )
  ) 



tmp2<- data_tib_m1[, grepl("894259747", colnames(data_tib_m1))]
lung_dx <- NULL
for (i in 1:4){
  dt <- as.data.frame(tab1(tmp2[,i])$output.table)
  dt$lung_dx <- colnames(tmp2)[i]
  lung_dx <- rbind(lung_dx,dt[2,])
  
}

lung_dx$lung_dx <- c("Chronic lung disease","Asthma", "Hay Fever", "None")
```
```{r MHGroup2Table, warning=FALSE, echo=FALSE, message=FALSE}
colnames(lung_dx) <- c("Frequency", "Percentage" , "  %(NA-)",  "lung_dx")
mgr2 <- lung_dx[, c(4,1,2)]

skipped_mhg2 <- sum(table(mhgroup2$resp=="Skipped this Question")[2])
mgr2[as.numeric(dim(mgr2)[[1]])+1,] <- c("Skipped this Question", skipped_mhg2, round((skipped_mhg2/dim(data_tib_m1)[[1]])*100,2))


dt_mgr2 <- mgr2 %>%  gt::gt(rowname_col = "row_lab") %>%  
  tab_header(title = md("MHGROUP2: Diagnosed Respiratory Conditions")) %>% 
  cols_label(Frequency= md("**N**"), Percentage=md("**Percentge of Participants**"),  lung_dx = md("**Answer**")) %>% 
  # summary_rows(
  #   column = c(participants,percentage),
  #   fns= list(
  #     Sum= ~sum(.)
  #   ), decimals=0) %>%
  #grand_summary_rows(columns=c(Frequency, Percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = lung_dx,
    )
  ) %>% 
tab_footnote(
    footnote = "As this is a select all question, participants may select multiple responses.",
    locations=cells_column_labels(Percentage)
  ) %>%
  tab_footnote(
    footnote = md("Hay Fever includes Allergy to pollen or Allergic Rhinitis."),
    locations=cells_column_labels(lung_dx)
  )

dt_mgr2


```

```{r MHGroup2Diagn, warning=FALSE, echo=FALSE, message=FALSE}
###Respiratory


#cat("Chronic Lung Disease Diagnosis")
cld_a_dg=boxp_funct(D_448722126_D_206625031,"Chronic Lung Disease Age at Diagnosis","Age")
cld_y_dg=boxp_funct(D_448722126_D_261863326,"Chronic Lung Disease Year of Diagnosis","Year")
grid.arrange(cld_a_dg, cld_y_dg, nrow=2)



#cat("Asthma Diagnosis")
asth_a_dg=boxp_funct(D_201449164_D_206625031,"Asthma Age at Diagnosis","Age")
asth_y_dg=boxp_funct(D_201449164_D_261863326,"Asthma Year of Diagnosis","Year")
grid.arrange(asth_a_dg, asth_y_dg, nrow=2)



#cat("Hay Fever Diagnosis")
hay_a_dg=boxp_funct(D_436333358_D_206625031,"Hay Fever Age at Diagnosis","Age")
hay_y_dg=boxp_funct(D_436333358_D_261863326,"Hay Fever Year of Diagnosis","Year")
grid.arrange(hay_a_dg, hay_y_dg, nrow=2)


```

\newpage

## Digestive System Problems 
```{r MHGroup3, warning=FALSE, echo=FALSE, message=FALSE, include=FALSE}

mhgroup3= data_tib_m1 %>%  mutate(digest= case_when(D_180961306_D_406890409==1 ~ "Esophageal Acid Reflex",
                                             D_180961306_D_704544306==1 ~ "Barrett's Esophagus",
                                             D_180961306_D_691766591==1 ~ "Irritable Bowel Syndrome",
                                             D_180961306_D_308645635==1 ~ "Inflammatory Bowel Disease",
                                             D_180961306_D_731115613==1 ~ "Diverticulitis or Diverticulosis",
                                             D_180961306_D_567284980==1 ~ "Ulcerative Colitis",
                                             D_180961306_D_986548173==1 ~ "Crohn's Disease",
                                             D_180961306_D_285995100==1 ~ "Celiac Disease",
                                             D_180961306_D_545628561==1 ~ "Gallstones",
                                             D_180961306_D_709786039==1 ~ "Liver Cirrhosis",
                                             D_180961306_D_984479578==1 ~ "Pancreatitis",
                                             D_180961306_D_535003378==1 ~ "None",
                                             TRUE ~ "Skipped this Question"))

dt_digest_summary <- mhgroup3  %>% dplyr::group_by(digest) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(digest, n, percentage) 


gt_mh3<- dt_digest_summary %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("MHGROUP3: Diagnosed Digestive System Problems")) %>% 
  cols_label(n= md("**N**"),digest = md("**Answer**"), percentage = md("**%**")) %>% 
  # summary_rows(
  #   column = c(participants,percentage),
  #   fns= list(
  #     Sum= ~sum(.)
  #   ), decimals=0) %>%
  grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = digest,
    )
  ) 




tmp3<- data_tib_m1[, grepl("180961306", colnames(data_tib_m1))]
dgst_dx <- NULL
for (i in 1:12){
  dt <- as.data.frame(tab1(tmp3[,i])$output.table)
  dt$dgst_dx <- colnames(tmp3)[i]
  dgst_dx <- rbind(dgst_dx,dt[2,])
  
}

dgst_dx$dgst_dx
dgst_dx$dgst_dx <- c("Celiac Disease", "Inflammatory Bowel Disease","Esophageal Acid Reflex","None","Gallstones","Ulcerative Colitis","Irritable Bowel Syndrome","Barrett's Esophagus","Liver Cirrhosis","Diverticulitis or Diverticulosis","Pancreatitis","Crohn's Disease")

```
```{r MHGroup3Tables, warning=FALSE, echo=FALSE, message=FALSE}
colnames(dgst_dx) <- c("Frequency", "Percentage" , "  %(NA-)",  "dgst_dx")
mgr3 <- dgst_dx[, c(4,1,2)]

skipped_mhg3 <- sum(table(mhgroup3$digest=="Skipped this Question")[2])
mgr3[as.numeric(dim(mgr3)[[1]])+1,] <- c("Skipped this Question", skipped_mhg3, round((skipped_mhg3/dim(data_tib_m1)[[1]])*100,2))


dt_mgr3 <- mgr3 %>%  gt::gt(rowname_col = "row_lab") %>%  
  tab_header(title = md("MHGROUP3: Diagnosed Digestive System Problems")) %>% 
  cols_label(Frequency= md("**N**"), Percentage=md("**Percentge of Participants**"), dgst_dx = md("**Answer**")) %>% 
  # summary_rows(
  #   column = c(participants,percentage),
  #   fns= list(
  #     Sum= ~sum(.)
  #   ), decimals=0) %>%
  #grand_summary_rows(columns=c(Frequency, Percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = dgst_dx,
    )
  )
tab_footnote(
  dt_mgr3,
  md("As this is a select all question, participants may select multiple responses."),
  locations = cells_column_labels(columns = Percentage),
  placement = c("left")
)


```

```{r MHGroup3Diagn, warning=FALSE, echo=FALSE, message=FALSE}


#cat("Esophageal Acid Reflux (GERD) Diagnosis")
gerd_a_dg=boxp_funct(D_554782332_D_206625031,"Esophageal Acid Reflux Age at Diagnosis","Age")
gerd_y_dg=boxp_funct(D_554782332_D_261863326,"Esophageal Acid Reflux Year of Diagnosis","Year")
grid.arrange(gerd_a_dg, gerd_y_dg, nrow=2)


#cat("Barretts Esophagus Diagnosis")
barr_a_dg=boxp_funct(D_409622468_D_206625031,"Barrett's Esophagus Age at Diagnosis","Age")
barr_y_dg=boxp_funct(D_409622468_D_261863326,"Barrett's Esophagus Year of Diagnosis","Year")
grid.arrange(barr_a_dg, barr_y_dg, nrow=2)



#cat("Irritable Bowel Syndrome Diagnosis")
ibs_a_dg=boxp_funct(D_448476881_D_206625031,"Irritable Bowel Syndrome Age at Diagnosis","Age")
ibs_y_dg=boxp_funct(D_448476881_D_261863326,"Irritable Bowel Syndrome Year of Diagnosis","Year") 
grid.arrange(ibs_a_dg, ibs_y_dg, nrow=2)


#cat("Inflammatory Bowel Disease Diagnosis")
ibd_a_dg=boxp_funct(D_459764934_D_206625031,"Inflammatory Bowel Disease Age at Diagnosis","Age") 
ibd_y_dg=boxp_funct(D_459764934_D_261863326,"Inflammatory Bowel Disease Year of Diagnosis","Year")
grid.arrange(ibd_a_dg, ibd_y_dg, nrow=2)



#cat("Diverticulitis or Diverticulosis Diagnosis")
div_a_dg=boxp_funct(D_374697037_D_206625031,"Diverticulitis Age at Diagnosis","Age") 
div_y_dg=boxp_funct(D_374697037_D_261863326,"Diverticulitis Year of Diagnosis","Year")
grid.arrange(div_a_dg, div_y_dg, nrow=2)


#cat("Ulcerative Colitis Diagnosis")
uc_a_dg=boxp_funct(D_580911251_D_206625031,"Ulcerative Colitis Age at Diagnosis","Age") 
uc_y_dg=boxp_funct(D_580911251_D_261863326,"Ulcerative Colitis Year of Diagnosis","Year") 
grid.arrange(uc_a_dg, uc_y_dg, nrow=2)


#cat("Crohn's Disease Diagnosis")
crohns_a_dg=boxp_funct(D_190347832_D_206625031,"Crohn's Disease Age at Diagnosis","Age")
crohns_y_dg=boxp_funct(D_190347832_D_261863326,"Crohn's Disease Year of Diagnosis","Year")
grid.arrange(crohns_a_dg, crohns_y_dg, nrow=2)


#cat("Celiac Disease (also known as Gluten-Sensitive Enteropathy) Diagnosis")
cel_a_dg=boxp_funct(D_624777141_D_206625031,"Crohn's Disease Age at Diagnosis","Age") 
cel_y_dg=boxp_funct(D_624777141_D_261863326,"Crohn's Disease Year of Diagnosis","Year") 
grid.arrange(cel_a_dg, cel_y_dg, nrow=2)


#cat("Gallstones (Biliary Stones) Diagnosis")
gall_a_dg=boxp_funct(D_980403315_D_206625031,"Gallstones Age at Diagnosis","Age") 
gall_y_dg=boxp_funct(D_980403315_D_261863326,"Gallstones Year of Diagnosis","Year")
grid.arrange(gall_a_dg, gall_y_dg, nrow=2)


#cat("Liver Cirrhosis Diagnosis")
liver_a_dg=boxp_funct(D_936039586_D_206625031,"Liver Cirrhosis Age at Diagnosis","Age") 
liver_y_dg=boxp_funct(D_936039586_D_261863326,"Liver Cirrhosis Year of Diagnosis","Year")
grid.arrange(liver_a_dg, liver_y_dg, nrow=2)


#cat("Pancreatitis Diagnosis")
panc_a_dg=boxp_funct(D_430472084_D_206625031,"Pancreatitis Age at Diagnosis","Age") 
panc_y_dg=boxp_funct(D_430472084_D_261863326,"Pancreatitis Year of Diagnosis","Year")
grid.arrange(panc_a_dg, panc_y_dg, nrow=2)


```

\newpage

## Thyroid, Dibetes, and Grave's Disease 
```{r MHGroup4, warning=FALSE, echo=FALSE, message=FALSE, include=FALSE}

mhgroup4= data_tib_m1 %>%  mutate(thy_d_g= case_when(D_900541533_D_726539692==1 ~ "Thyroid Disorder", 
                                             D_900541533_D_158044532==1 ~ "Diabetes",
                                             D_900541533_D_943054522==1 ~ "Graves' Disease",
                                             D_900541533_D_535003378==1 ~ "None",
                                             TRUE ~ "Skipped this Question"))

dt_thy_d_g_summary <- mhgroup4 %>%  dplyr::group_by(thy_d_g) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(thy_d_g, n, percentage) 

gt_mh4<- dt_thy_d_g_summary %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("MHGROUP4: Diagnosed with Any of These Conditions")) %>% 
  cols_label(n= md("**N**"),thy_d_g = md("**Answer**"), percentage = md("**%**")) %>% 
  # summary_rows(
  #   column = c(participants,percentage),
  #   fns= list(
  #     Sum= ~sum(.)
  #   ), decimals=0) %>%
  grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = thy_d_g,
    )
  ) 




tmp4<- data_tib_m1[, grepl("900541533", colnames(data_tib_m1))]
thyrd_dx <- NULL
for (i in 1:4){
  dt <- as.data.frame(tab1(tmp4[,i])$output.table)
  dt$thyrd_dx <- colnames(tmp4)[i]
  thyrd_dx <- rbind(thyrd_dx,dt[2,])
  
}
thyrd_dx$thyrd_dx
thyrd_dx$thyrd_dx <- c("Diabetes",  "None", "Thyroid Disorder", "Graves' Disease")
```
```{r MHGroup4Tables, warning=FALSE, echo=FALSE, message=FALSE}
colnames(thyrd_dx) <- c("Frequency", "Percentage" , "  %(NA-)",  "thyrd_dx")
mgr4 <- thyrd_dx[, c(4,1, 2)]

skipped_mhg4 <- sum(table(mhgroup4$thy_d_g=="Skipped this Question")[2])
mgr4[as.numeric(dim(mgr4)[[1]])+1,] <- c("Skipped this Question", skipped_mhg4, round((skipped_mhg4/dim(data_tib_m1)[[1]])*100,2))


dt_mgr4 <- mgr4 %>%  gt::gt(rowname_col = "row_lab") %>%  
  tab_header(title = md("MHGROUP4: Diagnosed with Any of These Conditions")) %>% 
  cols_label(Frequency= md("**N**"),Percentage=md("**Percentge of Participants**"), thyrd_dx = md("**Answer**")) %>% 
  # summary_rows(
  #   column = c(participants,percentage),
  #   fns= list(
  #     Sum= ~sum(.)
  #   ), decimals=0) %>%
  #grand_summary_rows(columns=c(Frequency, Percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = thyrd_dx,
    )
  )
tab_footnote(
  dt_mgr4,
  md("As this is a select all question, participants may select multiple responses."),
  locations = cells_column_labels(columns = Percentage),
  placement = c("left")
)




```

```{r MHGroup4Diagn, warning=FALSE, echo=FALSE, message=FALSE}
#MHGROUP4


#cat("Thyroid Diagnosis") 
thy_a_dg=boxp_funct(D_139655599_D_206625031,"Thyroid Disease Age at Diagnosis","Age") 
thy_y_dg=boxp_funct(D_139655599_D_261863326,"Thyroid Disease Year of Diagnosis","Year")
grid.arrange(thy_a_dg, thy_y_dg, nrow=2)


#cat("Diabetes") 
one_logic_funct(D_494032093, D_900541533_D_158044532, 1, "Type of Diabetes")

dieb_a_dg=boxp_funct(D_301679110_D_206625031,"Diabetes Age at Diagnosis","Age") 
dieb_y_dg=boxp_funct(D_301679110_D_261863326,"Diabetes Year of Diagnosis","Year")
grid.arrange(dieb_a_dg, dieb_y_dg, nrow=2)


#cat("Graves Disease Diagnosis") 
graves_a_dg=boxp_funct(D_810918716_D_206625031,"Graves Disease Age at Diagnosis","Age") 
graves_y_dg=boxp_funct(D_810918716_D_261863326,"Graves Disease Year of Diagnosis","Year") 
grid.arrange(graves_a_dg, graves_y_dg, nrow=2)

```

\newpage

## Kidney 
```{r MHGroup5, include=FALSE}
mhgroup5= data_tib_m1 %>%  mutate(kidn= case_when(D_874046190_D_827542780==1 ~ "Kidney Stones", 
                                             D_874046190_D_167238688==1 ~ "Chronic Kindey Disease",
                                             D_874046190_D_535003378==1 ~ "None",
                                             TRUE ~ "Skipped this Question"))

dt_kidn_summary <- mhgroup5 %>% dplyr::group_by(kidn) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(kidn, n, percentage) 

gt_mh5<- dt_kidn_summary %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("MHGROUP5: Diagnosed with Kidney Conditions")) %>% 
  cols_label(n= md("**N**"), kidn = md("**Answer**"), percentage = md("**%**")) %>% 
  # summary_rows(
  #   column = c(participants,percentage),
  #   fns= list(
  #     Sum= ~sum(.)
  #   ), decimals=0) %>%
  grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = kidn,
    )
  ) 




tmp5<- data_tib_m1[, grepl("874046190", colnames(data_tib_m1))]
kidn_dx <- NULL
for (i in 1:3){
  dt <- as.data.frame(tab1(tmp5[,i])$output.table)
  dt$kidn_dx <- colnames(tmp5)[i]
  kidn_dx <- rbind(kidn_dx,dt[2,])
  
}
kidn_dx$kidn_dx
kidn_dx$kidn_dx <- c("Chronic Kindey Disease",  "None", "Kidney Stones")
```
```{r MHGroup5Table, warning=FALSE, echo=FALSE, message=FALSE}
colnames(kidn_dx) <- c("Frequency", "Percentage" , "  %(NA-)",  "kidn_dx")
mgr5 <- kidn_dx[, c(4,1, 2)]

skipped_mhg5 <- sum(table(mhgroup5$kidn=="Skipped this Question")[2])
mgr5[as.numeric(dim(mgr5)[[1]])+1,] <- c("Skipped this Question", skipped_mhg5, round((skipped_mhg5/dim(data_tib_m1)[[1]])*100,2))



dt_mgr5 <- mgr5 %>%  gt::gt(rowname_col = "row_lab") %>%  
  tab_header(title = md("MHGROUP5: Diagnosed with Kidney Conditions")) %>% 
  cols_label(Frequency= md("**N**"), Percentage=md("**Percentge of Participants**"), kidn_dx = md("**Answer**")) %>% 
  # summary_rows(
  #   column = c(participants,percentage),
  #   fns= list(
  #     Sum= ~sum(.)
  #   ), decimals=0) %>%
  #grand_summary_rows(columns=c(Frequency, Percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = kidn_dx,
    )
  )
tab_footnote(
  dt_mgr5,
  md("As this is a select all question, participants may select multiple responses."),
  locations = cells_column_labels(columns = Percentage),
  placement = c("left")
)

```

```{r MHGroup5Diagn, warning=FALSE, echo=FALSE, message=FALSE}
#MHGROUP5

#cat("Kidney Stones Diagnosis")
kds_a_dg=boxp_funct(D_989016875_D_206625031,"Kidney Stones Age at Diagnosis","Age") 
kds_y_dg=boxp_funct(D_989016875_D_261863326,"Kidney Stones Year of Diagnosis","Year")
grid.arrange(kds_a_dg, kds_y_dg, nrow=2)


#cat("Chronic Kidney Disease (Chronic Kidney Failure) Diagnosis")
chk_a_dg=boxp_funct(D_878094302_D_206625031,"Kidney Disease Age at Diagnosis","Age") 
chk_y_dg=boxp_funct(D_878094302_D_261863326,"Kidney Disease Year of Diagnosis","Year")
grid.arrange(chk_a_dg, chk_y_dg, nrow=2)


```

\newpage

## Systemic and Other Problems
```{r MHGroup6, include=FALSE}
mhgroup6= data_tib_m1 %>%  mutate(sysoth= case_when(D_543728565_D_636030086==1 ~ "Rheumatoid Arthritis", 
                                             D_543728565_D_239687183==1 ~ "Lupus",
                                             D_543728565_D_134592375==1 ~ "Gout",
                                             D_543728565_D_535003378==1 ~ "None",
                                             TRUE ~ "Skipped this Question"))

dt_sysoth_summary <- mhgroup6 %>% dplyr::group_by(sysoth) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(sysoth, n, percentage)


gt_mh6<- dt_sysoth_summary %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("MHGROUP6: Diagnosed with Systemic Conditions")) %>% 
  cols_label(n= md("**N**"), sysoth = md("**Answer**"), percentage = md("**%**")) %>% 
  # summary_rows(
  #   column = c(participants,percentage),
  #   fns= list(
  #     Sum= ~sum(.)
  #   ), decimals=0) %>%
  grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = sysoth,
    )
  ) 




tmp6<- data_tib_m1[, grepl("543728565", colnames(data_tib_m1))]
systm_dx <- NULL
for (i in 1:4){
  dt <- as.data.frame(tab1(tmp6[,i])$output.table)
  dt$systm_dx <- colnames(tmp6)[i]
  systm_dx <- rbind(systm_dx,dt[2,])
  
}
systm_dx$systm_dx
systm_dx$systm_dx <- c("Gout", "Lupus",  "None", "Rheumatoid Arthritis")
```
```{r MHGroup6Table, warning=FALSE, echo=FALSE, message=FALSE}
colnames(systm_dx) <- c("Frequency", "Percentage" , "  %(NA-)",  "systm_dx")
mgr6 <- systm_dx[, c(4,1, 2)]

skipped_mhg6 <- sum(table(mhgroup6$sysoth=="Skipped this Question")[2])
mgr6[as.numeric(dim(mgr6)[[1]])+1,] <- c("Skipped this Question", skipped_mhg6, round((skipped_mhg6/dim(data_tib_m1)[[1]])*100,2))



dt_mgr6 <- mgr6 %>%  gt::gt(rowname_col = "row_lab") %>%  
  tab_header(title = md("MHGROUP6: Diagnosed with Systemic Conditions")) %>% 
  cols_label(Frequency= md("**N**"), Percentage=md("**Percentge of Participants**"), systm_dx = md("**Answer**")) %>% 
  # summary_rows(
  #   column = c(participants,percentage),
  #   fns= list(
  #     Sum= ~sum(.)
  #   ), decimals=0) %>%
  #grand_summary_rows(columns=c(Frequency, Percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = systm_dx,
    )
  )
tab_footnote(
  dt_mgr6,
  md("As this is a select all question, participants may select multiple responses."),
  locations = cells_column_labels(columns = Percentage),
  placement = c("left")
)

```

```{r MHGroup6Diagn, warning=FALSE, echo=FALSE, message=FALSE}
#MHGROUP6 
#cat("Rheumatoid Arthritis Diagnosis")
ra_a_dg=boxp_funct(D_173101988_D_206625031,"Rheumatoid Arthritis Age at Diagnosis","Age") 
ra_y_dg=boxp_funct(D_173101988_D_261863326,"Rheumatoid Arthritis Year of Diagnosis","Year") 
grid.arrange(ra_a_dg, ra_y_dg, nrow=2)


#cat("Lupus Diagnosis")
lup_a_dg=boxp_funct(D_245861186_D_206625031,"Lupus Age at Diagnosis","Age") 
lup_y_dg=boxp_funct(D_245861186_D_261863326,"Lupus Year of Diagnosis","Year") 
grid.arrange(lup_a_dg, lup_y_dg, nrow=2)


#cat("Gout Diagnosis")
gout_a_dg=boxp_funct(D_420423416_D_206625031,"Gout Age at Diagnosis","Age") 
gout_y_dg=boxp_funct(D_420423416_D_261863326,"Gout Year of Diagnosis","Year") 
grid.arrange(gout_a_dg, gout_y_dg, nrow=2)


```

\newpage

## Sexually Transmitted Diseases and Infections
```{r MHGroup7, include=FALSE}
mhgroup7= data_tib_m1 %>%  mutate(sti_std= case_when(D_874709643_D_164910211==1 ~ "Mono",
                                             D_874709643_D_796616844==1 ~ "Shingles",
                                             D_874709643_D_436689514==1 ~ "Chronic Hepatitus B or C",
                                             D_874709643_D_296357383==1 ~ "Gonorrhea",
                                             D_874709643_D_901077233==1 ~ "Chlamydia",
                                             D_874709643_D_136956596==1 ~ "Trich",
                                             D_874709643_D_455776698==1 ~ "Syphilis",
                                             D_874709643_D_155874194==1 ~ "Genital Warts",
                                             D_874709643_D_880962432==1 ~ "HPV",
                                             D_874709643_D_691450854==1 ~ "HIV/AIDS",
                                             D_874709643_D_535003378==1 ~ "None",
                                             TRUE ~ "Skipped this Question"))

dt_sti_std_summary <- mhgroup7 %>% dplyr::group_by(sti_std) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(sti_std, n, percentage)

gt_mh7<- dt_sti_std_summary %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("MHGROUP7: Diagnosed Infections or Diseases")) %>% 
  cols_label(n= md("**N**"), sti_std = md("**Answer**"), percentage = md("**%**")) %>% 
  # summary_rows(
  #   column = c(participants,percentage),
  #   fns= list(
  #     Sum= ~sum(.)
  #   ), decimals=0) %>%
  grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = sti_std,
    )
  ) 



tmp7<- data_tib_m1[, grepl("874709643", colnames(data_tib_m1))]
sti_dx <- NULL
for (i in 1:11){
  dt <- as.data.frame(tab1(tmp7[,i])$output.table)
  dt$sti_dx <- colnames(tmp7)[i]
  sti_dx <- rbind(sti_dx,dt[2,])
  
}
sti_dx$sti_dx
sti_dx$sti_dx <- c("Trich", "Genital Warts", "Mono","Gonorrhea", "Chronic Hepatitus B or C", "Syphilis", "None","HIV/AIDS","Shingles","HPV","Chlamydia")
```
```{r MHGroup7Table, warning=FALSE, echo=FALSE, message=FALSE}
colnames(sti_dx) <- c("Frequency", "Percentage" , "  %(NA-)",  "sti_dx")
mgr7 <- sti_dx[, c(4,1, 2)]

skipped_mhg7 <- sum(table(mhgroup7$sti_std=="Skipped this Question")[2])
mgr7[as.numeric(dim(mgr7)[[1]])+1,] <- c("Skipped this Question", skipped_mhg7, round((skipped_mhg7/dim(data_tib_m1)[[1]])*100,2))



dt_mgr7 <- mgr7 %>%  gt::gt(rowname_col = "row_lab") %>%  
  tab_header(title = md("MHGROUP7: Diagnosed Infections or Diseases")) %>% 
  cols_label(Frequency= md("**N**"), Percentage=md("**Percentge of Participants**"),  sti_dx = md("**Answer**")) %>% 
  # summary_rows(
  #   column = c(participants,percentage),
  #   fns= list(
  #     Sum= ~sum(.)
  #   ), decimals=0) %>%
  #grand_summary_rows(columns=c(Frequency, Percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = sti_dx,
    )
  )

tab_footnote(
  dt_mgr7,
  md("As this is a select all question, participants may select multiple responses."),
  locations = cells_column_labels(columns = Percentage),
  placement = c("left")
)

```

```{r MHGroup7Diagn, warning=FALSE, echo=FALSE, message=FALSE}
#MHGROUP7


#cat("Infectious Mononucleosis (Mono or Kissing Disease) Diagnosis")
mono_a_dg=boxp_funct(D_915230886_D_206625031,"Infectious Mononucleosis Age at Diagnosis","Age") 
mono_y_dg=boxp_funct(D_915230886_D_261863326,"Infectious Mononucleosis Year of Diagnosis","Year")
grid.arrange(mono_a_dg, mono_y_dg, nrow=2)


#cat("Shingles (Herpes Zoster) Diagnosis")
shn_a_dg=boxp_funct(D_530548878_D_206625031,"Shingles Age at Diagnosis","Age") 
shn_y_dg=boxp_funct(D_530548878_D_261863326,"Shingles Year of Diagnosis","Year")
grid.arrange(shn_a_dg, shn_y_dg, nrow=2)


#cat("Chronic Hepatitis B or C Diagnosis")
hepbc_a_dg=boxp_funct(D_469947273_D_206625031,"Chronic Hepatitis B or C Age at Diagnosis","Age") 
hepbc_y_dg=boxp_funct(D_469947273_D_261863326,"Chronic Hepatitis B or C Year of Diagnosis","Year") 
grid.arrange(hepbc_a_dg, hepbc_y_dg, nrow=2)


#cat("Gonorrhea Diagnosis")
gon_a_dg=boxp_funct(D_685735916_D_206625031,"Gonorrhea Age at Diagnosis","Age")  
gon_y_dg=boxp_funct(D_685735916_D_261863326,"Gonorrhea Year of Diagnosis","Year")
grid.arrange(gon_a_dg, gon_y_dg, nrow=2)


#cat("Chlamydia Diagnosis")
chla_a_dg=boxp_funct(D_954405492_D_206625031,"Chlamydia Age at Diagnosis","Age")  
chla_y_dg=boxp_funct(D_954405492_D_261863326,"Chlamydia Year of Diagnosis","Year")
grid.arrange(chla_a_dg, chla_y_dg, nrow=2)


#cat("Trichomoniasis Diagnosis")
trich_a_dg=boxp_funct(D_103397024_D_206625031,"Trichomoniasis Age at Diagnosis","Age")  
trich_y_dg=boxp_funct(D_103397024_D_261863326,"Trichomoniasis Year of Diagnosis","Year")
grid.arrange(trich_a_dg, trich_y_dg, nrow=2)


#cat("Syphilis Diagnosis")
syph_a_dg=boxp_funct(D_931470797_D_206625031,"Syphilis Age at Diagnosis","Age") 
syph_y_dg=boxp_funct(D_931470797_D_261863326,"Syphilis Year of Diagnosis","Year")
grid.arrange(syph_a_dg, syph_y_dg, nrow=2)


#cat("Genital Warts Diagnosis")
wart_a_dg=boxp_funct(D_922524563_D_206625031,"Genital Warts Age at Diagnosis","Age") 
wart_y_dg=boxp_funct(D_922524563_D_261863326,"Genital Warts Year of Diagnosis","Year")
grid.arrange(wart_a_dg, wart_y_dg, nrow=2)


#cat("HPV Diagnosis")
#someone put 18.44 years old and is causing issues with plot, need to remove
module1$D_978485677_D_206625031 = as.numeric(module1$D_978485677_D_206625031)
module1$D_978485677_D_206625031 = round(module1$D_978485677_D_206625031, digits=0)
hpv_a_dg=boxp_funct(D_978485677_D_206625031,"HPV Age at Diagnosis","Age") 
hpv_y_dg=boxp_funct(D_978485677_D_261863326,"HPV Year of Diagnosis","Year")
grid.arrange(hpv_a_dg, hpv_y_dg, nrow=2)


#cat("HIV/AIDS Diagnosis")
hiv_a_dg=boxp_funct(D_523188839_D_206625031,"HIV/AIDS Age at Diagnosis","Age") 
hiv_y_dg=boxp_funct(D_523188839_D_261863326,"HIV/AIDS Year of Diagnosis","Year")
grid.arrange(hiv_a_dg, hiv_y_dg, nrow=2)


```

\newpage

## Urinary and Reproductive System Problems 
```{r MHGroup8, warning=FALSE, echo=FALSE, message=FALSE, include=FALSE}

mhgroup8= data_tib_m1 %>%  mutate(urn_repro= case_when(D_725626004_D_509721537==1 ~ "Uterine Fibroids",
                                             D_725626004_D_863286658==1 ~ "Endometriosis",
                                             D_725626004_D_386524148==1 ~ "Polycystic Ovary System",
                                             D_725626004_D_937208760==1 ~ "Enlarged Prostate",
                                             D_725626004_D_746542057==1 ~ "Fibrocystic Breast or Benign Breast isease",
                                             D_725626004_D_854945381==1 ~ "Ductal Carcinoma in situ",
                                             D_725626004_D_535003378==1 ~ "None",
                                             TRUE ~ "Skipped this Question"))

dt_urn_repro_summary <- mhgroup8 %>% dplyr::group_by(urn_repro) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(urn_repro, n, percentage)

gt_mh8<- dt_urn_repro_summary %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("MHGROUP8: Diagnosed Urinary and Reproductive Problems")) %>% 
  cols_label(n= md("**N**"), urn_repro = md("**Answer**"), percentage = md("**%**")) %>% 
  # summary_rows(
  #   column = c(participants,percentage),
  #   fns= list(
  #     Sum= ~sum(.)
  #   ), decimals=0) %>%
  grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = urn_repro,
    )
  ) 



tmp8<- data_tib_m1[, grepl("725626004", colnames(data_tib_m1))]
urinrp_dx <- NULL
for (i in 1:7){
  dt <- as.data.frame(tab1(tmp8[,i])$output.table)
  dt$urinrp_dx <- colnames(tmp8)[i]
  urinrp_dx <- rbind(urinrp_dx,dt[2,])
  
}
urinrp_dx$urinrp_dx
urinrp_dx$urinrp_dx <- c("Polycystic Ovary System", "Uterine Fibroids", "None", "Fibrocystic Breast or Benign Breast isease","Ductal Carcinoma in situ","Endometriosis","Enlarged Prostate")
```
```{r MHGroup8Table, warning=FALSE, echo=FALSE, message=FALSE}
colnames(urinrp_dx) <- c("Frequency", "Percentage" , "  %(NA-)",  "urinrp_dx")
mgr8 <- urinrp_dx[, c(4,1, 2)]

skipped_mhg8 <- sum(table(mhgroup8$urn_repro=="Skipped this Question")[2])
mgr8[as.numeric(dim(mgr8)[[1]])+1,] <- c("Skipped this Question", skipped_mhg8, round((skipped_mhg8/dim(data_tib_m1)[[1]])*100,2))



dt_mgr8 <- mgr8 %>%  gt::gt(rowname_col = "row_lab") %>%  
  tab_header(title = md("MHGROUP8: Diagnosed Urinary and Reproductive Problems")) %>% 
  cols_label(Frequency= md("**N**"), Percentage=md("**Percentge of Participants**"),  urinrp_dx = md("**Answer**")) %>% 
  # summary_rows(
  #   column = c(participants,percentage),
  #   fns= list(
  #     Sum= ~sum(.)
  #   ), decimals=0) %>%
  #grand_summary_rows(columns=c(Frequency, Percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = urinrp_dx,
    )
  )
tab_footnote(
  dt_mgr8,
  md("As this is a select all question, participants may select multiple responses."),
  locations = cells_column_labels(columns = Percentage),
  placement = c("left")
)



```

```{r MHGroup8Diagn, warning=FALSE, echo=FALSE, message=FALSE}
##Urinary and Reproductive 


#cat("Uterine Fibroid Diagnosis")
utern_a_dg=boxp_funct(D_846786840_D_206625031,"Uterine Fibroid Age at Diagnosis","Age") 
utern_y_dg=boxp_funct(D_846786840_D_261863326,"Uterine Fibroid Year of Diagnosis","Year")
grid.arrange(utern_a_dg, utern_y_dg, nrow=2)


#cat("Endometriosis Diagnosis")
endo_a_dg=boxp_funct(D_423547108_D_206625031,"Endometriosis Age at Diagnosis","Age") 
endo_y_dg=boxp_funct(D_423547108_D_261863326,"Endometriosis Year of Diagnosis","Year")
grid.arrange(endo_a_dg, endo_y_dg, nrow=2)
  #diagnosed with surgery 
endo=round((sum(module1$D_266847650==353358909, na.rm=T)/sum(module1$D_725626004_D_863286658==1, na.rm=T))*100, digits=2)
cat("Proportion of Endometriosis Cases Confirmed with Surgery:", endo, "%")


#cat("Polycystic Ovary System (PCOS) Diagnosis")
pcos_a_dg=boxp_funct(D_852898339_D_206625031,"PCOS Age at Diagnosis","Age") 
pcos_y_dg=boxp_funct(D_852898339_D_261863326,"PCOS Year of Diagnosis","Year")
grid.arrange(pcos_a_dg, pcos_y_dg, nrow=2)


#cat("Enlarged Prostate Diagnosis")
enlg_a_dg=boxp_funct(D_467061940_D_206625031,"Enlarged Prostate Age at Diagnosis","Age") 
enlg_y_dg=boxp_funct(D_467061940_D_261863326,"Enlarged Prostate Year of Diagnosis","Year") 
grid.arrange(enlg_a_dg, enlg_y_dg, nrow=2)


#cat("Fibrocystic Breast Diagnosis")
fib_a_dg=boxp_funct(D_619481697_D_206625031,"Fibrocystic Breast Age at Diagnosis","Age") 
fib_y_dg=boxp_funct(D_619481697_D_261863326,"Fibrocystic Breast Year of Diagnosis","Year") 
grid.arrange(fib_a_dg, fib_y_dg, nrow=2)
  #diagnosed with biopsy
fibro=round((sum(module1$D_134642404==353358909, na.rm=T)/sum(module1$D_725626004_D_746542057==1, na.rm=T))*100, digits=2)
cat("Proportion of Fibrocystic Breast Cases Confirmed with Biopsy:", fibro, "%")


#cat("Ductal Carcinoma in situ(DCIS) Diagnosis")
duct_a_dg=boxp_funct(D_219956652_D_206625031,"DCIS Age at Diagnosis","Age") 
duct_y_dg=boxp_funct(D_219956652_D_261863326,"DCIS Year of Diagnosis","Year") ##why does this have years with decimals?
grid.arrange(duct_a_dg, duct_y_dg, nrow=2)
  #diagnosed with biopsy
ductal=round((sum(module1$D_852236900==353358909, na.rm=T)/sum(module1$D_725626004_D_854945381==1, na.rm=T))*100, digits=2)
cat("Proportion of DCIS Cases Confirmed with Biopsy:", ductal, "%")


```

\newpage

## Depression 
```{r Depress, warning=FALSE, echo=FALSE, message=FALSE}
###Depression
simple_funct(D_347860896, "DEPRESS: Diagnosed with Clinical Depression")
  
depress_a_dg=boxp_funct(D_301414575_D_206625031,"Depression Age at Diagnosis","Age") 
depress_y_dg=boxp_funct(D_301414575_D_261863326,"Depression Year of Diagnosis","Year")
grid.arrange(depress_a_dg, depress_y_dg, nrow=2)

```

\newpage

## Surgery 
```{r MHGroup9, warning=FALSE, echo=FALSE, message=FALSE, include=FALSE}

mhgroup9= data_tib_m1 %>%  mutate(surgery= case_when(D_624179836_D_797189152==1 ~ "Tonsillectomy",
                                             D_624179836_D_633546100==1 ~ "Cholecystectomy",
                                             D_624179836_D_866002271==1 ~ "Appendectomy",
                                             D_624179836_D_118789503==1 ~ "Liposuction",
                                             D_624179836_D_715563991==1 ~ "Gastric Bypass",
                                             D_624179836_D_533491176==1 ~ "Breast Surgery",
                                             D_624179836_D_220755749==1 ~ "Hysterectomy", 
                                             D_624179836_D_465318416==1 ~ "Tubal Ligation",
                                             D_624179836_D_630100221==1 ~ "Oophorectomy",
                                             D_624179836_D_692881833==1 ~ "Salpingectomy",
                                             D_624179836_D_654450030==1 ~ "Vasectomy",
                                             D_624179836_D_532603425==1 ~ "Orchiectomy or Orchidectomy",
                                             D_624179836_D_733236542==1 ~ "Prostatectomy",
                                             D_624179836_D_961987554==1 ~ "Penectomy",
                                             D_624179836_D_535003378==1 ~ "None",
                                             TRUE ~ "Skipped this Question"))

dt_surgery_summary <- mhgroup9 %>% dplyr::group_by(surgery) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(surgery, n, percentage)

gt_mh9<- dt_surgery_summary %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("MHGROUP9: Surgeries Had")) %>% 
  cols_label(n= md("**N**"),surgery = md("**Type**"), percentage = md("**%**")) %>% 
  # summary_rows(
  #   column = c(participants,percentage),
  #   fns= list(
  #     Sum= ~sum(.)
  #   ), decimals=0) %>%
  grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = surgery,
    )
  ) 



tmp9<- data_tib_m1[, grepl("624179836", colnames(data_tib_m1))]
srgy_dx <- NULL
for (i in 1:15){
  dt <- as.data.frame(tab1(tmp9[,i])$output.table)
  dt$srgy_dx <- colnames(tmp9)[i]
  srgy_dx <- rbind(srgy_dx,dt[2,])
  
}
srgy_dx$srgy_dx
srgy_dx$srgy_dx <- c("Liposuction", "Hysterectomy", "Tubal Ligation","Orchiectomy or Orchidectomy","Breast Surgery","None","Oophorectomy","Cholecystectomy","Vasectomy","Salpingectomy","Gastric Bypass","Prostatectomy", "Tonsillectomy","Appendectomy","Penectomy")
```
```{r MHGroup9Table, warning=FALSE, echo=FALSE, message=FALSE}
colnames(srgy_dx) <- c("Frequency", "Percentage" , "  %(NA-)",  "srgy_dx")
mgr9 <- srgy_dx[, c(4,1, 2)]

skipped_mhg8 <- sum(table(mhgroup9$surgery=="Skipped this Question")[2])
mgr9[as.numeric(dim(mgr9)[[1]])+1,] <- c("Skipped this Question", skipped_mhg8, round((skipped_mhg8/dim(data_tib_m1)[[1]])*100,2))


dt_mgr9 <- mgr9 %>%  gt::gt(rowname_col = "row_lab") %>%  
  tab_header(title = md("MHGROUP9: Surgeries Had")) %>% 
  cols_label(Frequency= md("**N**"),  Percentage=md("**Percentge of Participants**"), srgy_dx = md("**Answer**")) %>% 
  # summary_rows(
  #   column = c(participants,percentage),
  #   fns= list(
  #     Sum= ~sum(.)
  #   ), decimals=0) %>%
  #grand_summary_rows(columns=c(Frequency, Percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = srgy_dx,
    )
  )  %>% 
tab_footnote(
    footnote = "As this is a select all question, participants may select multiple responses.",
    locations=cells_column_labels(Percentage)
  ) %>%
  tab_footnote(
    footnote = md("Breast Surgyeries include: Breast implants, Mastopexy, Breast reconstruction, Breast reduction, Breast-Conserving Surgery (BCS), Lumpectomy, Partial Mastectomy, Segmental Mastectomy, Mastectomy, Double Mastectomy, Bilateral Mastectomy, Surgery for a breast abscess, Microdochectomy."),
    locations=cells_column_labels(srgy_dx)
  )

dt_mgr9


```

```{r MHGroup9Diagn, warning=FALSE, echo=FALSE, message=FALSE}
#	Tonsils removed (tonsillectomy)
tonsil_a_sg=boxp_funct(D_367884741_D_206625031,"Age at Tonisllectomy Surgery","Age") 
tonsil_y_sg=boxp_funct(D_367884741_D_261863326,"Year of Tonisllectomy Surgery","Year")
grid.arrange(tonsil_a_sg, tonsil_y_sg, nrow=2)


#	Gallbladder removed (cholecystectomy)
gall_a_sg=boxp_funct(D_178353079_D_206625031,"Age at Cholecystectomy Surgery","Age") 
gall_y_sg=boxp_funct(D_178353079_D_261863326,"Year of Cholecystectomy Surgery","Year")
grid.arrange(gall_a_sg, gall_y_sg, nrow=2)


#	Appendix removed (appendectomy)
apdx_a_sg=boxp_funct(D_550075233_D_206625031,"Age at Appendectomy Surgery","Age") 
apdx_y_sg=boxp_funct(D_550075233_D_261863326,"Year of Appendectomy Surgery","Year")
grid.arrange(apdx_a_sg, apdx_y_sg, nrow=2)


#	Liposuction
lipo_a_sg=boxp_funct(D_860920332_D_206625031,"Age at Liposuction Surgery","Age") 
lipo_y_sg=boxp_funct(D_860920332_D_261863326,"Year of Liposuction Surgery","Year")
grid.arrange(lipo_a_sg, lipo_y_sg, nrow=2)


#	Bariatric surgery (lap band, gastric bypass)
bar_sg_a_sg=boxp_funct(D_986613440_D_206625031,"Age at Gastric Bypass Surgery","Age")
bar_sg_y_sg=boxp_funct(D_986613440_D_261863326,"Year of Gastric Bypass Surgery","Year")
grid.arrange(bar_sg_a_sg, bar_sg_y_sg, nrow=2)
```

```{r BreastSurgery, include=FALSE}

  #type of breast surgery
mhgroup9= data_tib_m1  %>% filter(D_624179836_D_533491176==1) %>%  
  mutate(breast_sg= case_when(D_517307064_D_517307064_D_752953170==1 ~ "Breast Implants",
                                             D_517307064_D_517307064_D_325506683==1 ~ "Mastectomy",
                                             D_517307064_D_517307064_D_335563082==1 ~ "Breast Reconstruction",
                                             D_517307064_D_517307064_D_955881350==1 ~ "Breast Reduction",
                                             D_517307064_D_517307064_D_492902023==1 ~ "Partial Mastectomy",
                                             D_517307064_D_517307064_D_256196714==1 ~ "Mastectomy",
                                             D_517307064_D_517307064_D_802859122==1 ~ "Double Mastectomy", 
                                             D_517307064_D_517307064_D_520432394==1 ~ "Abscess",
                                             D_517307064_D_517307064_D_667901971==1 ~ "Removal of Lactiferous",
                                             (D_517307064_D_517307064_D_807835037==1 | !is.na(D_517307064_D_942347130)) ~ "Other",
                                             D_517307064_D_517307064_D_535003378==1 ~ "None",
                                             TRUE ~ "Skipped this Question"))



tmp_Brst <- data_tib_m1 %>%  filter(data_tib_m1$D_624179836_D_533491176==1)
tmpMC2<- tmp_Brst[, grepl("517307064", colnames(tmp_Brst))]
#tmpMC2$D_517307064_D_942347130 <- ifelse(is.na(tmpMC2$D_517307064_D_942347130), 0, 1)

tmpM2 <- tmpMC2 %>%  select(-"D_517307064_D_942347130", -"D_517307064_D_517307064_D_942347130")

#tmpM2 <- tmpMC2[, c(8,2,3,12,4,1,9, 5, 7, 11, 6)]
Bsurgnc_dx <- NULL
for (i in 1:11){
  dt <- as.data.frame(tab1(tmpM2[,i])$output.table)
  dt$Bsurgnc_dx <- colnames(tmpM2)[i]
  Bsurgnc_dx <- rbind(Bsurgnc_dx,dt[2,])

}


Bsurgnc_dx$Bsurgnc_dx <- c("Breast Implants","Mastectomy","Breast Reconstruction","Breast Reduction","Partial Mastectomy", "Mastectomy", "Double Mastectomy",  "Abscess","Removal of Lactiferous", "Other", "None of the Above")
```

```{r BreastSurgeryTable, warning=FALSE, echo=FALSE, message=FALSE}
colnames(Bsurgnc_dx) <- c("Frequency", "Percentage" , "  %(NA-)",  "Condition")
surgeryBrst <- Bsurgnc_dx[, c(4,1,2)]

skipped_mhg1 <- sum(ifelse(dim(table(mhgroup9$breast_sg=="Skipped this Question"))<2, 0, table(mhgroup9$breast_sg=="Skipped this Question")[2]))
surgeryBrst[as.numeric(dim(surgeryBrst)[[1]])+1,] <- c("Skipped this Question", skipped_mhg1, round((skipped_mhg1/dim(data_tib_m1)[[1]])*100,2))

dt_surgeryBrst <- surgeryBrst %>%  gt::gt(rowname_col = "row_lab") %>%
  tab_header(title = md("BREASTSUR: Types of Breast Surgeries Had")) %>%
  cols_label(Frequency= md("**N**"), Percentage=md("**Percentge of Participants**"),  Condition = md("**Answer**")) %>%
  # summary_rows(
  #   column = c(participants,percentage),
  #   fns= list(
  #     Sum= ~sum(.)
  #   ), decimals=0) %>%
  #grand_summary_rows(columns=c(Frequency, Percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Condition,
    )
  )
tab_footnote(
  dt_surgeryBrst,
  md("As this is a select all question, participants may select multiple responses."),
  locations = cells_column_labels(columns = Percentage),
  placement = c("left")
)



```


```{r BreastSurgYear, warning=FALSE, echo=FALSE, message=FALSE}
#cat("Breast Implants")
implant_a_sg=boxp_funct(D_477690298_D_623218391,"Age at Breats Implants Surgery","Age")
implant_y_sg=boxp_funct(D_477690298_D_802622485,"Year of Breats Implants Surgery","Year")
grid.arrange(implant_a_sg, implant_y_sg, nrow=2)


#cat("Mastopexy")
mastop_a_sg=boxp_funct(D_176453768_D_623218391,"Age at Mastopexy Surgery","Age")
mastop_y_sg=boxp_funct(D_176453768_D_802622485,"Year of Mastopexy Surgery","Year")
grid.arrange(mastop_a_sg, mastop_y_sg, nrow=2)


#cat("Breast Reconstruction")
recon_a_sg=boxp_funct(D_145786416_D_623218391,"Age at Breast Reconstruction Surgery","Age")
recon_y_sg=boxp_funct(D_145786416_D_802622485,"Year of Breast Reconstruction Surgery","Year") 
grid.arrange(recon_a_sg, recon_y_sg, nrow=2)

#cat("Breast Reduction")
reduct_a_sg=boxp_funct(D_287605131_D_623218391,"Age at Breast Reduction Surgery","Age")
reduct_y_sg=boxp_funct(D_287605131_D_802622485,"Year of Breast Reduction Surgery","Year")
grid.arrange(reduct_a_sg, reduct_y_sg, nrow=2)

#cat("Partial Mastectomy")
prtms_a_sg=boxp_funct(D_701157499_D_623218391,"Age at Partial Mastectomy Surgery","Age")
prtms_y_sg=boxp_funct(D_701157499_D_802622485,"Year of Partial Mastectomy Surgery","Year")
grid.arrange(prtms_a_sg, prtms_y_sg, nrow=2)

#cat("Mastectomy")
mastec_a_sg=boxp_funct(D_428639167_D_623218391,"Age at Mastectomy Surgery","Age") 
mastec_y_sg=boxp_funct(D_428639167_D_802622485,"Year of Mastectomy Surgery","Year") 
grid.arrange(mastec_a_sg, mastec_y_sg, nrow=2)

#cat("Double Mastectomy")
dbmas_a_sg=boxp_funct(D_282355641_D_623218391,"Age at Double Mastectomy Surgery","Age")
dbmas_y_sg=boxp_funct(D_282355641_D_802622485,"Year of Double Mastectomy Surgery","Year")
grid.arrange(dbmas_a_sg, dbmas_y_sg, nrow=2)

#cat("Breast Abscess")
abscess_a_sg=boxp_funct(D_539301647_D_623218391,"Age at Breast Abscess Surgery","Age") 
abscess_y_sg=boxp_funct(D_539301647_D_802622485,"Year of Breast Abscess Surgery","Year") 
grid.arrange(abscess_a_sg, abscess_y_sg, nrow=2)

#cat("Lactiferous Surgery")
lact_a_sg=boxp_funct(D_579225381_D_623218391,"Age at Removal of Lactiferous Surgery","Age")
lact_y_sg=boxp_funct(D_579225381_D_802622485,"Year of Removal of Lactiferous Surgery","Year")
grid.arrange(lact_a_sg, lact_y_sg, nrow=2)

#cat("Other Breast Surgery")
othb_a_sg=boxp_funct(D_891214661_D_623218391,"Age at Other Breast Surgery","Age")
othb_y_sg=boxp_funct(D_891214661_D_802622485,"Year of Other Breast Surgery","Year")
grid.arrange(othb_a_sg, othb_y_sg, nrow=2)

#cat("Hysterectomy") 
hyst_a_sg=boxp_funct(D_150352141_D_206625031,"Age at Hysterectomy","Age") 
hyst_y_sg=boxp_funct(D_150352141_D_261863326,"Year of Hysterectomy","Year")
grid.arrange(hyst_a_sg, hyst_y_sg, nrow=2)


#cat("Tubal Ligation")  
tublig_a_sg=boxp_funct(D_122887481_D_206625031,"Age at Tubal Ligation Surgery","Age") 
tublig_y_sg=boxp_funct(D_122887481_D_261863326,"Year of Tubal Ligation Surgery","Year")
grid.arrange(tublig_a_sg, tublig_y_sg, nrow=2)


#cat("Oophorectomy")
  #type
cat(round((sum(module1$D_378892977==333647143, na.rm=T)/sum(module1$D_624179836_D_630100221==1, na.rm=T))*100, digits=2), "% Had One Ovary Removed")
cat(round((sum(module1$D_378892977==109972911, na.rm=T)/sum(module1$D_624179836_D_630100221==1, na.rm=T))*100, digits=2), "% Had Both Ovaries Removed")
cat(round((sum(module1$D_378892977==535003378, na.rm=T)/sum(module1$D_624179836_D_630100221==1, na.rm=T))*100, digits=2), "% Had Neither of These Oophorectomy Types")
  #age/year of surgery
ooph_a_sg=boxp_funct(D_534007917_D_206625031,"Age at Tubal Oophorectomy","Age") 
ooph_y_sg=boxp_funct(D_534007917_D_261863326,"Year of Tubal Oophorectomy","Year")
grid.arrange(ooph_a_sg, ooph_y_sg, nrow=2)


#cat("Salpingectomy") 
  #type
cat(round((sum(module1$D_224791140==448068764, na.rm=T)/sum(module1$D_624179836_D_692881833==1, na.rm=T))*100, digits=2), "% Had One Fallopian Tube Removed")
cat(round((sum(module1$D_224791140==537173119, na.rm=T)/sum(module1$D_624179836_D_692881833==1, na.rm=T))*100, digits=2), "% Had Both Fallopian Tubes Removed")
cat(round((sum(module1$D_224791140==535003378, na.rm=T)/sum(module1$D_624179836_D_692881833==1, na.rm=T))*100, digits=2), "% Had Neither of These Salpingectomy Types")
  #age/year
salp_a_sg=boxp_funct(D_752636038_D_206625031,"Age at Tubal Salpingectomy","Age") 
salp_y_sg=boxp_funct(D_752636038_D_261863326,"Year of Tubal Salpingectomy","Year")
grid.arrange(salp_a_sg, salp_y_sg, nrow=2)


#	Vasectomy 
vasec_a_sg=boxp_funct(D_518750011_D_206625031,"Age at Tubal Vasectomy","Age") 
vasec_y_sg=boxp_funct(D_518750011_D_261863326,"Year of Tubal Vasectomy","Year")
grid.arrange(vasec_a_sg, vasec_y_sg, nrow=2)


#cat("Orchiectomy or Ochidectomy") 
  #type
cat(round((sum(module1$D_946504570==770550588, na.rm=T)/sum(module1$D_624179836_D_532603425==1, na.rm=T))*100, digits=2), "% Had One Testicle Removed")
cat(round((sum(module1$D_946504570==970716952, na.rm=T)/sum(module1$D_624179836_D_532603425==1, na.rm=T))*100, digits=2), "% Had Both Testicles Removed")
cat(round((sum(module1$D_946504570==535003378, na.rm=T)/sum(module1$D_624179836_D_532603425==1, na.rm=T))*100, digits=2), "% Had Neither of These Orchiectomy or Ochidectomy Types")
  #age/year
orch_a_sg=boxp_funct(D_275770221_D_206625031,"Age at Orchiectomy Surgery","Age") 
orch_y_sg=boxp_funct(D_275770221_D_261863326,"Year of Orchiectomy Surgery","Year")
grid.arrange(orch_a_sg, orch_y_sg, nrow=2)


#cat("Prostatectomy") 
  #type
cat(round((sum(module1$D_107060069==524029283, na.rm=T)/sum(module1$D_624179836_D_733236542==1, na.rm=T))*100, digits=2), "% Had Part of Prostate Removed")
cat(round((sum(module1$D_107060069==500023550, na.rm=T)/sum(module1$D_624179836_D_733236542==1, na.rm=T))*100, digits=2), "% Had Whole Prostate Removed")
cat(round((sum(module1$D_107060069==535003378, na.rm=T)/sum(module1$D_624179836_D_733236542==1, na.rm=T))*100, digits=2), "% Had Neither of These Prostatectomy Types")
  #age/year
prost_a_sg=boxp_funct(D_882152987_D_206625031,"Age at Prostatectomy Surgery","Age") 
prost_y_sg=boxp_funct(D_882152987_D_261863326,"Year of Tubal Prostatectomy Surgery","Year") 
grid.arrange(prost_a_sg, prost_y_sg, nrow=2)


#	Penis removed (penectomy) 
penis_a_sg=boxp_funct(D_527057404_D_206625031,"Age at Tubal Penectomy Surgery","Age") 
penis_y_sg=boxp_funct(D_527057404_D_261863326,"Year of Tubal Penectomy Surgery","Year")
grid.arrange(penis_a_sg, penis_y_sg, nrow=2)


```

\newpage

## Blood Transfusion 
```{r BloodTrans, warning=FALSE, echo=FALSE, message=FALSE}
#Ever had a blood transfusion 
simple_funct(D_453252072, "BLDTRANS: Ever have a Blood Transfusion")

#how many
hist_funct(D_795940097, "Number of Blood Transfusions", "Transfusions", "Frequency")

#First transfusion
  ##sum(table(module1$D_406011084_D_206625031)) #age
module1$D_406011084_D_206625031=as.numeric(module1$D_406011084_D_206625031) ##boxplot was having issues with 0 
trans1_a=boxp_funct(D_406011084_D_206625031,"Age at First Blood Transfusion","Age") 
trans1_y=boxp_funct(D_406011084_D_261863326,"Year at First Blood Transfusion","Year") 
grid.arrange(trans1_a, trans1_y, nrow=2)

#Age at last transfusion
  ##sum(table(module1$D_593017220_D_206625031)) #age
trans_a_last=boxp_funct(D_593017220_D_206625031,"Age at Last Blood Transfusion","Age")
trans_y_last=boxp_funct(D_593017220_D_261863326,"Year at Last Blood Transfusion","Year") 
grid.arrange(trans_a_last, trans_y_last, nrow=2)
```

\newpage

# Section 3: General Health 
## Overall 
```{r Overall, warning=FALSE, echo=FALSE, message=FALSE}

data_tib_m1$D_875208305 <- factor(data_tib_m1$D_875208305, levels=c(670680466,565881164,719933364,131550264,138752522, "Skipped this Question"))
simple_funct(D_875208305, "OVERHEALTH: General Health Rating")

```

## Pain 
```{r Pain, warning=FALSE, echo=FALSE, message=FALSE}
##Pain
#Last 3 Months
simple_funct(D_323512813, "PAIN: Felt Physial Pain Most Days of Last 3 Months")

#Scale
data_tib_m1$D_338924834 <- factor(data_tib_m1$D_338924834, levels=c(988858078,156095877,162668459,278139969, 676824724, 512144428, 125674414, 406650257, 700080862, 616621065, "Skipped this Question"))
one_logic_funct(D_338924834, D_323512813, "353358909", "PAIN2: Rank of Pain")


#Affected Work?
data_tib_m1$D_952682839 <- factor(data_tib_m1$D_952682839, levels=c(111520945, 548628123, 597477164, "Skipped this Question"))
one_logic_funct(D_952682839, D_323512813, "353358909", "PAIN2: Rank of Pain")



```

## Height and Weight 
```{r HeightWeight, warning=FALSE, echo=FALSE, message=FALSE}
##Height and weight
#weight
  ##some people put weight in decimals and is causing issues with boxplot
module1$D_746012894=as.numeric(module1$D_746012894) 
module1$D_746012894=round(module1$D_746012894, digits=0)
boxp_funct(D_746012894,"Current Weight","Weight(lbs)")


#height- current
module1$D_114314839_D_340854069=as.numeric(module1$D_114314839_D_340854069)
module1$D_114314839_D_600462977=as.numeric(module1$D_114314839_D_600462977)

in_D_inches= (ifelse(is.na(module1$D_114314839_D_340854069), 0,(module1$D_114314839_D_340854069*12)))+ 
  (ifelse(is.na(module1$D_114314839_D_600462977), 0, (module1$D_114314839_D_600462977))) 
hist_funct(in_D_inches, "Current Height Distribution (converted to inches)", "Inches", "Frequency")


#age at max height
boxp_funct(D_677262300,"Age Adult Height Reached","Age")


#height at 10
levels=c("Shorter than average","About avg", "Taller than average")
simple_funct(D_650399623, "AVEHIGHT: Height at Age 10")

#weight at 10
simple_funct(D_820324171, "AVEWEIGHT: Weight at Age 10")


#Weight over the years 
weight3=boxp_funct(D_724181652,"Weight 3 years ago","Weight")
weight18=boxp_funct(D_912857732_D_821387277,"Weight at 18","Weight")
weight25=boxp_funct(D_912857732_D_121646540,"Weight at 25","Weight")
weight35=boxp_funct(D_912857732_D_950080618,"Weight at 35","Weight")
weight45=boxp_funct(D_912857732_D_407167089,"Weight at 45","Weight")
weight55=boxp_funct(D_912857732_D_503154158,"Weight at 55","Weight")
grid.arrange(weight3, weight18, weight25, nrow=3)
grid.arrange(weight35,weight45, weight55, nrow=3)
```
```{r, warning=FALSE, echo=FALSE, message=FALSE}

###Weight loss-- attempt to make a flag of 5% or more weight loss

# module1$D_912857732_D_821387277 <- as.numeric(module1$D_912857732_D_821387277)
# module1$D_912857732_D_121646540 <- as.numeric(module1$D_912857732_D_121646540)
# module1$D_912857732_D_950080618 <- as.numeric(module1$D_912857732_D_950080618)
# module1$D_912857732_D_407167089 <- as.numeric(module1$D_912857732_D_407167089)
# module1$D_912857732_D_503154158 <- as.numeric(module1$D_912857732_D_503154158)


###### These are all mathematically producing 0, meaning no one lost 5%+ or weight. That's not true


# weight_loss25= module1 %>% filter(!is.na(module1$D_912857732_D_121646540) & !is.na(module1$D_912857732_D_821387277))   
# for (i in 1:nrow(weight_loss25)){
#   weight_loss25 %>% mutate(weight1825= ifelse(((abs(weight_loss25$D_912857732_D_121646540[[i]] - weight_loss25$D_912857732_D_821387277[[i]]))/weight_loss25$D_912857732_D_821387277[[i]])>(0.05), 1, 0))
# }    
# sum(weight_loss25$weight1825)
# for (i in 1:nrow(weight_loss25)){
#   weight_loss25 %>% mutate(weight1825= ifelse(((weight_loss25$D_912857732_D_821387277[[i]]*0.95)> weight_loss25$D_912857732_D_121646540[[i]]), 1, 0))
# }    
# sum(weight_loss25$weight1825)
# 
# weight_loss35= module1 %>% filter(!is.na(module1$D_912857732_D_121646540) & !is.na(module1$D_912857732_D_950080618))   
# for (i in 1:nrow(weight_loss35)){
#   weight_loss35 %>% mutate(weight2535= ifelse((((weight_loss35$D_912857732_D_950080618[[i]] - weight_loss35$D_912857732_D_121646540[[i]])*-1)/weight_loss35$D_912857732_D_121646540[[i]])>(0.05), 1, 0))
# }    
# sum(weight_loss35$weight2535)
# for (i in 1:nrow(weight_loss35)){
#   weight_loss35 %>% mutate(weight2535= ifelse(((weight_loss35$D_912857732_D_821387277[[i]]*0.95)> weight_loss35$D_912857732_D_121646540[[i]]), 1, 0))
# }    
# sum(weight_loss35$weight2535)
# 
# weight_loss45= module1 %>% filter(!is.na(module1$D_912857732_D_407167089) & !is.na(module1$D_912857732_D_950080618))   
# for (i in 1:nrow(weight_loss45)){
#   weight_loss45 %>% mutate(weight3545= ifelse((((weight_loss45$D_912857732_D_407167089[[i]] - weight_loss45$D_912857732_D_950080618[[i]])*-1)/weight_loss45$D_912857732_D_950080618[[i]])>(0.05), 1, 0))
# }    
# sum(weight_loss45$weight3545)
# 
# weight_loss55= module1 %>% filter(!is.na(module1$D_912857732_D_407167089) & !is.na(module1$D_912857732_D_503154158))   
# for (i in 1:nrow(weight_loss55)){
#   weight_loss55 %>% mutate(weight4555= ifelse((((weight_loss55$D_912857732_D_503154158[[i]] - weight_loss55$D_912857732_D_407167089[[i]])*-1)/weight_loss55$D_912857732_D_407167089[[i]])>(0.05), 1, 0))
# }    
# sum(weight_loss55$weight4555)
# 
# 



data_tib_m1$D_912857732_D_821387277 <- as.numeric(data_tib_m1$D_912857732_D_821387277, na.rm=T)
data_tib_m1$D_912857732_D_121646540 <- as.numeric(data_tib_m1$D_912857732_D_121646540, na.rm=T)
data_tib_m1$D_912857732_D_950080618 <- as.numeric(data_tib_m1$D_912857732_D_950080618, na.rm=T)
data_tib_m1$D_912857732_D_407167089 <- as.numeric(data_tib_m1$D_912857732_D_407167089, na.rm=T)
data_tib_m1$D_912857732_D_503154158 <- as.numeric(data_tib_m1$D_912857732_D_503154158, na.rm=T)


data_tib_m1$diff25 <- (data_tib_m1$D_912857732_D_121646540-data_tib_m1$D_912857732_D_821387277)/data_tib_m1$D_912857732_D_821387277
data_tib_m1$diff25 <- (data_tib_m1$D_912857732_D_121646540-data_tib_m1$D_912857732_D_821387277)/data_tib_m1$D_912857732_D_821387277

data_tib_m1$diff35 <- (data_tib_m1$D_912857732_D_950080618-data_tib_m1$D_912857732_D_121646540)/data_tib_m1$D_912857732_D_121646540
data_tib_m1$diff45 <- (data_tib_m1$D_912857732_D_407167089-data_tib_m1$D_912857732_D_950080618)/data_tib_m1$D_912857732_D_950080618
data_tib_m1$diff55 <- (data_tib_m1$D_912857732_D_503154158-data_tib_m1$D_912857732_D_407167089)/data_tib_m1$D_912857732_D_407167089






WGT1825= data_tib_m1 %>%  filter(diff25<(-0.05)) %>%  mutate(meds= case_when(D_808806810==353358909 ~ "Yes",
                                                   D_808806810==104430631 ~ "No",
                                                   TRUE ~ "Skipped this Question"))


WGT1825_summary <- WGT1825 %>% group_by(meds) %>%   dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(meds, n, percentage)


WGT1825_summary %>%  gt::gt() %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Weight Loss Between 18-25 Years Old Purposeful")) %>% 
  cols_label(n= md("**N**"), meds = md("**Answer**"), percentage = md("**%**")) %>% 
  # summary_rows(
  #   column = c(n,percentage),
  #   fns= list(
  #     Sum= ~sum(.)
  #   ), decimals=0) %>%
  grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
    stub.font.weight = "bold"
  ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = meds,
    )
  ) 


# #weight loss (25-35) on purpose?
# simple_funct(D_803129396, "Weight Loss Between 18-25 Years Old Purposeful")

WGT2535= data_tib_m1 %>%  filter(diff35<(-0.05)) %>%  mutate(meds= case_when(D_803129396==353358909 ~ "Yes",
                                                   D_803129396==104430631 ~ "No",
                                                   TRUE ~ "Skipped this Question"))


WGT2535_summary <- WGT2535 %>% group_by(meds) %>%   dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(meds, n, percentage)


WGT2535_summary %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Weight Loss Between 25-35 Years Old Purposeful")) %>% 
  cols_label(n= md("**N**"), meds = md("**Answer**"), percentage = md("**%**")) %>% 
  # summary_rows(
  #   column = c(n,percentage),
  #   fns= list(
  #     Sum= ~sum(.)
  #   ), decimals=0) %>%
  grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
    stub.font.weight = "bold"
  ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = meds,
    )
  ) 


# #weight loss (35-45) on purpose?
# simple_funct(D_183572295, "Weight Loss Between 18-25 Years Old Purposeful")

WGT3545= data_tib_m1 %>%  filter(diff45<(-0.05)) %>%  mutate(meds= case_when(D_183572295==353358909 ~ "Yes",
                                                   D_183572295==104430631 ~ "No",
                                                   TRUE ~ "Skipped this Question"))


WGT3545_summary <- WGT3545 %>% group_by(meds) %>%   dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(meds, n, percentage)


WGT3545_summary %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Weight Loss Between 35-45 Years Old Purposeful")) %>% 
  cols_label(n= md("**N**"), meds = md("**Answer**"), percentage = md("**%**")) %>% 
  # summary_rows(
  #   column = c(n,percentage),
  #   fns= list(
  #     Sum= ~sum(.)
  #   ), decimals=0) %>%
  grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
    stub.font.weight = "bold"
  ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = meds,
    )
  ) 


# #weight loss (45-55) on purpose?
# simple_funct(D_837402132, "Weight Loss Between 18-25 Years Old Purposeful")

WGT4555= data_tib_m1 %>%  filter(diff55<(-0.05)) %>%  mutate(meds= case_when(D_837402132==353358909 ~ "Yes",
                                                   D_837402132==104430631 ~ "No",
                                                   TRUE ~ "Skipped this Question"))


WGT4555_summary <- WGT4555 %>% group_by(meds) %>%   dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(meds, n, percentage)


WGT4555_summary %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Weight Loss Between 45-55 Years Old Purposeful")) %>% 
  cols_label(n= md("**N**"), meds = md("**Answer**"), percentage = md("**%**")) %>% 
  # summary_rows(
  #   column = c(n,percentage),
  #   fns= list(
  #     Sum= ~sum(.)
  #   ), decimals=0) %>%
  grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
    stub.font.weight = "bold"
  ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = meds,
    )
  ) 


#how did you lose the weight 18-25? ------------------------- have to wait for correct denomination when Tony adds the missing flag variables 
# weight_loss= module1 %>% filter(!is.na(module1$D_912857732_D_121646540)) & !is.na(module1$D_912857732_D_821387277) %>%  mutate(weight1825= for (i in 1:length(weight_loss)){
#   ifelse((((module1$D_912857732_D_121646540 - module1$D_912857732_D_821387277)*-1)/module1$D_912857732_D_121646540[[i]])>(0.05), 1, 0)})   ##should I instead create 
# weight_loss$weight1825

dt_wt1825= data_tib_m1  %>%  filter(diff25<(-0.05)) # & D_514996698=="353358909"

dt_wt1825= dt_wt1825  %>%  mutate(multc1 = ifelse(D_207025341_D_207025341_D_934037640==1, 1, 0) + ifelse(D_207025341_D_207025341_D_990501908==1, 1, 0) + ifelse(D_207025341_D_207025341_D_691423127==1, 1, 0) + ifelse(D_207025341_D_207025341_D_203773667==1, 1, 0) + ifelse(D_207025341_D_207025341_D_862170896==1, 1, 0) + ifelse(D_207025341_D_207025341_D_448594163==1, 1, 0) + ifelse(D_207025341_D_207025341_D_807835037==1, 1, 0))

method= dt_wt1825  %>%  mutate(weight= case_when(as.numeric(multc1)>1  ~ "Multiple Methods",
                                                 D_207025341_D_207025341_D_934037640==1 ~ "Changed Diet",
                                                 D_207025341_D_207025341_D_990501908==1 ~ "Exercised",
                                                 D_207025341_D_207025341_D_691423127==1 ~ "Skipped Meals",
                                                 D_207025341_D_207025341_D_203773667==1 ~ "Surgery",
                                                 D_207025341_D_207025341_D_862170896==1 ~ "Diet Pills",
                                                 D_207025341_D_207025341_D_448594163==1 ~ "Smoking", 
                                                 (D_207025341_D_207025341_D_807835037==1 | !is.na(D_207025341_D_155535868)) ~ "Other Method",
                                                 TRUE ~ "Skipped this Question"))
method$weight <- factor(method$weight,levels=c("Multiple Methods","Changed Diet", "Exercised","Skipped Meals","Surgery","Diet Pills","Smoking", "Other Method","Skipped this Question"))


dt_wt1825_summary <- method %>% dplyr::group_by(weight) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(weight, n, percentage) 

dt_wt1825_summary %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("WTLOSS2_1825: Method of Weight Loss Ages 18-25")) %>% 
  cols_label(n= md("**N**"), weight = md("**Answer**"), percentage = md("**%**")) %>% 
  # summary_rows( groups=F,
  # column = c(n,percentage),
  # fns= list(
  #   Sum= ~sum(.)
  # ), decimals=0) %>%
  grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
    stub.font.weight = "bold"
  ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = weight,
    )
  ) 



#how did you lose the weight 25-35? 
dt_wt2535= data_tib_m1 %>%  filter(diff35<(-0.05)) #& D_194396716=="353358909"

dt_wt2535= dt_wt2535  %>%  mutate(multc1 = ifelse(D_827393644_D_827393644_D_934037640==1, 1, 0) + ifelse(D_827393644_D_827393644_D_990501908==1, 1, 0) + ifelse(D_827393644_D_827393644_D_691423127==1, 1, 0) + ifelse(D_827393644_D_827393644_D_203773667==1, 1, 0) + ifelse(D_827393644_D_827393644_D_862170896==1, 1, 0) + ifelse(D_827393644_D_827393644_D_448594163==1, 1, 0) + ifelse(D_827393644_D_827393644_D_807835037==1, 1, 0)) 

method= dt_wt2535  %>%  mutate(weight= case_when(as.numeric(multc1)>1  ~ "Multiple Methods",
                                                 D_827393644_D_827393644_D_934037640==1 ~ "Changed Diet",
                                                 D_827393644_D_827393644_D_990501908==1 ~ "Exercised",
                                                 D_827393644_D_827393644_D_691423127==1 ~ "Skipped Meals",
                                                 D_827393644_D_827393644_D_203773667==1 ~ "Surgery",
                                                 D_827393644_D_827393644_D_862170896==1 ~ "Diet Pills",
                                                 D_827393644_D_827393644_D_448594163==1 ~ "Smoking", 
                                                 (D_827393644_D_827393644_D_807835037==1 | !is.na(D_827393644_D_899840609)) ~ "Other Method",
                                                 TRUE ~ "Skipped this Question"))
method$weight <- factor(method$weight,levels=c("Multiple Methods","Changed Diet", "Exercised","Skipped Meals","Surgery","Diet Pills","Smoking", "Other Method","Skipped this Question"))

dt_wt2535_summary <- method %>% dplyr::group_by(weight) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(weight, n, percentage) 

dt_wt2535_summary %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("WTLOSS2_2535: Method of Weight Loss Ages 25-35")) %>% 
  cols_label(n= md("**N**"), weight = md("**Answer**"), percentage = md("**%**")) %>% 
  grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
    stub.font.weight = "bold"
  ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = weight,
    )
  ) 



#how did you lose the weight 35-45?
dt_wt3545= data_tib_m1   %>%  filter(diff45<(-0.05)) #& D_649776532=="353358909"

dt_wt3545= dt_wt3545  %>%  mutate(multc1 = ifelse(D_630675760_D_630675760_D_934037640==1, 1, 0) + ifelse(D_630675760_D_630675760_D_990501908==1, 1, 0) + ifelse(D_630675760_D_630675760_D_691423127==1, 1, 0) + ifelse(D_630675760_D_630675760_D_203773667==1, 1, 0) + ifelse(D_630675760_D_630675760_D_862170896==1, 1, 0) + ifelse(D_630675760_D_630675760_D_448594163==1, 1, 0) + ifelse(D_630675760_D_630675760_D_807835037==1, 1, 0))

method= dt_wt3545  %>%  mutate(weight= case_when(as.numeric(multc1)>1  ~ "Multiple Methods",
                                                 D_630675760_D_630675760_D_934037640==1 ~ "Changed Diet",
                                                 D_630675760_D_630675760_D_990501908==1 ~ "Exercised",
                                                 D_630675760_D_630675760_D_691423127==1 ~ "Skipped Meals",
                                                 D_630675760_D_630675760_D_203773667==1 ~ "Surgery",
                                                 D_630675760_D_630675760_D_862170896==1 ~ "Diet Pills",
                                                 D_630675760_D_630675760_D_448594163==1 ~ "Smoking", 
                                                 (D_630675760_D_630675760_D_807835037==1 | !is.na(D_630675760_D_660541817)) ~ "Other Method",
                                                 TRUE ~ "Skipped this Question"))
method$weight <- factor(method$weight,levels=c("Multiple Methods","Changed Diet", "Exercised","Skipped Meals","Surgery","Diet Pills","Smoking", "Other Method","Skipped this Question"))

dt_wt3545_summary <- method %>% dplyr::group_by(weight) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(weight, n, percentage) 

dt_wt3545_summary %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("WTLOSS2_3545: Method of Weight Loss Ages 35-45")) %>% 
  cols_label(n= md("**N**"), weight = md("**Answer**"), percentage = md("**%**")) %>% 
  # summary_rows( groups=F,
  # column = c(n,percentage),
  # fns= list(
  #   Sum= ~sum(.)
  # ), decimals=0) %>%
  grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
    stub.font.weight = "bold"
  ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = weight,
    )
  ) 




#how did you lose the weight 45-55?
dt_wt4555= data_tib_m1  %>%  filter(diff55<(-0.05)) #& D_221338826=="353358909"

dt_wt4555= dt_wt4555  %>%  mutate(multc1 = ifelse(D_827393644_D_827393644_D_934037640==1, 1, 0) + ifelse(D_827393644_D_827393644_D_990501908==1, 1, 0) + ifelse(D_827393644_D_827393644_D_691423127==1, 1, 0) + ifelse(D_827393644_D_827393644_D_203773667==1, 1, 0) + ifelse(D_827393644_D_827393644_D_862170896==1, 1, 0) + ifelse(D_827393644_D_827393644_D_448594163==1, 1, 0) + ifelse(D_827393644_D_827393644_D_807835037==1, 1, 0))

method= dt_wt4555  %>%  mutate(weight= case_when(as.numeric(multc1)>1  ~ "Multiple Methods",
                                                 D_431628922_D_431628922_D_934037640==1 ~ "Changed Diet",
                                                 D_431628922_D_431628922_D_990501908==1 ~ "Exercised",
                                                 D_431628922_D_431628922_D_691423127==1 ~ "Skipped Meals",
                                                 D_431628922_D_431628922_D_203773667==1 ~ "Surgery",
                                                 D_431628922_D_431628922_D_862170896==1 ~ "Diet Pills",
                                                 D_431628922_D_431628922_D_448594163==1 ~ "Smoking", 
                                                 (D_431628922_D_431628922_D_807835037==1 | !is.na(D_431628922_D_963867920)) ~ "Other Method",
                                                 TRUE ~ "Skipped this Question"))
method$weight <- factor(method$weight,levels=c("Multiple Methods","Changed Diet", "Exercised","Skipped Meals","Surgery","Diet Pills","Smoking", "Other Method","Skipped this Question"))

dt_wt4555_summary <- method %>%  dplyr::group_by(weight) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(weight, n, percentage) 

dt_wt4555_summary %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("WTLOSS2_4555: Method of Weight Loss Ages 45-55")) %>% 
  cols_label(n= md("**N**"), weight = md("**Answer**"), percentage = md("**%**")) %>% 
  # summary_rows( groups=F,
  # column = c(n,percentage),
  # fns= list(
  #   Sum= ~sum(.)
  # ), decimals=0) %>%
  grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
    stub.font.weight = "bold"
  ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = weight,
    )
  ) 

#where do you carry your body weight 

location= data_tib_m1  %>%  mutate(weight= case_when(D_936904328_D_245893583==1 & D_936904328_D_506790433==1 & D_936904328_D_601057066==1 ~ "In All Locations",
                                                     D_936904328_D_245893583==1 & D_936904328_D_506790433==1 ~ "Chest & Waist",
                                                     D_936904328_D_245893583==1 & D_936904328_D_601057066==1 ~ "Chest & Hips",
                                                     D_936904328_D_506790433==1 & D_936904328_D_601057066==1 ~ "Waist & Hips",
                                                     D_936904328_D_245893583==1 ~ "Chest/Shoulders",
                                                     D_936904328_D_506790433==1 ~ "Waist/Stomach",
                                                     D_936904328_D_601057066==1 ~ "Hips/Thigh",
                                                     TRUE ~ "Skipped this Question"))
location$weight <- factor(location$weight,levels=c( "Chest/Shoulders","Waist/Stomach", "Hips/Thigh",  "Chest & Waist", "Chest & Hips","Waist & Hips","In All Locations", "Skipped this Question"))

dt_wt_carry_summary <- location %>% dplyr::group_by(weight) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(weight, n, percentage) 

dt_wt_carry_summary %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("CARWEIGHT: Location of Carrying Body Weight")) %>% 
  cols_label(n= md("**N**"), weight = md("**Body Part(s)**"), percentage = md("**%**")) %>% 
    # summary_rows( groups=F,
    # column = c(n,percentage),
    # fns= list(
    #   Sum= ~sum(.)
    # ), decimals=0) %>%
  grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = weight,
    )
  ) 


#shorter now than 20s/30s?
simple_funct(D_848580651, "SHORTER: Shorter now than 20's and 30's")


#how much shorter?
module1 %>% mutate(D_207494582=as.numeric(as.character(D_207494582))) %>%
    filter(!is.na(D_207494582)) %>%
    ggplot(aes(x=D_207494582))+
     xlab("Inches") + ylab("Frequency") + geom_histogram()+  ggtitle("How much shorter than 20s/30s","Height (in)")+
    geom_histogram(color="black")+ scale_y_continuous(breaks=pretty_breaks()) +
    geom_vline(aes(xintercept=mean(D_207494582, na.rm=T)), colour="#2973A5", linetype="solid")


```


## Hair Patern 
### Feamle Hair Pattern 
```{r HairFem, warning=FALSE, echo=FALSE, message=FALSE}


#Female
data_tib_m1$D_365851428 <- factor(data_tib_m1$D_365851428, levels=c(927925620,552278254,267104669,619337179,601381820,151394571,917379905,746328729,452963767, "Skipped this Question"))
one_logic_funct(D_365851428, D_407056417, "536341288" ,"Level of Hair Loss (Female)")




```



### Male Hair Pattern 
```{r HairMale, warning=FALSE, echo=FALSE, message=FALSE}

data_tib_m1$D_206319592 <- factor(data_tib_m1$D_206319592, levels=c(927925620,629452816,915557297,103565678,381878591,446794016,526238862,173625583,782282163,693010445,732008197,734998477, "Skipped this Question"))
one_logic_funct(D_206319592, D_407056417, "654207589" ,"Level of Hair Loss (Male)")


```

### Hair Thinning Medications
```{r HairMeds, warning=FALSE, echo=FALSE, message=FALSE}
#Taken meds for hair thinning?
simple_funct(D_769668224, "HRMED: Ever Taken Hair Thinning Medication")
```

```{r HMedsType, include=FALSE}

#What type?
dt_hrmed_typ= data_tib_m1   %>%  filter(D_769668224==353358909)  

brand= dt_hrmed_typ  %>%  mutate(med= case_when(D_814664694_D_814664694_D_903825143==1 ~ "Rogaine, Minoxidil, or Ioniten",
                                                D_814664694_D_814664694_D_567365088==1 ~ "Finasteride",
                                                (D_814664694_D_814664694_D_807835037==1 | !is.na(D_814664694_D_787193493)) ~ "Other",
                                                TRUE ~ "Skipped this Question"))



tmp_hrm2 <- data_tib_m1 %>%  filter(data_tib_m1$D_769668224==353358909)
tmp_hr2<- tmp_hrm2[, grepl("814664694", colnames(tmp_hrm2))]

tmpM2 <- tmp_hr2 %>%  select(-"D_814664694_D_787193493", -"D_814664694_D_814664694_D_787193493")
#tmpM2 <- tmp_hr2[, c(5, 2, 4)]
hrm2_dx <- NULL
for (i in 1:3){
  dt <- as.data.frame(tab1(tmpM2[,i])$output.table)
  dt$hrm2_dx <- colnames(tmpM2)[i]
  hrm2_dx <- rbind(hrm2_dx,dt[2,])

}


hrm2_dx$hrm2_dx <- c("Rogaine, Minoxidil, or Ioniten","Finasteride","Other")
```

```{r HairMedTable, warning=FALSE, echo=FALSE, message=FALSE}
colnames(hrm2_dx) <- c("Frequency", "Percentage" , "  %(NA-)",  "Condition")
hrm2 <- hrm2_dx[, c(4,1,2)]

skipped_mhg1 <- sum(table(brand$med=="Skipped this Question")[2])
hrm2[as.numeric(dim(hrm2)[[1]])+1,] <- c("Skipped this Question", skipped_mhg1, round((skipped_mhg1/dim(data_tib_m1)[[1]])*100,2))

dt_hrm2 <- hrm2 %>%  gt::gt(rowname_col = "row_lab") %>%
  tab_header(title = md("HRMED2: Type of Hair Thinning Medication")) %>%
  cols_label(Frequency= md("**N**"), Percentage=md("**Percentge of Participants**"),  Condition = md("**Answer**")) %>%
  # summary_rows(
  #   column = c(participants,percentage),
  #   fns= list(
  #     Sum= ~sum(.)
  #   ), decimals=0) %>%
  #grand_summary_rows(columns=c(Frequency, Percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Condition,
    )
  )
tab_footnote(
  dt_hrm2,
  md("As this is a select all question, participants may select multiple responses."),
  locations = cells_column_labels(columns = Percentage),
  placement = c("left")
)






#Hair thinning med time
hairthin1=boxp_funct(D_109544008,"Age Hair Thinning Medication First Used","Age")
hairthin0=boxp_funct(D_186831207,"Age Hair Thinning Medication Last Used","Age")
grid.arrange(hairthin1, hairthin0, nrow=2)

```


## Acne 
```{r Acne, warning=FALSE, echo=FALSE, message=FALSE}
##Acne
#See doctor for severe/ongoing acne?
simple_funct(D_283634623, "ACNE: Ever Seen a Doctor for Severe Acne")

#How old at first visit?
boxp_funct(D_164752169,"Age Doctor Visited for Acne","Age")

#Used prescription meds?
one_logic_funct(D_512167179, D_283634623, 353358909, "ACNEMED: Ever Taken Medication for Severe Acne")


#Acne meds timeframe
acne1=boxp_funct(D_509933065,"Age Meds First Used to Treat Acne","Age")
acne0=boxp_funct(D_967093163,"Age Meds Last Used to Treat Acne","Age")
grid.arrange(acne1, acne0, nrow=2)

```

\newpage

# Section 4: Family History
## Adopted, Fostered, Multiple Birth 
```{r Section4, warning=FALSE, echo=FALSE, message=FALSE}
#Foster/Adopted
simple_funct(D_535621923, "ADOPTFOST: Adopted or Foster Child")


#Twin/multiple
simple_funct(D_992987417, "MULTBIRTH: A Twin or Multiple")

```


## Mom 
```{r Mom, warning=FALSE, echo=FALSE, message=FALSE}
##Mom
#living
simple_funct(D_170440011, "MOM1: Mother Living")

#age now
one_logic_funct(D_354326265_D_354326265, D_170440011, 353358909, "Answer for Mother's Current Age")
boxp_funct(D_354326265_D_378988419,"Mother's Current Age","Age")


#age at deaths
  #once I have concatenated age come back and do a barplot sectioned off by age
one_logic_funct(D_422714611_D_422714611, D_170440011, 104430631, "Answer for Mother's Age at Death")
boxp_funct(D_422714611_D_807765962,"Mother's Age at Death","Age")


#cancer? 
simple_funct(D_276353712, "MOMCANC: Mother Diagnosed with Cancer")
```


```{r MomCanc, include=FALSE}

dt_mom_cnc= data_tib_m1 %>% filter(D_276353712==353358909) 

momcnc= dt_mom_cnc  %>%  mutate(multc = ifelse(D_814510313_D_814510313_D_939782495==1, 1, 0) + ifelse(D_814510313_D_814510313_D_135725957==1, 1, 0) + ifelse(D_814510313_D_814510313_D_518416174==1, 1, 0) + ifelse(D_814510313_D_814510313_D_847945207==1, 1, 0) + ifelse(D_814510313_D_814510313_D_283025574==1, 1, 0) + ifelse(D_814510313_D_814510313_D_942970912==1, 1, 0) + ifelse(D_814510313_D_814510313_D_596122041==1, 1, 0) + ifelse(D_814510313_D_814510313_D_489400183==1, 1, 0) + ifelse(D_814510313_D_814510313_D_863246236==1, 1, 0) + ifelse(D_814510313_D_814510313_D_607793249==1, 1, 0) + ifelse(D_814510313_D_814510313_D_532172400==1, 1, 0) + ifelse(D_814510313_D_814510313_D_754745617==1, 1, 0) + ifelse(D_814510313_D_814510313_D_665036297==1, 1, 0) + ifelse(D_814510313_D_814510313_D_200837530==1, 1, 0) +  ifelse(D_814510313_D_814510313_D_990319383==1, 1, 0) + ifelse(D_814510313_D_814510313_D_603181162==1, 1, 0) + ifelse(D_814510313_D_814510313_D_482225200==1, 1, 0) + ifelse(D_814510313_D_814510313_D_764891959==1, 1, 0) + ifelse(D_814510313_D_814510313_D_139822395==1, 1, 0) + ifelse(D_814510313_D_814510313_D_487917585==1, 1, 0) + ifelse(D_814510313_D_814510313_D_723614811==1, 1, 0) + ifelse(D_814510313_D_814510313_D_807835037==1, 1, 0) + ifelse(D_814510313_D_814510313_D_178420302==1, 1, 0) )

momcnc= momcnc  %>%  mutate(cancer= case_when(as.numeric(multc)>1 ~ "Multiple Cancer Types",
                                              D_814510313_D_814510313_D_939782495==1 ~ "Anal",
                                             D_814510313_D_814510313_D_135725957==1 ~ "Bladder",
                                             D_814510313_D_814510313_D_518416174==1 ~ "Brain",
                                             D_814510313_D_814510313_D_847945207==1 ~ "Breast",
                                             D_814510313_D_814510313_D_283025574==1 ~ "Cervical",
                                             D_814510313_D_814510313_D_942970912==1 ~ "Colon/Rectal",
                                             D_814510313_D_814510313_D_596122041==1 ~ "Esophageal",
                                             D_814510313_D_814510313_D_489400183==1 ~ "Head, Neck, and Shoulders",
                                             D_814510313_D_814510313_D_863246236==1 ~ "Kidney",
                                             D_814510313_D_814510313_D_607793249==1 ~ "Leukemia",
                                             D_814510313_D_814510313_D_532172400==1 ~ "Liver",
                                             D_814510313_D_814510313_D_754745617==1 ~ "Lung",
                                             D_814510313_D_814510313_D_665036297==1 ~ "Non-Hodgkin's Lymphoma",
                                             D_814510313_D_814510313_D_200837530==1 ~ "Lymphoma",
                                             D_814510313_D_814510313_D_990319383==1 ~ "Melanoma Skin",
                                             D_814510313_D_814510313_D_487917585==1 ~ "Non-Melanoma Skin",
                                             D_814510313_D_814510313_D_603181162==1 ~ "Ovarian",
                                             D_814510313_D_814510313_D_482225200==1 ~ "Pancreatic",
                                             D_814510313_D_814510313_D_764891959==1 ~ "Stomach",
                                             D_814510313_D_814510313_D_139822395==1 ~ "Thyroid",
                                             D_814510313_D_814510313_D_723614811==1 ~ "Uterine",
                                             (D_814510313_D_814510313_D_807835037==1 | !is.na(D_814510313_D_677702321)) ~ "Other",
                                             D_814510313_D_814510313_D_178420302==1 ~ "Unknown",
                                             TRUE ~ "Skipped this Question"))


tmpMOMCANC <- data_tib_m1 %>%  filter(data_tib_m1$D_276353712==353358909)
tmpMC2<- tmpMOMCANC[, grepl("814510313", colnames(tmpMOMCANC))]
#tmpMC2$D_814510313_D_677702321 <- ifelse(is.na(tmpMC2$D_814510313_D_677702321), 0, 1)


tmpM2 <- tmpMC2 %>%  select(-"D_814510313_D_677702321")
momcnc_dx <- NULL
for (i in 1:23){
  dt <- as.data.frame(tab1(tmpM2[,i])$output.table)
  dt$momcnc_dx <- colnames(tmpM2)[i]
  momcnc_dx <- rbind(momcnc_dx,dt[2,])

}



#momcnc_dx$momcnc_dx 

#momcnc_dx$momcnc_dx <- c("Other specified", "Pergonal", "hCG", "Nolvadex", "Seophene", "Danocrine", "Lupron depot", "Milophene", "None of the above", "Clomid", "Danazol", "Gonadotropins", "Synarel nasal solution", "Other specified-double nested", "Other Medication")
momcnc_dx$momcnc_dx <- c("Anal", "Bladder", "Brain", "Breast", "Cervical", "Colon/Rectal", "Esophageal", "Head, Neck and Shoulders", "Kidney", "Leukemia", "Liver", "Lung", "Non-Hodgkin's Lymphoma", "Lymphoma", "Melanoma", "Non-Melanoma Skin", "Ovarian", "Pancreatic", "Stomach", "Thyroid", "Uterine", "Other", "Unknown")
```

```{r MomCancTable, warning=FALSE, echo=FALSE, message=FALSE}
colnames(momcnc_dx) <- c("Frequency", "Percentage" , "  %(NA-)",  "Condition")
mgr1 <- momcnc_dx[, c(4,1,2)]

skipped_mhg1 <- sum(table(momcnc$cancer=="Skipped this Question")[2])
mgr1[as.numeric(dim(mgr1)[[1]])+1,] <- c("Skipped this Question", skipped_mhg1, round((skipped_mhg1/dim(data_tib_m1)[[1]])*100,2))

dt_mgr1 <- mgr1 %>%  gt::gt(rowname_col = "row_lab") %>%
  tab_header(title = md("MOMCANC2 Mom's Diagnosed Cancer Type")) %>%
  cols_label(Frequency= md("**N**"), Percentage=md("**Percentge of Participants**"),  Condition = md("**Answer**")) %>%
  # summary_rows(
  #   column = c(participants,percentage),
  #   fns= list(
  #     Sum= ~sum(.)
  #   ), decimals=0) %>%
  #grand_summary_rows(columns=c(Frequency, Percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Condition,
    )
  )
tab_footnote(
  dt_mgr1,
  md("As this is a select all question, participants may select multiple responses."),
  locations = cells_column_labels(columns = Percentage),
  placement = c("left")
)



```



```{r MomCancDiag, warning=FALSE, echo=FALSE, message=FALSE}
#Age of Diagnosis
#Anal
anal_a_mdg=boxp_funct(D_259397450_D_206625031,"Mother's Age at Anal Cancer Diagnosis","Age") 
anal_y_mdg=boxp_funct(D_259397450_D_261863326,"Mother's Year of Anal Cancer Diagnosis","Year") 
grid.arrange(anal_a_mdg, anal_y_mdg, nrow=2)

#Bladder
bladder_a_mdg=boxp_funct(D_528753070_D_206625031,"Mother's Age at Bladder Cancer Diagnosis","Age")
bladder_y_mdg=boxp_funct(D_528753070_D_261863326,"Mother's Year of Bladder Cancer Diagnosis","Year")  
grid.arrange(bladder_a_mdg, bladder_y_mdg, nrow=2)
 

#Brain
brain_a_mdg=boxp_funct(D_683981980_D_206625031,"Mother's Age at Brain Cancer Diagnosis","Age")
brain_y_mdg=boxp_funct(D_683981980_D_261863326,"Mother's Year of Brain Cancer Diagnosis","Year") 
grid.arrange(brain_a_mdg, brain_y_mdg, nrow=2)


#Breast
breast_a_mdg=boxp_funct(D_402548942_D_206625031,"Mother's Age at Breast Cancer Diagnosis","Age")
breast_y_mdg=boxp_funct(D_402548942_D_261863326,"Mother's Year of Breast Cancer Diagnosis","Year")
grid.arrange(breast_a_mdg, breast_y_mdg, nrow=2)


#Cervical
cerv_a_mdg=boxp_funct(D_247198016_D_206625031,"Mother's Age at Cervical Cancer Diagnosis","Age")
cerv_y_mdg=boxp_funct(D_247198016_D_261863326,"Mother's Year of Cervical Cancer Diagnosis","Year")
grid.arrange(cerv_a_mdg, cerv_y_mdg, nrow=2)


#Colon/rectal
colon_a_mdg=boxp_funct(D_891925519_D_206625031,"Mother's Age at Colon Cancer Diagnosis","Age")
colon_y_mdg=boxp_funct(D_891925519_D_261863326,"Mother's Year of Colon Cancer Diagnosis","Year")
grid.arrange(colon_a_mdg, colon_y_mdg, nrow=2)


# #Esophageal 
esoph_a_mdg=boxp_funct(D_317093647_D_206625031,"Mother's Age at Esophageal Cancer Diagnosis","Age") 
esoph_y_mdg=boxp_funct(D_317093647_D_261863326,"Mother's Year of Esophageal Cancer Diagnosis","Year") 
grid.arrange(esoph_a_mdg, esoph_y_mdg, nrow=2)

#Head and neck
han_a_mdg=boxp_funct(D_684692228_D_206625031,"Mother's Age at Head and Neck Cancer Diagnosis","Age")
han_y_mdg=boxp_funct(D_684692228_D_261863326,"Mother's Year of Head and Neck Cancer Diagnosis","Year")
grid.arrange(han_a_mdg, han_y_mdg, nrow=2)

#kidney
kid_a_mdg=boxp_funct(D_671347092_D_206625031,"Mother's Age at Kidney Cancer Diagnosis","Age")
kid_y_mdg=boxp_funct(D_671347092_D_261863326,"Mother's Year of Kidney Cancer Diagnosis","Year")
grid.arrange(kid_a_mdg, kid_y_mdg, nrow=2)

#Leukemia
leuk_a_mdg=boxp_funct(D_875221479_D_206625031,"Mother's Age at Leukemia Cancer Diagnosis","Age")
leuk_y_mdg=boxp_funct(D_875221479_D_261863326,"Mother's Year of Leukemia Cancer Diagnosis","Year") 
grid.arrange(leuk_a_mdg, leuk_y_mdg, nrow=2)

#Liver
liver_a_mdg=boxp_funct(D_186170949_D_206625031,"Mother's Age at Liver Cancer Diagnosis","Age")
liver_y_mdg=boxp_funct(D_186170949_D_261863326,"Mother's Year of Liver Cancer Diagnosis","Year") 
grid.arrange(liver_a_mdg, liver_y_mdg, nrow=2)

#Lung or bronchial
lung_a_mdg=boxp_funct(D_726451917_D_206625031,"Mother's Age at Lung or Bronchial Cancer Diagnosis","Age")
lung_y_mdg=boxp_funct(D_726451917_D_261863326,"Mother's Year of Lung or Bronchial Cancer Diagnosis","Year")
grid.arrange(lung_a_mdg, lung_y_mdg, nrow=2)

#Non-Hodgkin's lymphoma
nhdg_a_mdg=boxp_funct(D_213545903_D_206625031,"Mother's Age at Non-Hodgkin's Lymphoma Cancer Diagnosis","Age")
nhdg_y_mdg=boxp_funct(D_213545903_D_261863326,"Mother's Year of Non-Hodgkin's Lymphoma Cancer Diagnosis","Year")
grid.arrange(nhdg_a_mdg, nhdg_y_mdg, nrow=2)

#Lymphoma
lymph_a_mdg=boxp_funct(D_765903702_D_206625031,"Mother's Age at Lymphoma Cancer Diagnosis","Age")
lymph_y_mdg=boxp_funct(D_765903702_D_261863326,"Mother's Year of Lymphoma Cancer Diagnosis","Year")  
grid.arrange(lymph_a_mdg, lymph_y_mdg, nrow=2)

#Melanoma
mel_a_mdg=boxp_funct(D_773974223_D_206625031,"Mother's Age at Melanoma Cancer Diagnosis","Age")
mel_y_mdg=boxp_funct(D_773974223_D_261863326,"Mother's Year of Melanoma Cancer Diagnosis","Year")
grid.arrange(mel_a_mdg, mel_y_mdg, nrow=2)

#Non-melanoma skin
nmel_a_mdg=boxp_funct(D_433604862_D_206625031,"Mother's Age at Non-Melanoma Cancer Diagnosis","Age")
nmel_y_mdg=boxp_funct(D_433604862_D_261863326,"Mother's Year of Non-Melanoma Cancer Diagnosis","Year")
grid.arrange(nmel_a_mdg, nmel_y_mdg, nrow=2)

#Ovarian
ov_a_mdg=boxp_funct(D_521369040_D_206625031,"Mother's Age at Ovarian Cancer Diagnosis","Age")  
ov_y_mdg=boxp_funct(D_521369040_D_261863326,"Mother's Year of Ovarian Cancer Diagnosis","Year")
grid.arrange(ov_a_mdg, ov_y_mdg, nrow=2)

#Pancreatic
panc_a_mdg=boxp_funct(D_497311092_D_206625031,"Mother's Age at Pancreatic Cancer Diagnosis","Age")
panc_y_mdg=boxp_funct(D_497311092_D_261863326,"Mother's Year of Pancreatic Cancer Diagnosis","Year") 
grid.arrange(panc_a_mdg, panc_y_mdg, nrow=2)

#Stomach
stom_a_mdg=boxp_funct(D_625249910_D_206625031,"Mother's Age at Stomach Cancer Diagnosis","Age")
stom_y_mdg=boxp_funct(D_625249910_D_261863326,"Mother's Year of Stomach Cancer Diagnosis","Year")
grid.arrange(stom_a_mdg, stom_y_mdg, nrow=2)

#Thyroid
thy_a_mdg=boxp_funct(D_838564850_D_206625031,"Mother's Age at Thyroid Cancer Diagnosis","Age")
thy_y_mdg=boxp_funct(D_838564850_D_261863326,"Mother's Year of Thyroid Cancer Diagnosis","Year")
grid.arrange(thy_a_mdg, thy_y_mdg, nrow=2)

#Uterine
ut_a_mdg=boxp_funct(D_633764113_D_206625031,"Mother's Age at Uterine Cancer Diagnosis","Age")
ut_y_mdg=boxp_funct(D_633764113_D_261863326,"Mother's Year of Uterine Cancer Diagnosis","Year")
grid.arrange(ut_a_mdg, ut_y_mdg, nrow=2)

#Other
oth_a_mdg=boxp_funct(D_882263738_D_206625031,"Mother's Age at Other Cancer Diagnosis","Age")
oth_y_mdg=boxp_funct(D_882263738_D_261863326,"Mother's Year of Other Cancer Diagnosis","Year")
grid.arrange(oth_a_mdg, oth_y_mdg, nrow=2)

#unknown
ukn_a_mdg=boxp_funct(D_671308090_D_206625031,"Mother's Year of Unknown Cancer Diagnosis","Age")
ukn_y_mdg=boxp_funct(D_671308090_D_261863326,"Mother's Year of Unknown Cancer Diagnosis","Age")
grid.arrange(ukn_a_mdg, ukn_y_mdg, nrow=2)

```

\newpage

## Dad
```{r Dad, warning=FALSE, echo=FALSE, message=FALSE}
##Dad
#living?
simple_funct(D_367374606, "DAD: Father Living")


#age now
#one_logic_funct(D_178774803_D_334956961, D_367374606, 353358909, "Answer for Father's Current Age")
boxp_funct(D_178774803_D_334956961,"Father's Current Age","Age")
#simple_funct(D_178774803_D_178774803, D_178774803_D_334956961, NA, "Fathers Age Unknown")

dt_dad_age= data_tib_m1 %>% filter(D_367374606==353358909)  

dadage= dt_dad_age  %>%  mutate(answer= case_when(!is.na(D_178774803_D_334956961) ~ "Answered with Age",
                                                  D_178774803_D_178774803=="[178420302]" ~ "Don't Know",
                                                  (is.na(D_178774803_D_334956961) & (D_178774803_D_178774803=="[]")) ~ "Skipped this Question",
                                                  TRUE ~ "Skipped this Question"))

dt_dad_age_summary <- dadage %>% dplyr::group_by(answer) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(answer, n, percentage) 

dt_dad_age_summary %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Father's Current Age Response")) %>% 
  cols_label(n= md("**N**"), answer = md("**Answer**"), percentage = md("**%**")) %>% 
  # summary_rows( groups=F,
  #   column = c(n,percentage),
  #   fns= list(
  #     Sum= ~sum(.)
  #   ), decimals=0) %>%
  grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = answer,
    )
  ) 





#age at death?
#module1$D_628078826_D_517670352=as.numeric(module1$D_628078826_D_517670352)
#module1$D_628078826_D_517670352=round(module1$D_628078826_D_517670352, digits=0)
boxp_funct(D_628078826_D_517670352,"Father's Age at Death","Age")  
#one_logic_funct(D_628078826_D_517670352, D_367374606, 104430631, "Answer for Father's Age at Death")
  #once I have concatenated age come back and do a barplot sectioned off by age
#one_logic_funct(D_628078826_D_628078826,"Father's Age at Death Unknown") 

dt_dad_dthage= data_tib_m1 %>% filter(D_367374606==104430631) 

dadage= dt_dad_dthage  %>%  mutate(answer= case_when(!is.na(D_628078826_D_517670352) ~ "Answered with Age",
                                                  D_628078826_D_628078826=="[178420302]" ~ "Don't Know",
                                                  (is.na(D_628078826_D_517670352) & (D_628078826_D_628078826=="[]")) ~ "Skipped this Question",
                                                  TRUE ~ "Skipped this Question"))

dt_dad_dthage_summary <- dadage %>% dplyr::group_by(answer) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(answer, n, percentage) 

dt_dad_dthage_summary %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("Father's Age at Death Response")) %>% 
  cols_label(n= md("**N**"), answer = md("**Answer**"), percentage = md("**%**")) %>% 
  # summary_rows( groups=F,
  #   column = c(n,percentage),
  #   fns= list(
  #     Sum= ~sum(.)
  #   ), decimals=0) %>%
  grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = answer,
    )
  ) 




#cancer?
simple_funct(D_659784914, "DADCANC: Father Diagnosed with Cancer")
```


```{r DadCanc, include=FALSE}

dt_dad_cnc= data_tib_m1 %>%   filter(D_659784914==353358909) 

dt_dad_cnc= dt_dad_cnc  %>%  mutate(multc = ifelse(D_173240848_D_173240848_D_939782495==1, 1, 0) + ifelse(D_173240848_D_173240848_D_135725957==1, 1, 0) + ifelse(D_173240848_D_173240848_D_518416174==1, 1, 0) + ifelse(D_173240848_D_173240848_D_847945207==1, 1, 0) + ifelse(D_173240848_D_173240848_D_942970912==1, 1, 0) + ifelse(D_173240848_D_173240848_D_596122041==1, 1, 0) + ifelse(D_173240848_D_173240848_D_489400183==1, 1, 0) + ifelse(D_173240848_D_173240848_D_863246236==1, 1, 0) + ifelse(D_173240848_D_173240848_D_607793249==1, 1, 0) + ifelse(D_173240848_D_173240848_D_532172400==1, 1, 0) + ifelse(D_173240848_D_173240848_D_754745617==1, 1, 0) + ifelse(D_173240848_D_173240848_D_665036297==1, 1, 0) + ifelse(D_173240848_D_173240848_D_200837530==1, 1, 0) + ifelse(D_173240848_D_173240848_D_990319383==1, 1, 0) +   ifelse(D_173240848_D_173240848_D_482225200==1, 1, 0) + ifelse(D_173240848_D_173240848_D_764891959==1, 1, 0) + ifelse(D_173240848_D_173240848_D_139822395==1, 1, 0) + ifelse(D_173240848_D_173240848_D_248374037==1, 1, 0) + ifelse(D_173240848_D_173240848_D_807835037==1, 1, 0) + ifelse(D_173240848_D_173240848_D_178420302==1, 1, 0) + ifelse(D_173240848_D_173240848_D_295976386==1, 1, 0) )


dadcnc= dt_dad_cnc  %>%  mutate(cancer= case_when(as.numeric(multc)>1 ~ "Multiple Cancer Types",
                                                  D_173240848_D_173240848_D_939782495==1 ~ "Anal",
                                             D_173240848_D_173240848_D_135725957==1 ~ "Bladder",
                                             D_173240848_D_173240848_D_518416174==1 ~ "Brain",
                                             D_173240848_D_173240848_D_847945207==1 ~ "Breast",
                                             D_173240848_D_173240848_D_942970912==1 ~ "Colon/Rectal",
                                             D_173240848_D_173240848_D_596122041==1 ~ "Esophageal",
                                             D_173240848_D_173240848_D_489400183==1 ~ "Head, Neck, and Shoulders",
                                             D_173240848_D_173240848_D_863246236==1 ~ "Kidney",
                                             D_173240848_D_173240848_D_607793249==1 ~ "Leukemia",
                                             D_173240848_D_173240848_D_532172400==1 ~ "Liver",
                                             D_173240848_D_173240848_D_754745617==1 ~ "Lung",
                                             D_173240848_D_173240848_D_665036297==1 ~ "Non-Hodgkin's Lymphoma",
                                             D_173240848_D_173240848_D_200837530==1 ~ "Lymphoma",
                                             D_173240848_D_173240848_D_990319383==1 ~ "Melanoma Skin",
                                             D_173240848_D_173240848_D_487917585==1 ~ "Non-Melanoma Skin",
                                             D_173240848_D_173240848_D_482225200==1 ~ "Pancreatic",
                                             D_173240848_D_173240848_D_295976386==1 ~ "Prostate",
                                             D_173240848_D_173240848_D_764891959==1 ~ "Stomach",
                                             D_173240848_D_173240848_D_248374037==1 ~ "Testicular",
                                             D_173240848_D_173240848_D_139822395==1 ~ "Thyroid",
                                             (D_173240848_D_173240848_D_807835037==1 | !is.na(D_173240848_D_195093589)) ~ "Other",
                                             D_173240848_D_173240848_D_178420302==1 ~ "Unknown",
                                             TRUE ~ "Skipped this Question"))

tmpDADCANC <- data_tib_m1 %>%  filter(data_tib_m1$D_659784914==353358909)
tmpM2<- tmpDADCANC[, grepl("173240848", colnames(tmpDADCANC))]
tmpM2 <- tmpM2 %>%  select(-"D_173240848_D_173240848_D_195093589", -"D_173240848_D_195093589", -"D_173240848_D_173240848_D_210004486")

DADcnc_dx <- NULL
for (i in 1:22){
  dt <- as.data.frame(tab1(tmpM2[,i])$output.table)
  dt$DADcnc_dx <- colnames(tmpM2)[i]
  DADcnc_dx <- rbind(DADcnc_dx,dt[2,])

}


DADcnc_dx$DADcnc_dx <- c("Anal", "Bladder", "Brain", "Breast", "Colon/Rectal", "Esophageal", "Head, Neck and Shoulders", "Kidney", "Leukemia", "Liver", "Lung", "Non-Hodgkin's Lymphoma", "Lymphoma", "Melanoma", "Non-Melanoma Skin", "Pancreatic", "Prostate", "Stomach", "Testicular", "Thyroid",  "Other", "Unknown")

```

```{r DadCancTable, warning=FALSE, echo=FALSE, message=FALSE}
colnames(DADcnc_dx) <- c("Frequency", "Percentage" , "  %(NA-)",  "Condition")
mgr1 <- DADcnc_dx[, c(4,1,2)]

skipped_mhg1 <- sum(table(dadcnc$cancer=="Skipped this Question")[2])
mgr1[as.numeric(dim(mgr1)[[1]])+1,] <- c("Skipped this Question", skipped_mhg1, round((skipped_mhg1/dim(data_tib_m1)[[1]])*100,2))

dt_mgr1 <- mgr1 %>%  gt::gt(rowname_col = "row_lab") %>%
  tab_header(title = md("DADCANC2 DAD's Diagnosed Cancer Type")) %>%
  cols_label(Frequency= md("**N**"), Percentage=md("**Percentge of Participants**"),  Condition = md("**Answer**")) %>%
  # summary_rows(
  #   column = c(participants,percentage),
  #   fns= list(
  #     Sum= ~sum(.)
  #   ), decimals=0) %>%
  #grand_summary_rows(columns=c(Frequency, Percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Condition,
    )
  )
tab_footnote(
  dt_mgr1,
  md("As this is a select all question, participants may select multiple responses."),
  locations = cells_column_labels(columns = Percentage),
  placement = c("left")
)



```




```{r DadCancDiagn, warning=FALSE, echo=FALSE, message=FALSE}
# #Age at Diagnosis  
# #anal--no one
boxp_funct(D_345146692_D_206625031,"Father's Age at Anal Cancer Diagnosis","Age") 
# anal_y_ddg=boxp_funct(D_345146692_D_261863326,"Father's Year of Anal Cancer Diagnosis","Year") #unanswered
#grid.arrange(anal_a_ddg, anal_y_ddg, nrow=2)


#bladder
blad_a_ddg=boxp_funct(D_243443318_D_206625031,"Father's Age at Bladder Cancer Diagnosis","Age")
blad_y_ddg=boxp_funct(D_243443318_D_261863326,"Father's Year of Bladder Cancer Diagnosis","Year")
grid.arrange(blad_a_ddg, blad_y_ddg, nrow=2)

#brain
brain_a_ddg=boxp_funct(D_610382315_D_206625031,"Father's Age at Brain Cancer Diagnosis","Age")
brain_y_ddg=boxp_funct(D_610382315_D_261863326,"Father's Year of Brain Cancer Diagnosis","Year") 
grid.arrange(brain_a_ddg, brain_y_ddg, nrow=2)
 
#breast
breast_a_ddg=boxp_funct(D_135519371_D_206625031,"Father's Age at Breast Cancer Diagnosis","Age") 
breast_y_ddg=boxp_funct(D_135519371_D_261863326,"Father's Year of Breast Cancer Diagnosis","Year") 
grid.arrange(breast_a_ddg, breast_y_ddg, nrow=2)
 
#colon/rectal
colon_a_ddg=boxp_funct(D_785019074_D_206625031,"Father's Age at Colon or Rectal Cancer Diagnosis","Age")
colon_y_ddg=boxp_funct(D_785019074_D_261863326,"Father's Year of Colon or Rectal Cancer Diagnosis","Year")
grid.arrange(colon_a_ddg, colon_y_ddg, nrow=2)

#esophageal
esoph_a_ddg=boxp_funct(D_152885579_D_206625031,"Father's Age at Esophageal Cancer Diagnosis","Age")
esoph_y_ddg=boxp_funct(D_152885579_D_261863326,"Father's Year of Esophageal Cancer Diagnosis","Year")
grid.arrange(esoph_a_ddg, esoph_y_ddg, nrow=2)
 
#Head and neck
han_a_ddg=boxp_funct(D_692910565_D_206625031,"Father's Age at Head and Neck Cancer Diagnosis","Age")
han_y_ddg=boxp_funct(D_692910565_D_261863326,"Father's Year of Head and Neck Cancer Diagnosis","Year")
grid.arrange(han_a_ddg, han_y_ddg, nrow=2)

#kidney
kdn_a_ddg=boxp_funct(D_522464057_D_206625031,"Father's Age at Kidney Cancer Diagnosis","Age")
kdn_y_ddg=boxp_funct(D_522464057_D_261863326,"Father's Year of Kidney Cancer Diagnosis","Year")
grid.arrange(kdn_a_ddg, kdn_y_ddg, nrow=2)

#leukemia
leuk_a_ddg=boxp_funct(D_808655074_D_206625031,"Father's Age at Leukemia Cancer Diagnosis","Age")
leuk_y_ddg=boxp_funct(D_808655074_D_261863326,"Father's Year of Leukemia Cancer Diagnosis","Year")
grid.arrange(leuk_a_ddg, leuk_y_ddg, nrow=2)

#liver
liver_a_ddg=boxp_funct(D_659627058_D_206625031,"Father's Age at Liver Cancer Diagnosis","Age")
liver_y_ddg=boxp_funct(D_659627058_D_261863326,"Father's Year of Liver Cancer Diagnosis","Year")
grid.arrange(liver_a_ddg, liver_y_ddg, nrow=2)

#lung
lung_a_ddg=boxp_funct(D_370198527_D_206625031,"Father's Age at Lung Cancer Diagnosis","Age")
lung_y_ddg=boxp_funct(D_370198527_D_261863326,"Father's Year of Lung Cancer Diagnosis","Year")
grid.arrange(lung_a_ddg, lung_y_ddg, nrow=2)

#non-hodgkin's lymphoma
nhg_a_ddg=boxp_funct(D_291855684_D_206625031,"Father's Age at Non-Hodgkin's Lymphoma Cancer Diagnosis","Age")
nhg_y_ddg=boxp_funct(D_291855684_D_261863326,"Father's Year of Non-Hodgkin's Lymphoma Cancer Diagnosis","Year")
grid.arrange(nhg_a_ddg, nhg_y_ddg, nrow=2)

#lymphoma
lymph_a_ddg=boxp_funct(D_692910565_D_206625031,"Father's Age at Lymphoma Cancer Diagnosis","Age")
lymph_y_ddg=boxp_funct(D_692910565_D_261863326,"Father's Year of Lymphoma Cancer Diagnosis","Year") 
grid.arrange(lymph_a_ddg, lymph_y_ddg, nrow=2)

#melanoma
mel_a_ddg=boxp_funct(D_210325948_D_206625031,"Father's Age at Melanoma Cancer Diagnosis","Age")
mel_y_ddg=boxp_funct(D_210325948_D_261863326,"Father's Year of Melanoma Cancer Diagnosis","Year")
grid.arrange(mel_a_ddg, mel_y_ddg, nrow=2)

#non-melanoma
nmel_a_ddg=boxp_funct(D_193297280_D_206625031,"Father's Age at Non-Melanoma Cancer Diagnosis","Age")
nmel_y_ddg=boxp_funct(D_193297280_D_261863326,"Father's Year of Non-Melanoma Cancer Diagnosis","Year")
grid.arrange(nmel_a_ddg, nmel_y_ddg, nrow=2)

#pancreatic
panc_a_ddg=boxp_funct(D_121502359_D_206625031,"Father's Age at Pancreatic Cancer Diagnosis","Age")
panc_y_ddg=boxp_funct(D_121502359_D_261863326,"Father's Year of Pancreatic Cancer Diagnosis","Year")
grid.arrange(panc_a_ddg, panc_y_ddg, nrow=2)

#prostate
prs_a_ddg=boxp_funct(D_489402657_D_206625031,"Father's Age at Prostate Cancer Diagnosis","Age")
prs_y_ddg=boxp_funct(D_489402657_D_261863326,"Father's Year of Prostate Cancer Diagnosis","Year")
grid.arrange(prs_a_ddg, prs_y_ddg, nrow=2)

#stomach
stom_a_ddg=boxp_funct(D_727260639_D_206625031,"Father's Age at Stomach Cancer Diagnosis","Age")
stom_y_ddg=boxp_funct(D_727260639_D_261863326,"Father's Year of Stomach Cancer Diagnosis","Year")
grid.arrange(stom_a_ddg, stom_y_ddg, nrow=2)

#testicular
test_a_ddg=boxp_funct(D_359291056_D_206625031,"Father's Age at Testicular Cancer Diagnosis","Age")
test_y_ddg=boxp_funct(D_359291056_D_261863326,"Father's Year of Testicular Cancer Diagnosis","Year") 
grid.arrange(test_a_ddg, test_y_ddg, nrow=2)
 
#thyroid
thy_a_ddg=boxp_funct(D_968841976_D_206625031,"Father's Age at Thyriod Cancer Diagnosis","Age")
thy_y_ddg=boxp_funct(D_968841976_D_261863326,"Father's Year of Thyriod Cancer Diagnosis","Year") 
grid.arrange(thy_a_ddg, thy_y_ddg, nrow=2)

#other
oth_a_ddg=boxp_funct(D_864981804_D_206625031,"Father's Age at Other Cancer Diagnosis","Age")
oth_y_ddg=boxp_funct(D_864981804_D_261863326,"Father's Year of Other Cancer Diagnosis","Year")
grid.arrange(oth_a_ddg, oth_y_ddg, nrow=2)
 
#unknown
ukn_a_ddg=boxp_funct(D_499434567_D_206625031,"Father's Age at Unknown Cancer Type Diagnosis","Age")
ukn_y_ddg=boxp_funct(D_499434567_D_261863326,"Father's Year of Unknown Cancer Type Diagnosis","Year")
grid.arrange(ukn_a_ddg, ukn_y_ddg, nrow=2)


```

\newpage

## Siblings 
```{r Sibling, warning=FALSE, echo=FALSE, message=FALSE}
###Siblings
#how many siblings do you have
hist_funct(D_694265648, "Number of Siblings", "Siblings", "Frequency")



sib_logic_funct(D_579563781_1_1, 1, "SIB2_1: Sibling 1 Sex at Birth")
sib_logic_funct(D_579563781_2_2, 2, "SIB2_2: Sibling 2 Sex at Birth")
sib_logic_funct(D_579563781_3_3, 3, "SIB2_3: Sibling 3 Sex at Birth")
sib_logic_funct(D_579563781_4_4, 4, "SIB2_4: Sibling 4 Sex at Birth")
sib_logic_funct(D_579563781_5_5, 5, "SIB2_5: Sibling 5 Sex at Birth")
sib_logic_funct(D_579563781_6_6, 6, "SIB2_6: Sibling 6 Sex at Birth")
sib_logic_funct(D_579563781_7_7, 7, "SIB2_7: Sibling 7 Sex at Birth")
sib_logic_funct(D_579563781_8_8, 8, "SIB2_8: Sibling 8 Sex at Birth")



#MULT2

sibmult2= data_tib_m1  %>%  filter(as.numeric(D_694265648) >0 & (D_992987417==353358909 | D_992987417==288105839 | D_992987417==626558982))  


sibmult2_1  = sibmult2 %>% mutate(status=case_when(D_807431780_1_1==353358909~ "Yes",
                          D_807431780_1_1==104430631~ "No",
                          TRUE ~ "Skipped this Question"))

dt_sibcanc1_summary <- sibmult2_1 %>% dplyr::group_by(status) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(status, n, percentage) 


dt_sibcanc1_summary %>%  gt::gt(rowname_col = "row_lab") %>%  ## why is this not a proper gt_tbl??
  fmt_number(columns = "percentage", decimals = 2) %>%
  tab_header(title = md("MULT2_1: Sibling 1 a Twin or Multiple")) %>%
  cols_label(status = md("**Diagnosed**"), n = md("**N**"), percentage = md("**%**")) %>%
    # summary_rows(
    # column = c(n,percentage),
    # fns= list(
    #   Sum= ~sum(.)
    # ), decimals=0) %>%
  grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = status,
    )
  ) 




sibmult2_2  = sibmult2 %>%  filter(as.numeric(D_694265648) >1 & (D_992987417==353358909 | D_992987417==288105839 | D_992987417==626558982)) %>%   mutate(status=case_when(D_807431780_2_2==353358909~ "Yes",
                          D_807431780_2_2==104430631~ "No",
                          TRUE ~ "Skipped this Question"))

dt_sibmult2_2_summary <- sibmult2_2 %>% dplyr::group_by(status) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(status, n, percentage) 


dt_sibmult2_2_summary %>%  gt::gt(rowname_col = "row_lab") %>%  ## why is this not a proper gt_tbl??
  fmt_number(columns = "percentage", decimals = 2) %>%
  tab_header(title = md("MULT2_2: Sibling 2 a Twin or Multiple")) %>%
  cols_label(status = md("**Diagnosed**"), n = md("**N**"), percentage = md("**%**")) %>%
    # summary_rows(
    # column = c(n,percentage),
    # fns= list(
    #   Sum= ~sum(.)
    # ), decimals=0) %>%
  grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = status,
    )
  ) 




sibmult2_3  = sibmult2 %>% filter(as.numeric(D_694265648) >2 & (D_992987417==353358909 | D_992987417==288105839 | D_992987417==626558982)) %>%   mutate(status=case_when(D_807431780_3_3==353358909~ "Yes",
                          D_807431780_3_3==104430631~ "No",
                          TRUE ~ "Skipped this Question"))

dt_sibmult2_3_summary <- sibmult2_3 %>% dplyr::group_by(status) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(status, n, percentage) 


dt_sibmult2_3_summary %>%  gt::gt(rowname_col = "row_lab") %>%  ## why is this not a proper gt_tbl??
  fmt_number(columns = "percentage", decimals = 2) %>%
  tab_header(title = md("MULT2_3: Sibling 3 a Twin or Multiple")) %>%
  cols_label(status = md("**Diagnosed**"), n = md("**N**"), percentage = md("**%**")) %>%
    # summary_rows(
    # column = c(n,percentage),
    # fns= list(
    #   Sum= ~sum(.)
    # ), decimals=0) %>%
  grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = status,
    )
  ) 



 
sibmult2_4  = sibmult2 %>% filter(as.numeric(D_694265648) >3 & (D_992987417==353358909 | D_992987417==288105839 | D_992987417==626558982)) %>% mutate(status=case_when(D_807431780_4_4==353358909~ "Yes",
                          D_807431780_4_4==104430631~ "No",
                          TRUE ~ "Skipped this Question"))

dt_sibmult2_4_summary <- sibmult2_4 %>% dplyr::group_by(status) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(status, n, percentage) 


dt_sibmult2_4_summary %>%  gt::gt(rowname_col = "row_lab") %>%  ## why is this not a proper gt_tbl??
  fmt_number(columns = "percentage", decimals = 2) %>%
  tab_header(title = md("MULT2_4: Sibling 4 a Twin or Multiple")) %>%
  cols_label(status = md("**Diagnosed**"), n = md("**N**"), percentage = md("**%**")) %>%
    # summary_rows(
    # column = c(n,percentage),
    # fns= list(
    #   Sum= ~sum(.)
    # ), decimals=0) %>%
  grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = status,
    )
  ) 



 
sibmult2_5  = sibmult2 %>%filter(as.numeric(D_694265648) >4 & (D_992987417==353358909 | D_992987417==288105839 | D_992987417==626558982)) %>%   mutate(status=case_when(D_807431780_5_5==353358909~ "Yes",
                          D_807431780_5_5==104430631~ "No",
                          TRUE ~ "Skipped this Question"))

dt_sibmult2_5_summary <- sibmult2_5 %>% dplyr::group_by(status) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(status, n, percentage) 


dt_sibmult2_5_summary %>%  gt::gt(rowname_col = "row_lab") %>%  ## why is this not a proper gt_tbl??
  fmt_number(columns = "percentage", decimals = 2) %>%
  tab_header(title = md("MULT2_5: Sibling 5 a Twin or Multiple")) %>%
  cols_label(status = md("**Diagnosed**"), n = md("**N**"), percentage = md("**%**")) %>%
    # summary_rows(
    # column = c(n,percentage),
    # fns= list(
    #   Sum= ~sum(.)
    # ), decimals=0) %>%
  grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = status,
    )
  ) 




sibmult2_6  = sibmult2 %>%  filter(as.numeric(D_694265648) >5 & (D_992987417==353358909 | D_992987417==288105839 | D_992987417==626558982)) %>%  mutate(status=case_when(D_807431780_6_6==353358909~ "Yes",
                          D_807431780_6_6==104430631~ "No",
                          TRUE ~ "Skipped this Question"))

dt_sibmult2_6_summary <- sibmult2_6 %>% dplyr::group_by(status) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(status, n, percentage) 


dt_sibmult2_6_summary %>%  gt::gt(rowname_col = "row_lab") %>%  ## why is this not a proper gt_tbl??
  fmt_number(columns = "percentage", decimals = 2) %>%
  tab_header(title = md("MULT2_6: Sibling 6 a Twin or Multiple")) %>%
  cols_label(status = md("**Diagnosed**"), n = md("**N**"), percentage = md("**%**")) %>%
    # summary_rows(
    # column = c(n,percentage),
    # fns= list(
    #   Sum= ~sum(.)
    # ), decimals=0) %>%
  grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = status,
    )
  ) 



 
sibmult2_7  = sibmult2 %>%  filter(as.numeric(D_694265648) >6 & (D_992987417==353358909 | D_992987417==288105839 | D_992987417==626558982)) %>%  mutate(status=case_when(D_807431780_7_7==353358909~ "Yes",
                          D_807431780_7_7==104430631~ "No",
                          TRUE ~ "Skipped this Question"))

dt_sibmult2_6_summary <- sibmult2_7 %>% dplyr::group_by(status) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(status, n, percentage) 


dt_sibmult2_6_summary %>%  gt::gt(rowname_col = "row_lab") %>%  ## why is this not a proper gt_tbl??
  fmt_number(columns = "percentage", decimals = 2) %>%
  tab_header(title = md("MULT2_7: Sibling 7 a Twin or Multiple")) %>%
  cols_label(status = md("**Diagnosed**"), n = md("**N**"), percentage = md("**%**")) %>%
    # summary_rows(
    # column = c(n,percentage),
    # fns= list(
    #   Sum= ~sum(.)
    # ), decimals=0) %>%
  grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = status,
    )
  ) 



  
sibmult2_8  = sibmult2 %>%  filter(as.numeric(D_694265648) >7 & (D_992987417==353358909 | D_992987417==288105839 | D_992987417==626558982)) %>%  mutate(status=case_when(D_807431780_8_8==353358909~ "Yes",
                          D_807431780_8_8==104430631~ "No",
                          TRUE ~ "Skipped this Question"))

dt_sibmult2_6_summary <- sibmult2_8 %>% dplyr::group_by(status) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(status, n, percentage) 


dt_sibmult2_6_summary %>%  gt::gt(rowname_col = "row_lab") %>%  ## why is this not a proper gt_tbl??
  fmt_number(columns = "percentage", decimals = 2) %>%
  tab_header(title = md("MULT2_8: Sibling 8 a Twin or Multiple")) %>%
  cols_label(status = md("**Diagnosed**"), n = md("**N**"), percentage = md("**%**")) %>%
    # summary_rows(
    # column = c(n,percentage),
    # fns= list(
    #   Sum= ~sum(.)
    # ), decimals=0) %>%
  grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = status,
    )
  ) 



#MULT2
sibmult2= data_tib_m1  %>%  filter(as.numeric(D_694265648) >0 & (D_992987417==353358909 | D_992987417==288105839 | D_992987417==626558982))  


sibmult2_1  = sibmult2 %>% mutate(status=case_when(D_807431780_1_1==353358909~ "Yes",
                          D_807431780_1_1==104430631~ "No",
                          TRUE ~ "Skipped this Question"))

dt_sibcanc1_summary <- sibmult2_1 %>% dplyr::group_by(status) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(status, n, percentage) 


dt_sibcanc1_summary %>%  gt::gt(rowname_col = "row_lab") %>%  ## why is this not a proper gt_tbl??
  fmt_number(columns = "percentage", decimals = 2) %>%
  tab_header(title = md("MULT2_1: Sibling 1 a Twin or Multiple")) %>%
  cols_label(status = md("**Diagnosed**"), n = md("**N**"), percentage = md("**%**")) %>%
    # summary_rows(
    # column = c(n,percentage),
    # fns= list(
    #   Sum= ~sum(.)
    # ), decimals=0) %>%
  grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = status,
    )
  ) 




sibmult2_2  = sibmult2 %>%  filter(as.numeric(D_694265648) >1) %>%   mutate(status=case_when(D_807431780_2_2==353358909~ "Yes",
                          D_807431780_2_2==104430631~ "No",
                          TRUE ~ "Skipped this Question"))

dt_sibmult2_2_summary <- sibmult2_2 %>% dplyr::group_by(status) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(status, n, percentage) 


dt_sibmult2_2_summary %>%  gt::gt(rowname_col = "row_lab") %>%  ## why is this not a proper gt_tbl??
  fmt_number(columns = "percentage", decimals = 2) %>%
  tab_header(title = md("MULT2_2: Sibling 1 a Twin or Multiple")) %>%
  cols_label(status = md("**Diagnosed**"), n = md("**N**"), percentage = md("**%**")) %>%
    # summary_rows(
    # column = c(n,percentage),
    # fns= list(
    #   Sum= ~sum(.)
    # ), decimals=0) %>%
  grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = status,
    )
  ) 




sibmult2_3  = sibmult2 %>% filter(as.numeric(D_694265648) >2) %>%   mutate(status=case_when(D_807431780_3_3==353358909~ "Yes",
                          D_807431780_3_3==104430631~ "No",
                          TRUE ~ "Skipped this Question"))

dt_sibmult2_3_summary <- sibmult2_3 %>% dplyr::group_by(status) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(status, n, percentage) 


dt_sibmult2_3_summary %>%  gt::gt(rowname_col = "row_lab") %>%  ## why is this not a proper gt_tbl??
  fmt_number(columns = "percentage", decimals = 2) %>%
  tab_header(title = md("MULT2_3: Sibling 1 a Twin or Multiple")) %>%
  cols_label(status = md("**Diagnosed**"), n = md("**N**"), percentage = md("**%**")) %>%
    # summary_rows(
    # column = c(n,percentage),
    # fns= list(
    #   Sum= ~sum(.)
    # ), decimals=0) %>%
  grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = status,
    )
  ) 



 
sibmult2_4  = sibmult2 %>% filter(as.numeric(D_694265648) >3) %>% mutate(status=case_when(D_807431780_4_4==353358909~ "Yes",
                          D_807431780_4_4==104430631~ "No",
                          TRUE ~ "Skipped this Question"))

dt_sibmult2_4_summary <- sibmult2_4 %>% dplyr::group_by(status) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(status, n, percentage) 


dt_sibmult2_4_summary %>%  gt::gt(rowname_col = "row_lab") %>%  ## why is this not a proper gt_tbl??
  fmt_number(columns = "percentage", decimals = 2) %>%
  tab_header(title = md("MULT2_4: Sibling 1 a Twin or Multiple")) %>%
  cols_label(status = md("**Diagnosed**"), n = md("**N**"), percentage = md("**%**")) %>%
    # summary_rows(
    # column = c(n,percentage),
    # fns= list(
    #   Sum= ~sum(.)
    # ), decimals=0) %>%
  grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = status,
    )
  ) 



 
sibmult2_5  = sibmult2 %>%filter(as.numeric(D_694265648) >4) %>%   mutate(status=case_when(D_807431780_5_5==353358909~ "Yes",
                          D_807431780_5_5==104430631~ "No",
                          TRUE ~ "Skipped this Question"))

dt_sibmult2_5_summary <- sibmult2_5 %>% dplyr::group_by(status) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(status, n, percentage) 


dt_sibmult2_5_summary %>%  gt::gt(rowname_col = "row_lab") %>%  ## why is this not a proper gt_tbl??
  fmt_number(columns = "percentage", decimals = 2) %>%
  tab_header(title = md("MULT2_5: Sibling 1 a Twin or Multiple")) %>%
  cols_label(status = md("**Diagnosed**"), n = md("**N**"), percentage = md("**%**")) %>%
    # summary_rows(
    # column = c(n,percentage),
    # fns= list(
    #   Sum= ~sum(.)
    # ), decimals=0) %>%
  grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = status,
    )
  ) 




sibmult2_6  = sibmult2 %>%  filter(as.numeric(D_694265648) >5) %>%  mutate(status=case_when(D_807431780_6_6==353358909~ "Yes",
                          D_807431780_6_6==104430631~ "No",
                          TRUE ~ "Skipped this Question"))

dt_sibmult2_6_summary <- sibmult2_6 %>% dplyr::group_by(status) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(status, n, percentage) 


dt_sibmult2_6_summary %>%  gt::gt(rowname_col = "row_lab") %>%  ## why is this not a proper gt_tbl??
  fmt_number(columns = "percentage", decimals = 2) %>%
  tab_header(title = md("MULT2_6: Sibling 1 a Twin or Multiple")) %>%
  cols_label(status = md("**Diagnosed**"), n = md("**N**"), percentage = md("**%**")) %>%
    # summary_rows(
    # column = c(n,percentage),
    # fns= list(
    #   Sum= ~sum(.)
    # ), decimals=0) %>%
  grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = status,
    )
  ) 



 
sibmult2_7  = sibmult2 %>%  filter(as.numeric(D_694265648) >6) %>%  mutate(status=case_when(D_807431780_7_7==353358909~ "Yes",
                          D_807431780_7_7==104430631~ "No",
                          TRUE ~ "Skipped this Question"))

dt_sibmult2_6_summary <- sibmult2_7 %>% dplyr::group_by(status) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(status, n, percentage) 


dt_sibmult2_6_summary %>%  gt::gt(rowname_col = "row_lab") %>%  ## why is this not a proper gt_tbl??
  fmt_number(columns = "percentage", decimals = 2) %>%
  tab_header(title = md("MULT2_7: Sibling 1 a Twin or Multiple")) %>%
  cols_label(status = md("**Diagnosed**"), n = md("**N**"), percentage = md("**%**")) %>%
    # summary_rows(
    # column = c(n,percentage),
    # fns= list(
    #   Sum= ~sum(.)
    # ), decimals=0) %>%
  grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = status,
    )
  ) 



  
sibmult2_8  = sibmult2 %>%  filter(as.numeric(D_694265648) >7) %>%  mutate(status=case_when(D_807431780_8_8==353358909~ "Yes",
                          D_807431780_8_8==104430631~ "No",
                          TRUE ~ "Skipped this Question"))

dt_sibmult2_6_summary <- sibmult2_8 %>% dplyr::group_by(status) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(status, n, percentage) 


dt_sibmult2_6_summary %>%  gt::gt(rowname_col = "row_lab") %>%  ## why is this not a proper gt_tbl??
  fmt_number(columns = "percentage", decimals = 2) %>%
  tab_header(title = md("MULT2_8: Sibling 8 a Twin or Multiple")) %>%
  cols_label(status = md("**Diagnosed**"), n = md("**N**"), percentage = md("**%**")) %>%
    # summary_rows(
    # column = c(n,percentage),
    # fns= list(
    #   Sum= ~sum(.)
    # ), decimals=0) %>%
  grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = status,
    )
  ) 




sib_logic_funct(D_589588769_1_1, 1, "SIB3_1: Sibling 1 a Full or Half Sibling")
sib_logic_funct(D_589588769_2_2, 2, "SIB3_2: Sibling 2 a Full or Half Sibling")
sib_logic_funct(D_589588769_3_3, 3, "SIB3_3: Sibling 3 a Full or Half Sibling")
sib_logic_funct(D_589588769_4_4, 4, "SIB3_4: Sibling 4 a Full or Half Sibling")
sib_logic_funct(D_589588769_5_5, 5, "SIB3_5: Sibling 5 a Full or Half Sibling")
sib_logic_funct(D_589588769_6_6, 6, "SIB3_6: Sibling 6 a Full or Half Sibling")
sib_logic_funct(D_589588769_7_7, 7, "SIB3_7: Sibling 7 a Full or Half Sibling")
sib_logic_funct(D_589588769_8_8, 8, "SIB3_8: Sibling 8 a Full or Half Sibling")



sib_logic_funct(D_890637099_1_1, 1, "SIB4_1: Sibling 1 Still Living")
sib_logic_funct(D_890637099_2_2, 2, "SIB4_2: Sibling 2 Still Living")
sib_logic_funct(D_890637099_3_3, 3, "SIB4_3: Sibling 3 Still Living")
sib_logic_funct(D_890637099_4_4, 4, "SIB4_4: Sibling 4 Still Living")
sib_logic_funct(D_890637099_5_5, 5, "SIB4_5: Sibling 5 Still Living")
sib_logic_funct(D_890637099_6_6, 6, "SIB4_6: Sibling 6 Still Living")
sib_logic_funct(D_890637099_7_7, 7, "SIB4_7: Sibling 7 Still Living")
sib_logic_funct(D_890637099_8_8, 8, "SIB4_8: Sibling 8 Still Living")



  
sib1_age=boxp_funct(D_869387390_1_1_D_478706011_1,"SIBAGE1: Age of Sibling 1 Today", "Age")
sib2_age=boxp_funct(D_869387390_2_2_D_478706011_2,"SIBAGE2: Age of Sibling 2 Today", "Age")
sib3_age=boxp_funct(D_869387390_3_3_D_478706011_3,"SIBAGE3: Age of Sibling 3 Today", "Age")
sib4_age=boxp_funct(D_869387390_4_4_D_478706011_4,"SIBAGE4: Age of Sibling 4 Today", "Age")
sib5_age=boxp_funct(D_869387390_5_5_D_478706011_5,"SIBAGE5: Age of Sibling 5 Today", "Age")
sib6_age=boxp_funct(D_869387390_6_6_D_478706011_6,"SIBAGE6: Age of Sibling 6 Today", "Age")
sib7_age=boxp_funct(D_869387390_7_7_D_478706011_7,"SIBAGE7: Age of Sibling 7 Today", "Age")
sib8_age=boxp_funct(D_869387390_8_8_D_478706011_8,"SIBAGE8: Age of Sibling 5 Today", "Age")

grid.arrange(sib1_age,sib2_age,sib3_age,sib4_age, nrow=2)
grid.arrange(sib5_age,sib6_age,sib7_age, sib8_age, nrow=2)




# simple_funct(D_869387390_1_1_D_869387390_1_1, "Answer for Age of Sibling 1 Today")
# simple_funct(D_869387390_2_2_D_869387390_2_2, "Answer for Age of Sibling 2 Today")
# simple_funct(D_869387390_3_3_D_869387390_3_3, "Answer for Age of Sibling 3 Today")
# simple_funct(D_869387390_4_4_D_869387390_4_4, "Answer for Age of Sibling 4 Today")
# simple_funct(D_869387390_5_5_D_869387390_5_5, "Answer for Age of Sibling 5 Today")
# simple_funct(D_869387390_6_6_D_869387390_6_6, "Answer for Age of Sibling 6 Today")
# simple_funct(D_869387390_7_7_D_869387390_7_7, "Answer for Age of Sibling 7 Today")
# simple_funct(D_869387390_8_8_D_869387390_8_8, "Answer for Age of Sibling 8 Today")




##no sib8 deaths reported 
sib1_death=boxp_funct(D_537137982_1_1_D_338020179_1,"SIBDEATH1: Age of Sibling 1 At Death", "Age")
module1$D_537137982_2_2_D_338020179_2=as.numeric(module1$D_537137982_2_2_D_338020179_2)
module1$D_537137982_2_2_D_338020179_2=round(module1$D_537137982_2_2_D_338020179_2, digits=0)#correcting for ages given in decimal places
sib2_death=boxp_funct(D_537137982_2_2_D_338020179_2,"SIBDEATH2: Age of Sibling 2 At Death", "Age")
module1$D_537137982_3_3_D_338020179_3=as.numeric(module1$D_537137982_3_3_D_338020179_3)
module1$D_537137982_3_3_D_338020179_3=round(module1$D_537137982_3_3_D_338020179_3, digits=0) #correcting for ages given in decimal places
sib3_death=boxp_funct(D_537137982_3_3_D_338020179_3,"SIBDEATH3: Age of Sibling 3 At Death", "Age")
sib4_death=boxp_funct(D_537137982_4_4_D_338020179_4,"SIBDEATH4: Age of Sibling 4 At Death", "Age")
sib5_death=boxp_funct(D_537137982_5_5_D_338020179_5,"SIBDEATH5: Age of Sibling 5 At Death", "Age")
sib6_death=boxp_funct(D_537137982_6_6_D_338020179_6,"SIBDEATH6: Age of Sibling 6 At Death", "Age")
sib7_death=boxp_funct(D_537137982_7_7_D_338020179_7,"SIBDEATH7: Age of Sibling 7 At Death", "Age")

grid.arrange(sib1_death,sib2_death,sib3_death,sib4_death, nrow=2)
grid.arrange(sib6_death,sib4_death,sib7_death, nrow=2)

#forgot age at death-- no ones answered this as of yet 


#SIBCANC


sibcanc1= data_tib_m1  %>%  filter(as.numeric(D_694265648) >0) %>%  mutate(status= case_when((D_607773106_1_1==353358909 | D_607773106_2_2==353358909 | 
                                      D_607773106_3_3==353358909 | D_607773106_4_4==353358909 | D_607773106_5_5==353358909 | D_607773106_6_6==353358909 |
                                      D_607773106_7_7==353358909| D_607773106_8_8==353358909 | D_607773106_9_9==353358909| D_607773106_10_10==353358909 |
                                      D_607773106_11_11==353358909 | D_607773106_12_12==353358909  | D_607773106_13_13==353358909)  ~ "Sibling Diagnosed",
                                      (D_607773106_1_1==104430631 | D_607773106_2_2==104430631 | 
                                      D_607773106_3_3==104430631 | D_607773106_4_4==104430631 | D_607773106_5_5==104430631 | D_607773106_6_6==104430631 |
                                      D_607773106_7_7==104430631| D_607773106_8_8==104430631 | D_607773106_9_9==104430631| D_607773106_10_10==104430631 |
                                      D_607773106_11_11==104430631 | D_607773106_12_12==104430631  | D_607773106_13_13==104430631)  ~ "No Sibling Diagnosed",
                                                    TRUE ~ "Skipped this Question"))

dt_sibcanc1_summary <- sibcanc1 %>% dplyr::group_by(status) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(status, n, percentage) 


dt_sibcanc1_summary %>%  gt::gt(rowname_col = "row_lab") %>%  ## why is this not a proper gt_tbl??
  fmt_number(columns = "percentage", decimals = 2) %>%
  tab_header(title = md("SIBCANC: Siblings 1-13 Diagnosed with Cancer")) %>%
  cols_label(status = md("**Diagnosed**"), n = md("**N**"), percentage = md("**%**")) %>%
    # summary_rows(
    # column = c(n,percentage),
    # fns= list(
    #   Sum= ~sum(.)
    # ), decimals=0) %>%
  grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = status,
    )
  ) 




#SIBCANC2
#type:

sibling <- sibcanc1 %>%  filter(status=="Sibling Diagnosed")

sibling= sibling  %>%  mutate(multc1 = ifelse(D_578895128_1_1_D_578895128_1_1_D_939782495==1, 1, 0) + ifelse(D_578895128_1_1_D_578895128_1_1_D_135725957==1, 1, 0) + ifelse(D_578895128_1_1_D_578895128_1_1_D_518416174==1, 1, 0) + ifelse(D_578895128_1_1_D_578895128_1_1_D_847945207==1, 1, 0) + ifelse(D_578895128_1_1_D_578895128_1_1_D_942970912==1, 1, 0) + ifelse(D_578895128_1_1_D_578895128_1_1_D_596122041==1, 1, 0) + ifelse(D_578895128_1_1_D_578895128_1_1_D_489400183==1, 1, 0) + ifelse(D_578895128_1_1_D_578895128_1_1_D_863246236==1, 1, 0) + ifelse(D_578895128_1_1_D_578895128_1_1_D_607793249==1, 1, 0) + ifelse(D_578895128_1_1_D_578895128_1_1_D_532172400==1, 1, 0) + ifelse(D_578895128_1_1_D_578895128_1_1_D_754745617==1, 1, 0) + ifelse(D_578895128_1_1_D_578895128_1_1_D_665036297==1, 1, 0) + ifelse(D_578895128_1_1_D_578895128_1_1_D_200837530==1, 1, 0) + ifelse(D_578895128_1_1_D_578895128_1_1_D_990319383==1, 1, 0) + ifelse(D_578895128_1_1_D_578895128_1_1_D_482225200==1, 1, 0) + ifelse(D_578895128_1_1_D_578895128_1_1_D_764891959==1, 1, 0) + ifelse(D_578895128_1_1_D_578895128_1_1_D_139822395==1, 1, 0) + ifelse(D_578895128_1_1_D_578895128_1_1_D_248374037==1, 1, 0) + ifelse(D_578895128_1_1_D_578895128_1_1_D_807835037==1, 1, 0) + ifelse(D_578895128_1_1_D_578895128_1_1_D_487917585==1, 1, 0) + ifelse(D_578895128_1_1_D_578895128_1_1_D_295976386==1, 1, 0),
                              multc2 = ifelse(D_578895128_2_2_D_578895128_2_2_D_939782495==1, 1, 0) + ifelse(D_578895128_2_2_D_578895128_2_2_D_135725957==1, 1, 0) + ifelse(D_578895128_2_2_D_578895128_2_2_D_518416174==1, 1, 0) + ifelse(D_578895128_2_2_D_578895128_2_2_D_847945207==1, 1, 0) + ifelse(D_578895128_2_2_D_578895128_2_2_D_942970912==1, 1, 0) + ifelse(D_578895128_2_2_D_578895128_2_2_D_596122041==1, 1, 0) + ifelse(D_578895128_2_2_D_578895128_2_2_D_489400183==1, 1, 0) + ifelse(D_578895128_2_2_D_578895128_2_2_D_863246236==1, 1, 0) + ifelse(D_578895128_2_2_D_578895128_2_2_D_607793249==1, 1, 0) + ifelse(D_578895128_2_2_D_578895128_2_2_D_532172400==1, 1, 0) + ifelse(D_578895128_2_2_D_578895128_2_2_D_754745617==1, 1, 0) + ifelse(D_578895128_2_2_D_578895128_2_2_D_665036297==1, 1, 0) + ifelse(D_578895128_2_2_D_578895128_2_2_D_200837530==1, 1, 0) + ifelse(D_578895128_2_2_D_578895128_2_2_D_990319383==1, 1, 0) + ifelse(D_578895128_2_2_D_578895128_2_2_D_482225200==1, 1, 0) + ifelse(D_578895128_2_2_D_578895128_2_2_D_764891959==1, 1, 0) + ifelse(D_578895128_2_2_D_578895128_2_2_D_139822395==1, 1, 0) + ifelse(D_578895128_2_2_D_578895128_2_2_D_248374037==1, 1, 0) + ifelse(D_578895128_2_2_D_578895128_2_2_D_807835037==1, 1, 0) + ifelse(D_578895128_2_2_D_578895128_2_2_D_487917585==1, 1, 0) + ifelse(D_578895128_2_2_D_578895128_2_2_D_295976386==1, 1, 0),
                              multc3 = ifelse(D_578895128_3_3_D_578895128_3_3_D_939782495==1, 1, 0) + ifelse(D_578895128_3_3_D_578895128_3_3_D_135725957==1, 1, 0) + ifelse(D_578895128_3_3_D_578895128_3_3_D_518416174==1, 1, 0) + ifelse(D_578895128_3_3_D_578895128_3_3_D_847945207==1, 1, 0) + ifelse(D_578895128_3_3_D_578895128_3_3_D_942970912==1, 1, 0) + ifelse(D_578895128_3_3_D_578895128_3_3_D_596122041==1, 1, 0) + ifelse(D_578895128_3_3_D_578895128_3_3_D_489400183==1, 1, 0) + ifelse(D_578895128_3_3_D_578895128_3_3_D_863246236==1, 1, 0) + ifelse(D_578895128_3_3_D_578895128_3_3_D_607793249==1, 1, 0) + ifelse(D_578895128_3_3_D_578895128_3_3_D_532172400==1, 1, 0) + ifelse(D_578895128_3_3_D_578895128_3_3_D_754745617==1, 1, 0) + ifelse(D_578895128_3_3_D_578895128_3_3_D_665036297==1, 1, 0) + ifelse(D_578895128_3_3_D_578895128_3_3_D_200837530==1, 1, 0) + ifelse(D_578895128_3_3_D_578895128_3_3_D_990319383==1, 1, 0) + ifelse(D_578895128_3_3_D_578895128_3_3_D_482225200==1, 1, 0) + ifelse(D_578895128_3_3_D_578895128_3_3_D_764891959==1, 1, 0) + ifelse(D_578895128_3_3_D_578895128_3_3_D_139822395==1, 1, 0) + ifelse(D_578895128_3_3_D_578895128_3_3_D_248374037==1, 1, 0) + ifelse(D_578895128_3_3_D_578895128_3_3_D_807835037==1, 1, 0) + ifelse(D_578895128_3_3_D_578895128_3_3_D_487917585==1, 1, 0) + ifelse(D_578895128_3_3_D_578895128_3_3_D_295976386==1, 1, 0),
                              multc4 = ifelse(D_578895128_4_4_D_578895128_4_4_D_939782495==1, 1, 0) + ifelse(D_578895128_4_4_D_578895128_4_4_D_135725957==1, 1, 0) + ifelse(D_578895128_4_4_D_578895128_4_4_D_518416174==1, 1, 0) + ifelse(D_578895128_4_4_D_578895128_4_4_D_847945207==1, 1, 0) + ifelse(D_578895128_4_4_D_578895128_4_4_D_942970912==1, 1, 0) + ifelse(D_578895128_4_4_D_578895128_4_4_D_596122041==1, 1, 0) + ifelse(D_578895128_4_4_D_578895128_4_4_D_489400183==1, 1, 0) + ifelse(D_578895128_4_4_D_578895128_4_4_D_863246236==1, 1, 0) + ifelse(D_578895128_4_4_D_578895128_4_4_D_607793249==1, 1, 0) + ifelse(D_578895128_4_4_D_578895128_4_4_D_532172400==1, 1, 0) + ifelse(D_578895128_4_4_D_578895128_4_4_D_754745617==1, 1, 0) + ifelse(D_578895128_4_4_D_578895128_4_4_D_665036297==1, 1, 0) + ifelse(D_578895128_4_4_D_578895128_4_4_D_200837530==1, 1, 0) + ifelse(D_578895128_4_4_D_578895128_4_4_D_990319383==1, 1, 0) + ifelse(D_578895128_4_4_D_578895128_4_4_D_482225200==1, 1, 0) + ifelse(D_578895128_4_4_D_578895128_4_4_D_764891959==1, 1, 0) + ifelse(D_578895128_4_4_D_578895128_4_4_D_139822395==1, 1, 0) + ifelse(D_578895128_4_4_D_578895128_4_4_D_248374037==1, 1, 0) + ifelse(D_578895128_4_4_D_578895128_4_4_D_807835037==1, 1, 0) + ifelse(D_578895128_4_4_D_578895128_4_4_D_487917585==1, 1, 0) + ifelse(D_578895128_4_4_D_578895128_4_4_D_295976386==1, 1, 0))

body_sibling= sibling  %>%  mutate(bodyp= case_when((as.numeric(multc1)>1 | as.numeric(multc2)>1 | as.numeric(multc3)>1 | as.numeric(multc4)>1) ~ "Multiple Cancer Types",
                                                    (D_578895128_2_2_D_578895128_2_2_D_939782495==1 | D_578895128_1_1_D_578895128_1_1_D_939782495==1 | D_578895128_3_3_D_578895128_3_3_D_939782495==1 | D_578895128_4_4_D_578895128_4_4_D_939782495==1) ~ "Anal",
                                                 (D_578895128_2_2_D_578895128_2_2_D_135725957==1 | D_578895128_1_1_D_578895128_1_1_D_135725957==1 | D_578895128_3_3_D_578895128_3_3_D_135725957==1 | D_578895128_4_4_D_578895128_4_4_D_135725957==1) ~ "Bladder",
                                                 (D_578895128_2_2_D_578895128_2_2_D_518416174==1 | D_578895128_1_1_D_578895128_1_1_D_518416174==1 | D_578895128_3_3_D_578895128_3_3_D_518416174==1 | D_578895128_4_4_D_578895128_4_4_D_518416174==1) ~ "Brain",
                                                 (D_578895128_2_2_D_578895128_2_2_D_847945207==1 | D_578895128_1_1_D_578895128_1_1_D_847945207==1 | D_578895128_3_3_D_578895128_3_3_D_847945207==1 | D_578895128_4_4_D_578895128_4_4_D_847945207==1) ~ "Breast",
                                                 (D_578895128_2_2_D_578895128_2_2_D_942970912==1 | D_578895128_1_1_D_578895128_1_1_D_942970912==1 | D_578895128_3_3_D_578895128_3_3_D_942970912==1 | D_578895128_4_4_D_578895128_4_4_D_942970912==1) ~ "Colon/Rectal",
                                                 (D_578895128_2_2_D_578895128_2_2_D_596122041==1 | D_578895128_1_1_D_578895128_1_1_D_596122041==1 | D_578895128_3_3_D_578895128_3_3_D_596122041==1 | D_578895128_4_4_D_578895128_4_4_D_596122041==1) ~ "Esophageal",
                                                 (D_578895128_2_2_D_578895128_2_2_D_489400183==1 | D_578895128_1_1_D_578895128_1_1_D_489400183==1 | D_578895128_3_3_D_578895128_3_3_D_489400183==1 | D_578895128_4_4_D_578895128_4_4_D_489400183==1) ~ "Head, Neck, and Shoulders",
                                                 (D_578895128_2_2_D_578895128_2_2_D_863246236==1 | D_578895128_1_1_D_578895128_1_1_D_863246236==1 | D_578895128_3_3_D_578895128_3_3_D_863246236==1 | D_578895128_4_4_D_578895128_4_4_D_863246236==1) ~ "Kidney",
                                                 (D_578895128_2_2_D_578895128_2_2_D_607793249==1 | D_578895128_1_1_D_578895128_1_1_D_607793249==1 | D_578895128_3_3_D_578895128_3_3_D_607793249==1 | D_578895128_4_4_D_578895128_4_4_D_607793249==1) ~ "Leukemia",
                                                 (D_578895128_2_2_D_578895128_2_2_D_532172400==1 | D_578895128_1_1_D_578895128_1_1_D_532172400==1 | D_578895128_3_3_D_578895128_3_3_D_532172400==1 | D_578895128_4_4_D_578895128_4_4_D_532172400==1) ~ "Liver",
                                                 (D_578895128_2_2_D_578895128_2_2_D_754745617==1 | D_578895128_1_1_D_578895128_1_1_D_754745617==1 | D_578895128_3_3_D_578895128_3_3_D_754745617==1 | D_578895128_4_4_D_578895128_4_4_D_754745617==1) ~ "Lung",
                                                 (D_578895128_2_2_D_578895128_2_2_D_665036297==1 | D_578895128_1_1_D_578895128_1_1_D_665036297==1 | D_578895128_3_3_D_578895128_3_3_D_665036297==1 | D_578895128_4_4_D_578895128_4_4_D_665036297==1) ~ "Non-Hodgkin's Lymphoma",
                                                 (D_578895128_2_2_D_578895128_2_2_D_200837530==1 | D_578895128_1_1_D_578895128_1_1_D_200837530==1 | D_578895128_3_3_D_578895128_3_3_D_200837530==1 | D_578895128_4_4_D_578895128_4_4_D_200837530==1) ~ "Lymphoma",
                                                 (D_578895128_2_2_D_578895128_2_2_D_990319383==1 | D_578895128_1_1_D_578895128_1_1_D_990319383==1  | D_578895128_3_3_D_578895128_3_3_D_990319383==1 | D_578895128_4_4_D_578895128_4_4_D_990319383==1) ~ "Melanoma Skin",
                                                 (D_578895128_2_2_D_578895128_2_2_D_487917585==1 | D_578895128_1_1_D_578895128_1_1_D_487917585==1 | D_578895128_3_3_D_578895128_3_3_D_487917585==1 | D_578895128_4_4_D_578895128_4_4_D_487917585==1) ~ "Non-Melanoma Skin",
                                                 (D_578895128_2_2_D_578895128_2_2_D_482225200==1 | D_578895128_1_1_D_578895128_1_1_D_482225200==1 | D_578895128_3_3_D_578895128_3_3_D_482225200==1 | D_578895128_4_4_D_578895128_4_4_D_482225200==1) ~ "Pancreatic",
                                                 (D_578895128_2_2_D_578895128_2_2_D_295976386==1 | D_578895128_1_1_D_578895128_1_1_D_295976386==1 | D_578895128_3_3_D_578895128_3_3_D_295976386==1 | D_578895128_4_4_D_578895128_4_4_D_295976386==1) ~ "Prostate",
                                                 (D_578895128_2_2_D_578895128_2_2_D_764891959==1 | D_578895128_1_1_D_578895128_1_1_D_764891959==1 | D_578895128_3_3_D_578895128_3_3_D_764891959==1  | D_578895128_4_4_D_578895128_4_4_D_764891959==1) ~ "Stomach",
                                                 (D_578895128_2_2_D_578895128_2_2_D_248374037==1 | D_578895128_1_1_D_578895128_1_1_D_248374037==1 | D_578895128_3_3_D_578895128_3_3_D_248374037==1 | D_578895128_4_4_D_578895128_4_4_D_248374037==1) ~ "Testicular",
                                                 (D_578895128_2_2_D_578895128_2_2_D_139822395==1 | D_578895128_1_1_D_578895128_1_1_D_139822395==1 | D_578895128_3_3_D_578895128_3_3_D_139822395==1 | D_578895128_4_4_D_578895128_4_4_D_139822395==1) ~ "Thyroid",
                                                 ((D_578895128_1_1_D_578895128_1_1_D_807835037==1 | D_578895128_2_2_D_578895128_2_2_D_807835037==1 | D_578895128_3_3_D_578895128_3_3_D_807835037==1 | 
                                                     D_578895128_4_4_D_578895128_4_4_D_807835037==1 | !is.na(D_578895128_1_1_D_957429734_1) | !is.na(D_578895128_2_2_D_957429734_2) | !is.na(D_578895128_3_3_D_957429734_3) |
                                                     !is.na(D_578895128_4_4_D_957429734_4))) ~ "Other",
                                                 (D_578895128_1_1_D_578895128_1_1_D_178420302==1 | D_578895128_2_2_D_578895128_2_2_D_178420302==1 | D_578895128_3_3_D_578895128_3_3_D_178420302==1 | D_578895128_4_4_D_578895128_4_4_D_178420302==1) ~ "Unknown", 
                                                 TRUE ~ "Skipped this Question"))
                                 
dt_body_sibling_summary <- body_sibling %>% dplyr::group_by(bodyp) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(bodyp, percentage)  

sibling_bd_canc <- dt_body_sibling_summary %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("SIBCANC2: Type of Cancer Sibling 1-4 Diagnosed With")) %>% 
  cols_label(bodyp = md("**Cancer**"), percentage = md("**%**")) %>% 
  grand_summary_rows(columns=c(percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = bodyp,
    )
  ) 

sibling_bd_canc




#Age and Year at Diagnosis 
sib1_c1=boxp_funct(D_384881609_1_1_D_206625031_1_1,"Age Sibling 1 Anal Cancer Diagnosed", "Age")
sib1_c2=boxp_funct(D_384881609_1_1_D_261863326_1_1,"Year Sibling 1 Anal Cancer Diagnosed", "Year")
sib1_c3=boxp_funct(D_483975329_1_1_D_206625031_1_1,"Age Sibling 1 Bladder Cancer Diagnosed", "Age")
sib1_c4=boxp_funct(D_483975329_1_1_D_261863326_1_1,"Year Sibling 1 Bladder Cancer Diagnosed", "Year")
sib1_c5=boxp_funct(D_570279754_1_1_D_206625031_1_1,"Age Sibling 1 Brain Cancer Diagnosed", "Age")
sib1_c6=boxp_funct(D_570279754_1_1_D_261863326_1_1,"Year Sibling 1 Brain Cancer Diagnosed", "Year")
sib1_c7=boxp_funct(D_907590067_1_1_D_206625031_1_1,"Age Sibling 1 Breast Cancer Diagnosed", "Age")
sib1_c8=boxp_funct(D_907590067_1_1_D_261863326_1_1,"Year Sibling 1 Breast Cancer Diagnosed", "Year")
sib1_c9=boxp_funct(D_860112841_1_1_D_206625031_1_1,"Age Sibling 1 Cervical Cancer Diagnosed", "Age")
sib1_c10=boxp_funct(D_860112841_1_1_D_261863326_1_1,"Year Sibling 1 Cervical Cancer Diagnosed", "Year")
sib1_c11=boxp_funct(D_158354252_1_1_D_206625031_1_1,"Age Sibling 1 Colon Cancer Diagnosed", "Age")
sib1_c12=boxp_funct(D_158354252_1_1_D_261863326_1_1,"Year Sibling 1 Colon Cancer Diagnosed", "Year")
sib1_c13=boxp_funct(D_654594205_1_1_D_206625031_1_1,"Age Sibling 1 Esophageal Cancer Diagnosed", "Age") #missing
sib1_c14=boxp_funct(D_654594205_1_1_D_261863326_1_1,"Year Sibling 1 Esophageal Cancer Diagnosed", "Year") #missing
sib1_c15=boxp_funct(D_550722030_1_1_D_206625031_1_1,"Age Sibling 1 Heck Neck and Shoulders Cancer Diagnosed", "Age") 
sib1_c16=boxp_funct(D_550722030_1_1_D_261863326_1_1,"Year Sibling 1 Heck Neck and Shoulders Cancer Diagnosed", "Year")
sib1_c17=boxp_funct(D_142912472_1_1_D_206625031_1_1,"Age Sibling 1 Kidney Cancer Diagnosed", "Age") #missing
sib1_c18=boxp_funct(D_142912472_1_1_D_261863326_1_1,"Year Sibling 1 Kidney Cancer Diagnosed", "Year") 
sib1_c19=boxp_funct(D_158409298_1_1_D_206625031_1_1,"Age Sibling 1 Leukemia Cancer Diagnosed", "Age")
sib1_c20=boxp_funct(D_158409298_1_1_D_261863326_1_1,"Year Sibling 1 Leukemia Cancer Diagnosed", "Year")
sib1_c21=boxp_funct(D_529744595_1_1_D_206625031_1_1,"Age Sibling 1 Liver Cancer Diagnosed", "Age") 
sib1_c22=boxp_funct(D_529744595_1_1_D_261863326_1_1,"Year Sibling 1 Liver Cancer Diagnosed", "Year") 
sib1_c23=boxp_funct(D_315987564_1_1_D_206625031_1_1,"Age Sibling 1 Lung Cancer Diagnosed", "Age") 
sib1_c24=boxp_funct(D_315987564_1_1_D_261863326_1_1,"Year Sibling 1 Lung Cancer Diagnosed", "Year") 
sib1_c25=boxp_funct(D_852278004_1_1_D_206625031_1_1,"Age Sibling 1 Non-Hodgkins Lymphoma Cancer Diagnosed", "Age")
sib1_c26=boxp_funct(D_852278004_1_1_D_261863326_1_1,"Year Sibling 1 Non-Hodgkins Lymphoma Cancer Diagnosed", "Year")
sib1_c27=boxp_funct(D_391972881_1_1_D_206625031_1_1,"Age Sibling 1 Lymphoma Cancer Diagnosed", "Age") 
sib1_c28=boxp_funct(D_259089008_1_1_D_206625031_1_1,"Age Sibling 1 Melanoma Cancer Diagnosed", "Age")
sib1_c29=boxp_funct(D_259089008_1_1_D_261863326_1_1,"Year Sibling 1 Melanoma Cancer Diagnosed", "Year")
sib1_c30=boxp_funct(D_209771602_1_1_D_206625031_1_1,"Age Sibling 1 Non-Melanoma Cancer Diagnosed", "Age")
sib1_c31=boxp_funct(D_209771602_1_1_D_261863326_1_1,"Year Sibling 1 Non-Melanoma Cancer Diagnosed", "Year")
sib1_c32=boxp_funct(D_682651189_1_1_D_206625031_1_1,"Age Sibling 1 Ovarian Cancer Diagnosed", "Age") 
sib1_c33=boxp_funct(D_682651189_1_1_D_261863326_1_1,"Year Sibling 1 Ovarian Cancer Diagnosed", "Year") 
sib1_c34=boxp_funct(D_750994269_1_1_D_206625031_1_1,"Age Sibling 1 Pancreatic Cancer Diagnosed", "Age") 
sib1_c35=boxp_funct(D_750994269_1_1_D_261863326_1_1,"Year Sibling 1 Pancreatic Cancer Diagnosed", "Year") 
sib1_c36=boxp_funct(D_700889863_1_1_D_206625031_1_1,"Age Sibling 1 Prostate Cancer Diagnosed", "Age")
sib1_c37=boxp_funct(D_700889863_1_1_D_261863326_1_1,"Year Sibling 1 Prostate Cancer Diagnosed", "Year")
sib1_c38=boxp_funct(D_990114799_1_1_D_206625031_1_1,"Age Sibling 1 Stomach Cancer Diagnosed", "Age")
sib1_c39=boxp_funct(D_990114799_1_1_D_261863326_1_1,"Year Sibling 1 Stomach Cancer Diagnosed", "Year")
sib1_c40=boxp_funct(D_195363361_1_1_D_206625031_1_1,"Age Sibling 1 Testicular Cancer Diagnosed", "Age")
sib1_c41=boxp_funct(D_195363361_1_1_D_261863326_1_1,"Year Sibling 1 Testicular Cancer Diagnosed", "Year")
sib1_c42=boxp_funct(D_216840563_1_1_D_206625031_1_1,"Age Sibling 1 Thyroid Cancer Diagnosed", "Age")
sib1_c43=boxp_funct(D_216840563_1_1_D_261863326_1_1,"Year Sibling 1 Thyroid Cancer Diagnosed", "Year")
sib1_c44=boxp_funct(D_514034680_1_1_D_206625031_1_1,"Age Sibling 1 Uterine Cancer Diagnosed", "Age") 
sib1_c45=boxp_funct(D_514034680_1_1_D_261863326_1_1,"Year Sibling 1 Uterine Cancer Diagnosed", "Year") 
sib1_c46=boxp_funct(D_247160067_1_1_D_206625031_1_1,"Age Sibling 1 Other Cancer Diagnosed", "Age")
sib1_c47=boxp_funct(D_247160067_1_1_D_261863326_1_1,"Year Sibling 1 Other Cancer Diagnosed", "Year")
sib1_c48=boxp_funct(D_312545873_1_1_D_206625031_1_1,"Age Sibling 1 Unknown Cancer Diagnosed", "Age")
sib1_c49=boxp_funct(D_312545873_1_1_D_261863326_1_1,"Year Sibling 1 Unknown Cancer Diagnosed", "Year")

grid.arrange(sib1_c1, sib1_c2, sib1_c3, sib1_c4, nrow=4)
grid.arrange(sib1_c5, sib1_c6, sib1_c7, sib1_c8, nrow=4)
grid.arrange(sib1_c9, sib1_c10, sib1_c11, sib1_c12, nrow=4)
grid.arrange(sib1_c13, sib1_c14, sib1_c15, sib1_c16, nrow=4)
grid.arrange(sib1_c17, sib1_c18, sib1_c19, sib1_c20, nrow=4)
grid.arrange(sib1_c21, sib1_c22, sib1_c23, sib1_c24, nrow=4)
grid.arrange(sib1_c25, sib1_c26, sib1_c27, sib1_c28, nrow=4)
grid.arrange(sib1_c29, sib1_c30, sib1_c31, sib1_c32, nrow=4)
grid.arrange(sib1_c33, sib1_c34, sib1_c35, sib1_c36, nrow=4)
grid.arrange(sib1_c37, sib1_c38, sib1_c39, sib1_c40, nrow=4)
grid.arrange(sib1_c41, sib1_c42, sib1_c43, sib1_c44, nrow=4)
grid.arrange(sib1_c45, sib1_c46, sib1_c47, sib1_c48, nrow=4)


sib2_c1=boxp_funct(D_384881609_2_2_D_206625031_2_2,"Age Sibling 2 Anal Cancer Diagnosed", "Age")
#boxp_funct(D_384881609_2_2_D_261863326_2_2,"Year Sibling 2 Anal Cancer Diagnosed", "Year")
sib2_c2=boxp_funct(D_483975329_2_2_D_206625031_2_2,"Age Sibling 2 Bladder Cancer Diagnosed", "Age")
sib2_c3=boxp_funct(D_483975329_2_2_D_261863326_2_2,"Year Sibling 2 Bladder Cancer Diagnosed", "Year")
sib2_c4=boxp_funct(D_570279754_2_2_D_206625031_2_2,"Age Sibling 2 Brain Cancer Diagnosed", "Age")
sib2_c5=boxp_funct(D_570279754_2_2_D_261863326_2_2,"Year Sibling 2 Brain Cancer Diagnosed", "Year")
sib2_c6=boxp_funct(D_907590067_2_2_D_206625031_2_2,"Age Sibling 2 Breast Cancer Diagnosed", "Age")
sib2_c7=boxp_funct(D_907590067_2_2_D_261863326_2_2,"Year Sibling 2 Breast Cancer Diagnosed", "Year")
sib2_c8=boxp_funct(D_860112841_2_2_D_206625031_2_2,"Age Sibling 2 Cervical Cancer Diagnosed", "Age")
sib2_c9=boxp_funct(D_860112841_2_2_D_261863326_2_2,"Year Sibling 2 Cervical Cancer Diagnosed", "Year")
sib2_c10=boxp_funct(D_158354252_2_2_D_206625031_2_2,"Age Sibling 2 Colon Cancer Diagnosed", "Age")
sib2_c11=boxp_funct(D_158354252_2_2_D_261863326_2_2,"Year Sibling 2 Colon Cancer Diagnosed", "Year")
sib2_c12=boxp_funct(D_654594205_2_2_D_206625031_2_2,"Age Sibling 2 Esophageal Cancer Diagnosed", "Age") 
sib2_c13=boxp_funct(D_654594205_2_2_D_261863326_2_2,"Year Sibling 2 Esophageal Cancer Diagnosed", "Year") 
sib2_c14=boxp_funct(D_550722030_2_2_D_206625031_2_2,"Age Sibling 2 Heck Neck and Shoulders Cancer Diagnosed", "Age") 
sib2_c15=boxp_funct(D_550722030_2_2_D_261863326_2_2,"Year Sibling 2 Heck Neck and Shoulders Cancer Diagnosed", "Year")
sib2_c16=boxp_funct(D_142912472_2_2_D_206625031_2_2,"Age Sibling 2 Kidney Cancer Diagnosed", "Age") 
sib2_c17=boxp_funct(D_142912472_2_2_D_261863326_2_2,"Year Sibling 2 Kidney Cancer Diagnosed", "Year") 
sib2_c18=boxp_funct(D_158409298_2_2_D_206625031_2_2,"Age Sibling 2 Leukemia Cancer Diagnosed", "Age")
sib2_c19=boxp_funct(D_158409298_2_2_D_261863326_2_2,"Year Sibling 2 Leukemia Cancer Diagnosed", "Year")
sib2_c20=boxp_funct(D_529744595_2_2_D_206625031_2_2,"Age Sibling 2 Liver Cancer Diagnosed", "Age") 
sib2_c21=boxp_funct(D_529744595_2_2_D_261863326_2_2,"Year Sibling 2 Liver Cancer Diagnosed", "Year") 
sib2_c22=boxp_funct(D_315987564_2_2_D_206625031_2_2,"Age Sibling 2 Lung Cancer Diagnosed", "Age") 
sib2_c23=boxp_funct(D_315987564_2_2_D_261863326_2_2,"Year Sibling 2 Lung Cancer Diagnosed", "Year") 
sib2_c24=boxp_funct(D_852278004_2_2_D_206625031_2_2,"Age Sibling 2 Non-Hodgkins Lymphoma Cancer Diagnosed", "Age")
sib2_c25=boxp_funct(D_852278004_2_2_D_261863326_2_2,"Year Sibling 2 Non-Hodgkins Lymphoma Cancer Diagnosed", "Year")
sib2_c26=boxp_funct(D_391972881_2_2_D_206625031_2_2,"Age Sibling 2 Lymphoma Cancer Diagnosed", "Age") 
sib2_c27=boxp_funct(D_259089008_2_2_D_206625031_2_2,"Age Sibling 2 Melanoma Cancer Diagnosed", "Age")
sib2_c28=boxp_funct(D_259089008_2_2_D_261863326_2_2,"Year Sibling 2 Melanoma Cancer Diagnosed", "Year")
sib2_c29=boxp_funct(D_209771602_2_2_D_206625031_2_2,"Age Sibling 2 Non-Melanoma Cancer Diagnosed", "Age")
sib2_c30=boxp_funct(D_209771602_2_2_D_261863326_2_2,"Year Sibling 2 Non-Melanoma Cancer Diagnosed", "Year")
sib2_c31=boxp_funct(D_682651189_2_2_D_206625031_2_2,"Age Sibling 2 Ovarian Cancer Diagnosed", "Age") 
sib2_c32=boxp_funct(D_682651189_2_2_D_261863326_2_2,"Year Sibling 2 Ovarian Cancer Diagnosed", "Year") 
sib2_c33=boxp_funct(D_750994269_2_2_D_206625031_2_2,"Age Sibling 2 Pancreatic Cancer Diagnosed", "Age") 
sib2_c34=boxp_funct(D_750994269_2_2_D_261863326_2_2,"Year Sibling 2 Pancreatic Cancer Diagnosed", "Year") 
sib2_c35=boxp_funct(D_700889863_2_2_D_206625031_2_2,"Age Sibling 2 Prostate Cancer Diagnosed", "Age")
sib2_c36=boxp_funct(D_700889863_2_2_D_261863326_2_2,"Year Sibling 2 Prostate Cancer Diagnosed", "Year")
sib2_c37=boxp_funct(D_990114799_2_2_D_206625031_2_2,"Age Sibling 2 Stomach Cancer Diagnosed", "Age")
sib2_c38=boxp_funct(D_990114799_2_2_D_261863326_2_2,"Year Sibling 2 Stomach Cancer Diagnosed", "Year")
sib2_c39=boxp_funct(D_195363361_2_2_D_206625031_2_2,"Age Sibling 2 Testicular Cancer Diagnosed", "Age")
sib2_c40=boxp_funct(D_195363361_2_2_D_261863326_2_2,"Year Sibling 2 Testicular Cancer Diagnosed", "Year")
sib2_c41=boxp_funct(D_216840563_2_2_D_206625031_2_2,"Age Sibling 2 Thyroid Cancer Diagnosed", "Age")
sib2_c42=boxp_funct(D_216840563_2_2_D_261863326_2_2,"Year Sibling 2 Thyroid Cancer Diagnosed", "Year")
sib2_c43=boxp_funct(D_514034680_2_2_D_206625031_2_2,"Age Sibling 2 Uterine Cancer Diagnosed", "Age") 
sib2_c44=boxp_funct(D_514034680_2_2_D_261863326_2_2,"Year Sibling 2 Uterine Cancer Diagnosed", "Year") 
sib2_c45=boxp_funct(D_247160067_2_2_D_206625031_2_2,"Age Sibling 2 Other Cancer Diagnosed", "Age")
sib2_c46=boxp_funct(D_247160067_2_2_D_261863326_2_2,"Year Sibling 2 Other Cancer Diagnosed", "Year")
sib2_c47=boxp_funct(D_312545873_2_2_D_206625031_2_2,"Age Sibling 2 Unknown Cancer Diagnosed", "Age")
sib2_c48=boxp_funct(D_312545873_2_2_D_261863326_2_2,"Year Sibling 2 Unknown Cancer Diagnosed", "Year")

grid.arrange(sib2_c1, sib2_c2, sib2_c3, sib2_c4, nrow=4)
grid.arrange(sib2_c5, sib2_c6, sib2_c7, sib2_c8, nrow=4)
grid.arrange(sib2_c9, sib2_c10, sib2_c11, sib2_c12, nrow=4)
grid.arrange(sib2_c13, sib2_c14, sib2_c15, sib2_c16, nrow=4)
grid.arrange(sib2_c17, sib2_c18, sib2_c19, sib2_c20, nrow=4)
grid.arrange(sib2_c21, sib2_c22, sib2_c23, sib2_c24, nrow=4)
grid.arrange(sib2_c25, sib2_c26, sib2_c27, sib2_c28, nrow=4)
grid.arrange(sib2_c29, sib2_c30, sib2_c31, sib2_c32, nrow=4)
grid.arrange(sib2_c33, sib2_c34, sib2_c35, sib2_c36, nrow=4)
grid.arrange(sib2_c37, sib2_c38, sib2_c39, sib2_c40, nrow=4)
grid.arrange(sib2_c41, sib2_c42, sib2_c43, sib2_c44, nrow=4)
grid.arrange(sib2_c45, sib2_c46, sib2_c47, sib2_c48, nrow=4)


#boxp_funct(D_384881609_3_3_D_206625031_3_3,"Age Sibling 3 Anal Cancer Diagnosed", "Age")
#boxp_funct(D_384881609_3_3_D_261863326_3_3,"Year Sibling 3 Anal Cancer Diagnosed", "Year")
sib3_c2=boxp_funct(D_483975329_3_3_D_206625031_3_3,"Age Sibling 3 Bladder Cancer Diagnosed", "Age")
#boxp_funct(D_483975329_3_3_D_261863326_3_3,"Year Sibling 3 Bladder Cancer Diagnosed", "Year")
sib3_c3=boxp_funct(D_570279754_3_3_D_206625031_3_3,"Age Sibling 3 Brain Cancer Diagnosed", "Age")
sib3_c4=boxp_funct(D_570279754_3_3_D_261863326_3_3,"Year Sibling 3 Brain Cancer Diagnosed", "Year")
sib3_c5=boxp_funct(D_907590067_3_3_D_206625031_3_3,"Age Sibling 3 Breast Cancer Diagnosed", "Age")
sib3_c6=boxp_funct(D_907590067_3_3_D_261863326_3_3,"Year Sibling 3 Breast Cancer Diagnosed", "Year")
sib3_c7=boxp_funct(D_860112841_3_3_D_206625031_3_3,"Age Sibling 3 Cervical Cancer Diagnosed", "Age")
sib3_c8=boxp_funct(D_860112841_3_3_D_261863326_3_3,"Year Sibling 3 Cervical Cancer Diagnosed", "Year")
sib3_c9=boxp_funct(D_158354252_3_3_D_206625031_3_3,"Age Sibling 3 Colon Cancer Diagnosed", "Age")
sib3_c10=boxp_funct(D_158354252_3_3_D_261863326_3_3,"Year Sibling 3 Colon Cancer Diagnosed", "Year")
sib3_c11=boxp_funct(D_654594205_3_3_D_206625031_3_3,"Age Sibling 3 Esophageal Cancer Diagnosed", "Age") 
#boxp_funct(D_654594205_3_3_D_261863326_3_3,"Year Sibling 3 Esophageal Cancer Diagnosed", "Year") 
sib3_c12=boxp_funct(D_550722030_3_3_D_206625031_3_3,"Age Sibling 3 Heck Neck and Shoulders Cancer Diagnosed", "Age") 
sib3_c13=boxp_funct(D_550722030_3_3_D_261863326_3_3,"Year Sibling 3 Heck Neck and Shoulders Cancer Diagnosed", "Year")
sib3_c14=boxp_funct(D_142912472_3_3_D_206625031_3_3,"Age Sibling 3 Kidney Cancer Diagnosed", "Age") 
sib3_c15=boxp_funct(D_142912472_3_3_D_261863326_3_3,"Year Sibling 3 Kidney Cancer Diagnosed", "Year") 
sib3_c16=boxp_funct(D_158409298_3_3_D_206625031_3_3,"Age Sibling 3 Leukemia Cancer Diagnosed", "Age")
sib3_c17=boxp_funct(D_158409298_3_3_D_261863326_3_3,"Year Sibling 3 Leukemia Cancer Diagnosed", "Year")
sib3_c18=boxp_funct(D_529744595_3_3_D_206625031_3_3,"Age Sibling 3 Liver Cancer Diagnosed", "Age") 
sib3_c19=boxp_funct(D_529744595_3_3_D_261863326_3_3,"Year Sibling 3 Liver Cancer Diagnosed", "Year") 
sib3_c20=boxp_funct(D_315987564_3_3_D_206625031_3_3,"Age Sibling 3 Lung Cancer Diagnosed", "Age") 
#boxp_funct(D_315987564_3_3_D_261863326_3_3,"Year Sibling 3 Lung Cancer Diagnosed", "Year") 
sib3_c21=boxp_funct(D_852278004_3_3_D_206625031_3_3,"Age Sibling 3 Non-Hodgkins Lymphoma Cancer Diagnosed", "Age")
sib3_c22=boxp_funct(D_852278004_3_3_D_261863326_3_3,"Year Sibling 3 Non-Hodgkins Lymphoma Cancer Diagnosed", "Year")
sib3_c23=boxp_funct(D_391972881_3_3_D_206625031_3_3,"Age Sibling 3 Lymphoma Cancer Diagnosed", "Age") 
sib3_c24=boxp_funct(D_259089008_3_3_D_206625031_3_3,"Age Sibling 3 Melanoma Cancer Diagnosed", "Age")
sib3_c25=boxp_funct(D_259089008_3_3_D_261863326_3_3,"Year Sibling 3 Melanoma Cancer Diagnosed", "Year")
sib3_c26=boxp_funct(D_209771602_3_3_D_206625031_3_3,"Age Sibling 3 Non-Melanoma Cancer Diagnosed", "Age")
sib3_c27=boxp_funct(D_209771602_3_3_D_261863326_3_3,"Year Sibling 3 Non-Melanoma Cancer Diagnosed", "Year")
sib3_c28=boxp_funct(D_682651189_3_3_D_206625031_3_3,"Age Sibling 3 Ovarian Cancer Diagnosed", "Age") 
sib3_c29=boxp_funct(D_682651189_3_3_D_261863326_3_3,"Year Sibling 3 Ovarian Cancer Diagnosed", "Year") 
sib3_c30=boxp_funct(D_750994269_3_3_D_206625031_3_3,"Age Sibling 3 Pancreatic Cancer Diagnosed", "Age") 
sib3_c31=boxp_funct(D_750994269_3_3_D_261863326_3_3,"Year Sibling 3 Pancreatic Cancer Diagnosed", "Year") 
sib3_c32=boxp_funct(D_700889863_3_3_D_206625031_3_3,"Age Sibling 3 Prostate Cancer Diagnosed", "Age")
sib3_c33=boxp_funct(D_700889863_3_3_D_261863326_3_3,"Year Sibling 3 Prostate Cancer Diagnosed", "Year")
sib3_c34=boxp_funct(D_990114799_3_3_D_206625031_3_3,"Age Sibling 3 Stomach Cancer Diagnosed", "Age")
sib3_c35=boxp_funct(D_990114799_3_3_D_261863326_3_3,"Year Sibling 3 Stomach Cancer Diagnosed", "Year")
sib3_c36=boxp_funct(D_195363361_3_3_D_206625031_3_3,"Age Sibling 3 Testicular Cancer Diagnosed", "Age")
#boxp_funct(D_195363361_3_3_D_261863326_3_3,"Year Sibling 3 Testicular Cancer Diagnosed", "Year")
sib3_c37=boxp_funct(D_216840563_3_3_D_206625031_3_3,"Age Sibling 3 Thyroid Cancer Diagnosed", "Age")
sib3_c38=boxp_funct(D_216840563_3_3_D_261863326_3_3,"Year Sibling 3 Thyroid Cancer Diagnosed", "Year")
sib3_c39=boxp_funct(D_514034680_3_3_D_206625031_3_3,"Age Sibling 3 Uterine Cancer Diagnosed", "Age") 
sib3_c40=boxp_funct(D_514034680_3_3_D_261863326_3_3,"Year Sibling 3 Uterine Cancer Diagnosed", "Year") 
sib3_c41=boxp_funct(D_247160067_3_3_D_206625031_3_3,"Age Sibling 3 Other Cancer Diagnosed", "Age")
sib3_c42=boxp_funct(D_247160067_3_3_D_261863326_3_3,"Year Sibling 3 Other Cancer Diagnosed", "Year")
sib3_c43=boxp_funct(D_312545873_3_3_D_206625031_3_3,"Age Sibling 3 Unknown Cancer Diagnosed", "Age")
sib3_c44=boxp_funct(D_312545873_3_3_D_261863326_3_3,"Year Sibling 3 Unknown Cancer Diagnosed", "Year")

grid.arrange(sib3_c2, sib3_c3, sib3_c4, nrow=3)
grid.arrange(sib3_c5, sib3_c6, sib3_c7, sib3_c8, nrow=4)
grid.arrange(sib3_c9, sib3_c10, sib3_c11, sib3_c12, nrow=4)
grid.arrange(sib3_c13, sib3_c14, sib3_c15, sib3_c16, nrow=4)
grid.arrange(sib3_c17, sib3_c18, sib3_c19, sib3_c20, nrow=4)
grid.arrange(sib3_c21, sib3_c22, sib3_c23, sib3_c24, nrow=4)
grid.arrange(sib3_c25, sib3_c26, sib3_c27, sib3_c28, nrow=4)
grid.arrange(sib3_c29, sib3_c30, sib3_c31, sib3_c32, nrow=4)
grid.arrange(sib3_c33, sib3_c34, sib3_c35, sib3_c36, nrow=4)
grid.arrange(sib3_c37, sib3_c38, sib3_c39, sib3_c40, nrow=4)
grid.arrange(sib3_c41, sib3_c42, sib3_c43, sib3_c44, nrow=4)



sib4_c1=boxp_funct(D_384881609_4_4_D_206625031_4_4,"Age Sibling 4 Anal Cancer Diagnosed", "Age")
#boxp_funct(D_384881609_4_4_D_261863326_4_4,"Year Sibling 4 Anal Cancer Diagnosed", "Year")
sib4_c2=boxp_funct(D_483975329_4_4_D_206625031_4_4,"Age Sibling 4 Bladder Cancer Diagnosed", "Age")
sib4_c3=boxp_funct(D_483975329_4_4_D_261863326_4_4,"Year Sibling 4 Bladder Cancer Diagnosed", "Year")
sib4_c4=boxp_funct(D_570279754_4_4_D_206625031_4_4,"Age Sibling 4 Brain Cancer Diagnosed", "Age")
sib4_c5=boxp_funct(D_570279754_4_4_D_261863326_4_4,"Year Sibling 4 Brain Cancer Diagnosed", "Year")
sib4_c6=boxp_funct(D_907590067_4_4_D_206625031_4_4,"Age Sibling 4 Breast Cancer Diagnosed", "Age")
sib4_c7=boxp_funct(D_907590067_4_4_D_261863326_4_4,"Year Sibling 4 Breast Cancer Diagnosed", "Year")
sib4_c8=boxp_funct(D_860112841_4_4_D_206625031_4_4,"Age Sibling 4 Cervical Cancer Diagnosed", "Age")
sib4_c9=boxp_funct(D_860112841_4_4_D_261863326_4_4,"Year Sibling 4 Cervical Cancer Diagnosed", "Year")
sib4_c10=boxp_funct(D_158354252_4_4_D_206625031_4_4,"Age Sibling 4 Colon Cancer Diagnosed", "Age")
sib4_c11=boxp_funct(D_158354252_4_4_D_261863326_4_4,"Year Sibling 4 Colon Cancer Diagnosed", "Year")
sib4_c12=boxp_funct(D_654594205_4_4_D_206625031_4_4,"Age Sibling 4 Esophageal Cancer Diagnosed", "Age") 
#boxp_funct(D_654594205_4_4_D_261863326_4_4,"Year Sibling 4 Esophageal Cancer Diagnosed", "Year") 
sib4_c13=boxp_funct(D_550722030_4_4_D_206625031_4_4,"Age Sibling 4 Heck Neck and Shoulders Cancer Diagnosed", "Age") 
sib4_c14=boxp_funct(D_550722030_4_4_D_261863326_4_4,"Year Sibling 4 Heck Neck and Shoulders Cancer Diagnosed", "Year")
sib4_c15=boxp_funct(D_142912472_4_4_D_206625031_4_4,"Age Sibling 4 Kidney Cancer Diagnosed", "Age") 
sib4_c16=boxp_funct(D_142912472_4_4_D_261863326_4_4,"Year Sibling 4 Kidney Cancer Diagnosed", "Year") 
sib4_c17=boxp_funct(D_158409298_4_4_D_206625031_4_4,"Age Sibling 4 Leukemia Cancer Diagnosed", "Age")
sib4_c18=boxp_funct(D_158409298_4_4_D_261863326_4_4,"Year Sibling 4 Leukemia Cancer Diagnosed", "Year")
sib4_c19=boxp_funct(D_529744595_4_4_D_206625031_4_4,"Age Sibling 4 Liver Cancer Diagnosed", "Age") 
sib4_c20=boxp_funct(D_529744595_4_4_D_261863326_4_4,"Year Sibling 4 Liver Cancer Diagnosed", "Year") 
sib4_c21=boxp_funct(D_315987564_4_4_D_206625031_4_4,"Age Sibling 4 Lung Cancer Diagnosed", "Age") 
sib4_c22=boxp_funct(D_315987564_4_4_D_261863326_4_4,"Year Sibling 4 Lung Cancer Diagnosed", "Year") 
sib4_c23=boxp_funct(D_852278004_4_4_D_206625031_4_4,"Age Sibling 4 Non-Hodgkins Lymphoma Cancer Diagnosed", "Age")
sib4_c24=boxp_funct(D_852278004_4_4_D_261863326_4_4,"Year Sibling 4 Non-Hodgkins Lymphoma Cancer Diagnosed", "Year")
sib4_c25=boxp_funct(D_391972881_4_4_D_206625031_4_4,"Age Sibling 4 Lymphoma Cancer Diagnosed", "Age") 
sib4_c26=boxp_funct(D_259089008_4_4_D_206625031_4_4,"Age Sibling 4 Melanoma Cancer Diagnosed", "Age")
sib4_c27=boxp_funct(D_259089008_4_4_D_261863326_4_4,"Year Sibling 4 Melanoma Cancer Diagnosed", "Year")
sib4_c28=boxp_funct(D_209771602_4_4_D_206625031_4_4,"Age Sibling 4 Non-Melanoma Cancer Diagnosed", "Age")
sib4_c29=boxp_funct(D_209771602_4_4_D_261863326_4_4,"Year Sibling 4 Non-Melanoma Cancer Diagnosed", "Year")
sib4_c30=boxp_funct(D_682651189_4_4_D_206625031_4_4,"Age Sibling 4 Ovarian Cancer Diagnosed", "Age") 
sib4_c31=boxp_funct(D_682651189_4_4_D_261863326_4_4,"Year Sibling 4 Ovarian Cancer Diagnosed", "Year") 
sib4_c32=boxp_funct(D_750994269_4_4_D_206625031_4_4,"Age Sibling 4 Pancreatic Cancer Diagnosed", "Age") 
sib4_c33=boxp_funct(D_750994269_4_4_D_261863326_4_4,"Year Sibling 4 Pancreatic Cancer Diagnosed", "Year") 
sib4_c34=boxp_funct(D_700889863_4_4_D_206625031_4_4,"Age Sibling 4 Prostate Cancer Diagnosed", "Age")
sib4_c35=boxp_funct(D_700889863_4_4_D_261863326_4_4,"Year Sibling 4 Prostate Cancer Diagnosed", "Year")
sib4_c36=boxp_funct(D_990114799_4_4_D_206625031_4_4,"Age Sibling 4 Stomach Cancer Diagnosed", "Age")
sib4_c37=boxp_funct(D_990114799_4_4_D_261863326_4_4,"Year Sibling 4 Stomach Cancer Diagnosed", "Year")
sib4_c38=boxp_funct(D_195363361_4_4_D_206625031_4_4,"Age Sibling 4 Testicular Cancer Diagnosed", "Age")
sib4_c39=boxp_funct(D_195363361_4_4_D_261863326_4_4,"Year Sibling 4 Testicular Cancer Diagnosed", "Year")
sib4_c40=boxp_funct(D_216840563_4_4_D_206625031_4_4,"Age Sibling 4 Thyroid Cancer Diagnosed", "Age")
sib4_c41=boxp_funct(D_216840563_4_4_D_261863326_4_4,"Year Sibling 4 Thyroid Cancer Diagnosed", "Year")
sib4_c42=boxp_funct(D_514034680_4_4_D_206625031_4_4,"Age Sibling 4 Uterine Cancer Diagnosed", "Age") 
sib4_c43=boxp_funct(D_514034680_4_4_D_261863326_4_4,"Year Sibling 4 Uterine Cancer Diagnosed", "Year") 
sib4_c44=boxp_funct(D_247160067_4_4_D_206625031_4_4,"Age Sibling 4 Other Cancer Diagnosed", "Age")
sib4_c45=boxp_funct(D_247160067_4_4_D_261863326_4_4,"Year Sibling 4 Other Cancer Diagnosed", "Year")
sib4_c46=boxp_funct(D_312545873_4_4_D_206625031_4_4,"Age Sibling 4 Unknown Cancer Diagnosed", "Age")
sib4_c47=boxp_funct(D_312545873_4_4_D_261863326_4_4,"Year Sibling 4 Unknown Cancer Diagnosed", "Year")

grid.arrange(sib4_c1, sib4_c2, sib4_c3, sib4_c4, nrow=4)
grid.arrange(sib4_c5, sib4_c6, sib4_c7, sib4_c8, nrow=4)
grid.arrange(sib4_c9, sib4_c10, sib4_c11, sib4_c12, nrow=4)
grid.arrange(sib4_c13, sib4_c14, sib4_c15, sib4_c16, nrow=4)
grid.arrange(sib4_c17, sib4_c18, sib4_c19, sib4_c20, nrow=4)
grid.arrange(sib4_c21, sib4_c22, sib4_c23, sib4_c24, nrow=4)
grid.arrange(sib4_c25, sib4_c26, sib4_c27, sib4_c28, nrow=4)
grid.arrange(sib4_c29, sib4_c30, sib4_c31, sib4_c32, nrow=4)
grid.arrange(sib4_c33, sib4_c34, sib4_c35, sib4_c36, nrow=4)
grid.arrange(sib4_c37, sib4_c38, sib4_c39, sib4_c40, nrow=4)
grid.arrange(sib4_c41, sib4_c42, sib4_c43, sib4_c44, nrow=4)
grid.arrange(sib4_c45, sib4_c46, sib4_c47,  nrow=3)


#boxp_funct(D_384881609_5_5_D_206625031_5_5,"Age Sibling 5 Anal Cancer Diagnosed", "Age")
#boxp_funct(D_384881609_5_5_D_261863326_5_5,"Year Sibling 5 Anal Cancer Diagnosed", "Year")
sib5_c1=boxp_funct(D_483975329_5_5_D_206625031_5_5,"Age Sibling 5 Bladder Cancer Diagnosed", "Age")
#boxp_funct(D_483975329_5_5_D_261863326_5_5,"Year Sibling 5 Bladder Cancer Diagnosed", "Year")
sib5_c2=boxp_funct(D_570279754_5_5_D_206625031_5_5,"Age Sibling 5 Brain Cancer Diagnosed", "Age")
#boxp_funct(D_570279754_5_5_D_261863326_5_5,"Year Sibling 5 Brain Cancer Diagnosed", "Year")
sib5_c3=boxp_funct(D_907590067_5_5_D_206625031_5_5,"Age Sibling 5 Breast Cancer Diagnosed", "Age")
sib5_c4=boxp_funct(D_907590067_5_5_D_261863326_5_5,"Year Sibling 5 Breast Cancer Diagnosed", "Year")
sib5_c5=boxp_funct(D_860112841_5_5_D_206625031_5_5,"Age Sibling 5 Cervical Cancer Diagnosed", "Age")
#boxp_funct(D_860112841_5_5_D_261863326_5_5,"Year Sibling 5 Cervical Cancer Diagnosed", "Year")
sib5_c6=boxp_funct(D_158354252_5_5_D_206625031_5_5,"Age Sibling 5 Colon Cancer Diagnosed", "Age")
sib5_c7=boxp_funct(D_158354252_5_5_D_261863326_5_5,"Year Sibling 5 Colon Cancer Diagnosed", "Year")
sib5_c8=boxp_funct(D_654594205_5_5_D_206625031_5_5,"Age Sibling 5 Esophageal Cancer Diagnosed", "Age") 
sib5_c9=boxp_funct(D_654594205_5_5_D_261863326_5_5,"Year Sibling 5 Esophageal Cancer Diagnosed", "Year") 
sib5_c10=boxp_funct(D_550722030_5_5_D_206625031_5_5,"Age Sibling 5 Heck Neck and Shoulders Cancer Diagnosed", "Age") 
#boxp_funct(D_550722030_5_5_D_261863326_5_5,"Year Sibling 5 Heck Neck and Shoulders Cancer Diagnosed", "Year")
sib5_c11=boxp_funct(D_142912472_5_5_D_206625031_5_5,"Age Sibling 5 Kidney Cancer Diagnosed", "Age") 
sib5_c12=boxp_funct(D_142912472_5_5_D_261863326_5_5,"Year Sibling 5 Kidney Cancer Diagnosed", "Year") 
sib5_c13=boxp_funct(D_158409298_5_5_D_206625031_5_5,"Age Sibling 5 Leukemia Cancer Diagnosed", "Age")
#boxp_funct(D_158409298_5_5_D_261863326_5_5,"Year Sibling 5 Leukemia Cancer Diagnosed", "Year")
sib5_c14=boxp_funct(D_529744595_5_5_D_206625031_5_5,"Age Sibling 5 Liver Cancer Diagnosed", "Age") 
#boxp_funct(D_529744595_5_5_D_261863326_5_5,"Year Sibling 5 Liver Cancer Diagnosed", "Year") 
sib5_c15=boxp_funct(D_315987564_5_5_D_206625031_5_5,"Age Sibling 5 Lung Cancer Diagnosed", "Age") 
sib5_c16=boxp_funct(D_315987564_5_5_D_261863326_5_5,"Year Sibling 5 Lung Cancer Diagnosed", "Year") 
sib5_c17=boxp_funct(D_852278004_5_5_D_206625031_5_5,"Age Sibling 5 Non-Hodgkins Lymphoma Cancer Diagnosed", "Age")
#boxp_funct(D_852278004_5_5_D_261863326_5_5,"Year Sibling 5 Non-Hodgkins Lymphoma Cancer Diagnosed", "Year")
#boxp_funct(D_391972881_5_5_D_206625031_5_5,"Age Sibling 5 Lymphoma Cancer Diagnosed", "Age") 
sib5_c18=boxp_funct(D_259089008_5_5_D_206625031_5_5,"Age Sibling 5 Melanoma Cancer Diagnosed", "Age")
sib5_c19=boxp_funct(D_259089008_5_5_D_261863326_5_5,"Year Sibling 5 Melanoma Cancer Diagnosed", "Year")
sib5_c20=boxp_funct(D_209771602_5_5_D_206625031_5_5,"Age Sibling 5 Non-Melanoma Cancer Diagnosed", "Age")
#boxp_funct(D_209771602_5_5_D_261863326_5_5,"Year Sibling 5 Non-Melanoma Cancer Diagnosed", "Year")
sib5_c21=boxp_funct(D_682651189_5_5_D_206625031_5_5,"Age Sibling 5 Ovarian Cancer Diagnosed", "Age") 
#boxp_funct(D_682651189_5_5_D_261863326_5_5,"Year Sibling 5 Ovarian Cancer Diagnosed", "Year") 
sib5_c22=boxp_funct(D_750994269_5_5_D_206625031_5_5,"Age Sibling 5 Pancreatic Cancer Diagnosed", "Age") 
#boxp_funct(D_750994269_5_5_D_261863326_5_5,"Year Sibling 5 Pancreatic Cancer Diagnosed", "Year") 
sib5_c23=boxp_funct(D_700889863_5_5_D_206625031_5_5,"Age Sibling 5 Prostate Cancer Diagnosed", "Age")
sib5_c24=boxp_funct(D_700889863_5_5_D_261863326_5_5,"Year Sibling 5 Prostate Cancer Diagnosed", "Year")
sib5_c25=boxp_funct(D_990114799_5_5_D_206625031_5_5,"Age Sibling 5 Stomach Cancer Diagnosed", "Age")
#boxp_funct(D_990114799_5_5_D_261863326_5_5,"Year Sibling 5 Stomach Cancer Diagnosed", "Year")
sib5_c26=boxp_funct(D_195363361_5_5_D_206625031_5_5,"Age Sibling 5 Testicular Cancer Diagnosed", "Age")
#boxp_funct(D_195363361_5_5_D_261863326_5_5,"Year Sibling 5 Testicular Cancer Diagnosed", "Year")
sib5_c27=boxp_funct(D_216840563_5_5_D_206625031_5_5,"Age Sibling 5 Thyroid Cancer Diagnosed", "Age")
#boxp_funct(D_216840563_5_5_D_261863326_5_5,"Year Sibling 5 Thyroid Cancer Diagnosed", "Year")
sib5_c28=boxp_funct(D_514034680_5_5_D_206625031_5_5,"Age Sibling 5 Uterine Cancer Diagnosed", "Age") 
sib5_c29=boxp_funct(D_514034680_5_5_D_261863326_5_5,"Year Sibling 5 Uterine Cancer Diagnosed", "Year") 
#boxp_funct(D_247160067_5_5_D_206625031_5_5,"Age Sibling 5 Other Cancer Diagnosed", "Age")
#boxp_funct(D_247160067_5_5_D_261863326_5_5,"Year Sibling 5 Other Cancer Diagnosed", "Year")
sib5_c30=boxp_funct(D_312545873_5_5_D_206625031_5_5,"Age Sibling 5 Unknown Cancer Diagnosed", "Age")
sib5_c31=boxp_funct(D_312545873_5_5_D_261863326_5_5,"Year Sibling 5 Unknown Cancer Diagnosed", "Year")

grid.arrange(sib5_c1, sib5_c2, sib5_c3, sib5_c4, nrow=4)
grid.arrange(sib5_c5, sib5_c6, sib5_c7, sib5_c8, nrow=4)
grid.arrange(sib5_c9, sib5_c10, sib5_c11, sib5_c12, nrow=4)
grid.arrange(sib5_c13, sib5_c14, sib5_c15, sib5_c16, nrow=4)
grid.arrange(sib5_c17, sib5_c18, sib5_c19, sib5_c20, nrow=4)
grid.arrange(sib5_c21, sib5_c22, sib5_c23, sib5_c24, nrow=4)
grid.arrange(sib5_c25, sib5_c26, sib5_c27, sib5_c28, nrow=4)
grid.arrange(sib5_c29, sib5_c30, sib5_c31,  nrow=3)



#boxp_funct(D_384881609_6_6_D_206625031_6_6,"Age Sibling 6 Anal Cancer Diagnosed", "Age")
#boxp_funct(D_384881609_6_6_D_261863326_6_6,"Year Sibling 6 Anal Cancer Diagnosed", "Year")
#boxp_funct(D_483975329_6_6_D_206625031_6_6,"Age Sibling 6 Bladder Cancer Diagnosed", "Age")
sib6_c1=boxp_funct(D_483975329_6_6_D_261863326_6_6,"Year Sibling 6 Bladder Cancer Diagnosed", "Year")
sib6_c2=boxp_funct(D_570279754_6_6_D_206625031_6_6,"Age Sibling 6 Brain Cancer Diagnosed", "Age")
#boxp_funct(D_570279754_6_6_D_261863326_6_6,"Year Sibling 6 Brain Cancer Diagnosed", "Year")
sib6_c3=boxp_funct(D_907590067_6_6_D_206625031_6_6,"Age Sibling 6 Breast Cancer Diagnosed", "Age")
sib6_c4=boxp_funct(D_907590067_6_6_D_261863326_6_6,"Year Sibling 6 Breast Cancer Diagnosed", "Year")
#boxp_funct(D_860112841_6_6_D_206625031_6_6,"Age Sibling 6 Cervical Cancer Diagnosed", "Age")
sib6_c5=boxp_funct(D_860112841_6_6_D_261863326_6_6,"Year Sibling 6 Cervical Cancer Diagnosed", "Year")
sib6_c6=boxp_funct(D_158354252_6_6_D_206625031_6_6,"Age Sibling 6 Colon Cancer Diagnosed", "Age")
sib6_c7=boxp_funct(D_158354252_6_6_D_261863326_6_6,"Year Sibling 6 Colon Cancer Diagnosed", "Year")
sib6_c8=boxp_funct(D_654594205_6_6_D_206625031_6_6,"Age Sibling 6 Esophageal Cancer Diagnosed", "Age") 
sib6_c9=boxp_funct(D_654594205_6_6_D_261863326_6_6,"Year Sibling 6 Esophageal Cancer Diagnosed", "Year") 
sib6_c10=boxp_funct(D_550722030_6_6_D_206625031_6_6,"Age Sibling 6 Heck Neck and Shoulders Cancer Diagnosed", "Age") 
#boxp_funct(D_550722030_6_6_D_261863326_6_6,"Year Sibling 6 Heck Neck and Shoulders Cancer Diagnosed", "Year")
sib6_c11=boxp_funct(D_142912472_6_6_D_206625031_6_6,"Age Sibling 6 Kidney Cancer Diagnosed", "Age") 
sib6_c12=boxp_funct(D_142912472_6_6_D_261863326_6_6,"Year Sibling 6 Kidney Cancer Diagnosed", "Year") 
sib6_c13=boxp_funct(D_158409298_6_6_D_206625031_6_6,"Age Sibling 6 Leukemia Cancer Diagnosed", "Age")
sib6_c14=boxp_funct(D_158409298_6_6_D_261863326_6_6,"Year Sibling 6 Leukemia Cancer Diagnosed", "Year")
#boxp_funct(D_529744595_6_6_D_206625031_6_6,"Age Sibling 6 Liver Cancer Diagnosed", "Age") 
sib6_c15=boxp_funct(D_529744595_6_6_D_261863326_6_6,"Year Sibling 6 Liver Cancer Diagnosed", "Year") 
sib6_c16=boxp_funct(D_315987564_6_6_D_206625031_6_6,"Age Sibling 6 Lung Cancer Diagnosed", "Age") 
#boxp_funct(D_315987564_6_6_D_261863326_6_6,"Year Sibling 6 Lung Cancer Diagnosed", "Year") 
sib6_c17=boxp_funct(D_852278004_6_6_D_206625031_6_6,"Age Sibling 6 Non-Hodgkins Lymphoma Cancer Diagnosed", "Age")
sib6_c18=boxp_funct(D_852278004_6_6_D_261863326_6_6,"Year Sibling 6 Non-Hodgkins Lymphoma Cancer Diagnosed", "Year")
sib6_c19=boxp_funct(D_391972881_6_6_D_206625031_6_6,"Age Sibling 6 Lymphoma Cancer Diagnosed", "Age") 
#boxp_funct(D_259089008_6_6_D_206625031_6_6,"Age Sibling 6 Melanoma Cancer Diagnosed", "Age")
#boxp_funct(D_259089008_6_6_D_261863326_6_6,"Year Sibling 6 Melanoma Cancer Diagnosed", "Year")
sib6_c20=boxp_funct(D_209771602_6_6_D_206625031_6_6,"Age Sibling 6 Non-Melanoma Cancer Diagnosed", "Age")
sib6_c21=boxp_funct(D_209771602_6_6_D_261863326_6_6,"Year Sibling 6 Non-Melanoma Cancer Diagnosed", "Year")
sib6_c22=boxp_funct(D_682651189_6_6_D_206625031_6_6,"Age Sibling 6 Ovarian Cancer Diagnosed", "Age") 
sib6_c23=boxp_funct(D_682651189_6_6_D_261863326_6_6,"Year Sibling 6 Ovarian Cancer Diagnosed", "Year") 
sib6_c24=boxp_funct(D_750994269_6_6_D_206625031_6_6,"Age Sibling 6 Pancreatic Cancer Diagnosed", "Age") 
#boxp_funct(D_750994269_6_6_D_261863326_6_6,"Year Sibling 6 Pancreatic Cancer Diagnosed", "Year") 
sib6_c25=boxp_funct(D_700889863_6_6_D_206625031_6_6,"Age Sibling 6 Prostate Cancer Diagnosed", "Age")
sib6_c26=boxp_funct(D_700889863_6_6_D_261863326_6_6,"Year Sibling 6 Prostate Cancer Diagnosed", "Year")
sib6_c27=boxp_funct(D_990114799_6_6_D_206625031_6_6,"Age Sibling 6 Stomach Cancer Diagnosed", "Age")
sib6_c28=boxp_funct(D_990114799_6_6_D_261863326_6_6,"Year Sibling 6 Stomach Cancer Diagnosed", "Year")
sib6_c29=boxp_funct(D_195363361_6_6_D_206625031_6_6,"Age Sibling 6 Testicular Cancer Diagnosed", "Age")
sib6_c30=boxp_funct(D_195363361_6_6_D_261863326_6_6,"Year Sibling 6 Testicular Cancer Diagnosed", "Year")
sib6_c31=boxp_funct(D_216840563_6_6_D_206625031_6_6,"Age Sibling 6 Thyroid Cancer Diagnosed", "Age")
#boxp_funct(D_216840563_6_6_D_261863326_6_6,"Year Sibling 6 Thyroid Cancer Diagnosed", "Year")
#boxp_funct(D_514034680_6_6_D_206625031_6_6,"Age Sibling 6 Uterine Cancer Diagnosed", "Age") 
sib6_c32=boxp_funct(D_514034680_6_6_D_261863326_6_6,"Year Sibling 6 Uterine Cancer Diagnosed", "Year") 
#boxp_funct(D_247160067_6_6_D_206625031_6_6,"Age Sibling 6 Other Cancer Diagnosed", "Age")
#boxp_funct(D_247160067_6_6_D_261863326_6_6,"Year Sibling 6 Other Cancer Diagnosed", "Year")
sib6_c33=boxp_funct(D_312545873_6_6_D_206625031_6_6,"Age Sibling 6 Unknown Cancer Diagnosed", "Age")
sib6_c34=boxp_funct(D_312545873_6_6_D_261863326_6_6,"Year Sibling 6 Unknown Cancer Diagnosed", "Year")

grid.arrange(sib6_c1, sib6_c2, sib6_c3, sib6_c4, nrow=4)
grid.arrange(sib6_c5, sib6_c6, sib6_c7, sib6_c8, nrow=4)
grid.arrange(sib6_c9, sib6_c10, sib6_c11, sib6_c12, nrow=4)
grid.arrange(sib6_c13, sib6_c14, sib6_c15, sib6_c16, nrow=4)
grid.arrange(sib6_c17, sib6_c18, sib6_c19, sib6_c20, nrow=4)
grid.arrange(sib6_c21, sib6_c22, sib6_c23, sib6_c24, nrow=4)
grid.arrange(sib6_c25, sib6_c26, sib6_c27, sib6_c28, nrow=4)
grid.arrange(sib6_c29, sib6_c30, sib6_c31, sib6_c32,  nrow=4)
grid.arrange(sib6_c33, sib6_c34, nrow=2)


# boxp_funct(D_384881609_7_7_D_206625031_7_7,"Age Sibling 7 Anal Cancer Diagnosed", "Age")
# boxp_funct(D_384881609_7_7_D_261863326_7_7,"Year Sibling 7 Anal Cancer Diagnosed", "Year")
# boxp_funct(D_483975329_7_7_D_206625031_7_7,"Age Sibling 7 Bladder Cancer Diagnosed", "Age")
# boxp_funct(D_483975329_7_7_D_261863326_7_7,"Year Sibling 7 Bladder Cancer Diagnosed", "Year")
# boxp_funct(D_570279754_7_7_D_206625031_7_7,"Age Sibling 7 Brain Cancer Diagnosed", "Age")
# boxp_funct(D_570279754_7_7_D_261863326_7_7,"Year Sibling 7 Brain Cancer Diagnosed", "Year")
# boxp_funct(D_907590067_7_7_D_206625031_7_7,"Age Sibling 7 Breast Cancer Diagnosed", "Age")
# boxp_funct(D_907590067_7_7_D_261863326_7_7,"Year Sibling 7 Breast Cancer Diagnosed", "Year")
# boxp_funct(D_860112841_7_7_D_206625031_7_7,"Age Sibling 7 Cervical Cancer Diagnosed", "Age")
# boxp_funct(D_860112841_7_7_D_261863326_7_7,"Year Sibling 7 Cervical Cancer Diagnosed", "Year")
# boxp_funct(D_158354252_7_7_D_206625031_7_7,"Age Sibling 7 Colon Cancer Diagnosed", "Age")
# boxp_funct(D_158354252_7_7_D_261863326_7_7,"Year Sibling 7 Colon Cancer Diagnosed", "Year")
# boxp_funct(D_654594205_7_7_D_206625031_7_7,"Age Sibling 7 Esophageal Cancer Diagnosed", "Age") 
# boxp_funct(D_654594205_7_7_D_261863326_7_7,"Year Sibling 7 Esophageal Cancer Diagnosed", "Year") 
# boxp_funct(D_550722030_7_7_D_206625031_7_7,"Age Sibling 7 Heck Neck and Shoulders Cancer Diagnosed", "Age") 
# boxp_funct(D_550722030_7_7_D_261863326_7_7,"Year Sibling 7 Heck Neck and Shoulders Cancer Diagnosed", "Year")
# boxp_funct(D_142912472_7_7_D_206625031_7_7,"Age Sibling 7 Kidney Cancer Diagnosed", "Age") 
# boxp_funct(D_142912472_7_7_D_261863326_7_7,"Year Sibling 7 Kidney Cancer Diagnosed", "Year") 
# boxp_funct(D_158409298_7_7_D_206625031_7_7,"Age Sibling 7 Leukemia Cancer Diagnosed", "Age")
# boxp_funct(D_158409298_7_7_D_261863326_7_7,"Year Sibling 7 Leukemia Cancer Diagnosed", "Year")
# boxp_funct(D_529744595_7_7_D_206625031_7_7,"Age Sibling 7 Liver Cancer Diagnosed", "Age") 
# boxp_funct(D_529744595_7_7_D_261863326_7_7,"Year Sibling 7 Liver Cancer Diagnosed", "Year") 
# boxp_funct(D_315987564_7_7_D_206625031_7_7,"Age Sibling 7 Lung Cancer Diagnosed", "Age") 
# boxp_funct(D_315987564_7_7_D_261863326_7_7,"Year Sibling 7 Lung Cancer Diagnosed", "Year") 
# boxp_funct(D_852278004_7_7_D_206625031_7_7,"Age Sibling 7 Non-Hodgkins Lymphoma Cancer Diagnosed", "Age")
# boxp_funct(D_852278004_7_7_D_261863326_7_7,"Year Sibling 7 Non-Hodgkins Lymphoma Cancer Diagnosed", "Year")
# boxp_funct(D_391972881_7_7_D_206625031_7_7,"Age Sibling 7 Lymphoma Cancer Diagnosed", "Age") 
# boxp_funct(D_259089008_7_7_D_206625031_7_7,"Age Sibling 7 Melanoma Cancer Diagnosed", "Age")
# boxp_funct(D_259089008_7_7_D_261863326_7_7,"Year Sibling 7 Melanoma Cancer Diagnosed", "Year")
# boxp_funct(D_209771602_7_7_D_206625031_7_7,"Age Sibling 7 Non-Melanoma Cancer Diagnosed", "Age")
# boxp_funct(D_209771602_7_7_D_261863326_7_7,"Year Sibling 7 Non-Melanoma Cancer Diagnosed", "Year")
# boxp_funct(D_682651189_7_7_D_206625031_7_7,"Age Sibling 7 Ovarian Cancer Diagnosed", "Age") 
# boxp_funct(D_682651189_7_7_D_261863326_7_7,"Year Sibling 7 Ovarian Cancer Diagnosed", "Year") 
# boxp_funct(D_750994269_7_7_D_206625031_7_7,"Age Sibling 7 Pancreatic Cancer Diagnosed", "Age") 
# boxp_funct(D_750994269_7_7_D_261863326_7_7,"Year Sibling 7 Pancreatic Cancer Diagnosed", "Year") 
# boxp_funct(D_700889863_7_7_D_206625031_7_7,"Age Sibling 7 Prostate Cancer Diagnosed", "Age")
# boxp_funct(D_700889863_7_7_D_261863326_7_7,"Year Sibling 7 Prostate Cancer Diagnosed", "Year")
# boxp_funct(D_990114799_7_7_D_206625031_7_7,"Age Sibling 7 Stomach Cancer Diagnosed", "Age")
# boxp_funct(D_990114799_7_7_D_261863326_7_7,"Year Sibling 7 Stomach Cancer Diagnosed", "Year")
# boxp_funct(D_195363361_7_7_D_206625031_7_7,"Age Sibling 7 Testicular Cancer Diagnosed", "Age")
# boxp_funct(D_195363361_7_7_D_261863326_7_7,"Year Sibling 7 Testicular Cancer Diagnosed", "Year")
# boxp_funct(D_216840563_7_7_D_206625031_7_7,"Age Sibling 7 Thyroid Cancer Diagnosed", "Age")
# boxp_funct(D_216840563_7_7_D_261863326_7_7,"Year Sibling 7 Thyroid Cancer Diagnosed", "Year")
# boxp_funct(D_514034680_7_7_D_206625031_7_7,"Age Sibling 7 Uterine Cancer Diagnosed", "Age") 
# boxp_funct(D_514034680_7_7_D_261863326_7_7,"Year Sibling 7 Uterine Cancer Diagnosed", "Year") 
# boxp_funct(D_247160067_7_7_D_206625031_7_7,"Age Sibling 7 Other Cancer Diagnosed", "Age")
# boxp_funct(D_247160067_7_7_D_261863326_7_7,"Year Sibling 7 Other Cancer Diagnosed", "Year")
# boxp_funct(D_312545873_7_7_D_206625031_7_7,"Age Sibling 7 Unknown Cancer Diagnosed", "Age")
# boxp_funct(D_312545873_7_7_D_261863326_7_7,"Year Sibling 7 Unknown Cancer Diagnosed", "Year")
# 
# 
# boxp_funct(D_384881609_8_8_D_206625031_8_8,"Age Sibling 8 Anal Cancer Diagnosed", "Age")
# boxp_funct(D_384881609_8_8_D_261863326_8_8,"Year Sibling 8 Anal Cancer Diagnosed", "Year")
# boxp_funct(D_483975329_8_8_D_206625031_8_8,"Age Sibling 8 Bladder Cancer Diagnosed", "Age")
# boxp_funct(D_483975329_8_8_D_261863326_8_8,"Year Sibling 8 Bladder Cancer Diagnosed", "Year")
# boxp_funct(D_570279754_8_8_D_206625031_8_8,"Age Sibling 8 Brain Cancer Diagnosed", "Age")
# boxp_funct(D_570279754_8_8_D_261863326_8_8,"Year Sibling 8 Brain Cancer Diagnosed", "Year")
# boxp_funct(D_907590067_8_8_D_206625031_8_8,"Age Sibling 8 Breast Cancer Diagnosed", "Age")
# boxp_funct(D_907590067_8_8_D_261863326_8_8,"Year Sibling 8 Breast Cancer Diagnosed", "Year")
# boxp_funct(D_860112841_8_8_D_206625031_8_8,"Age Sibling 8 Cervical Cancer Diagnosed", "Age")
# boxp_funct(D_860112841_8_8_D_261863326_8_8,"Year Sibling 8 Cervical Cancer Diagnosed", "Year")
# boxp_funct(D_158354252_8_8_D_206625031_8_8,"Age Sibling 8 Colon Cancer Diagnosed", "Age")
# boxp_funct(D_158354252_8_8_D_261863326_8_8,"Year Sibling 8 Colon Cancer Diagnosed", "Year")
# boxp_funct(D_654594205_8_8_D_206625031_8_8,"Age Sibling 8 Esophageal Cancer Diagnosed", "Age") 
# boxp_funct(D_654594205_8_8_D_261863326_8_8,"Year Sibling 8 Esophageal Cancer Diagnosed", "Year") 
# boxp_funct(D_550722030_8_8_D_206625031_8_8,"Age Sibling 8 Heck Neck and Shoulders Cancer Diagnosed", "Age") 
# boxp_funct(D_550722030_8_8_D_261863326_8_8,"Year Sibling 8 Heck Neck and Shoulders Cancer Diagnosed", "Year")
# boxp_funct(D_142912472_8_8_D_206625031_8_8,"Age Sibling 8 Kidney Cancer Diagnosed", "Age") 
# boxp_funct(D_142912472_8_8_D_261863326_8_8,"Year Sibling 8 Kidney Cancer Diagnosed", "Year") 
# boxp_funct(D_158409298_8_8_D_206625031_8_8,"Age Sibling 8 Leukemia Cancer Diagnosed", "Age")
# boxp_funct(D_158409298_8_8_D_261863326_8_8,"Year Sibling 8 Leukemia Cancer Diagnosed", "Year")
# boxp_funct(D_529744595_8_8_D_206625031_8_8,"Age Sibling 8 Liver Cancer Diagnosed", "Age") 
# boxp_funct(D_529744595_8_8_D_261863326_8_8,"Year Sibling 8 Liver Cancer Diagnosed", "Year") 
# boxp_funct(D_315987564_8_8_D_206625031_8_8,"Age Sibling 8 Lung Cancer Diagnosed", "Age") 
# boxp_funct(D_315987564_8_8_D_261863326_8_8,"Year Sibling 8 Lung Cancer Diagnosed", "Year") 
# boxp_funct(D_852278004_8_8_D_206625031_8_8,"Age Sibling 8 Non-Hodgkins Lymphoma Cancer Diagnosed", "Age")
# boxp_funct(D_852278004_8_8_D_261863326_8_8,"Year Sibling 8 Non-Hodgkins Lymphoma Cancer Diagnosed", "Year")
# boxp_funct(D_391972881_8_8_D_206625031_8_8,"Age Sibling 8 Lymphoma Cancer Diagnosed", "Age") 
# boxp_funct(D_259089008_8_8_D_206625031_8_8,"Age Sibling 8 Melanoma Cancer Diagnosed", "Age")
# boxp_funct(D_259089008_8_8_D_261863326_8_8,"Year Sibling 8 Melanoma Cancer Diagnosed", "Year")
# boxp_funct(D_209771602_8_8_D_206625031_8_8,"Age Sibling 8 Non-Melanoma Cancer Diagnosed", "Age")
# boxp_funct(D_209771602_8_8_D_261863326_8_8,"Year Sibling 8 Non-Melanoma Cancer Diagnosed", "Year")
# boxp_funct(D_682651189_8_8_D_206625031_8_8,"Age Sibling 8 Ovarian Cancer Diagnosed", "Age") 
# boxp_funct(D_682651189_8_8_D_261863326_8_8,"Year Sibling 8 Ovarian Cancer Diagnosed", "Year") 
# boxp_funct(D_750994269_8_8_D_206625031_8_8,"Age Sibling 8 Pancreatic Cancer Diagnosed", "Age") 
# boxp_funct(D_750994269_8_8_D_261863326_8_8,"Year Sibling 8 Pancreatic Cancer Diagnosed", "Year") 
# boxp_funct(D_700889863_8_8_D_206625031_8_8,"Age Sibling 8 Prostate Cancer Diagnosed", "Age")
# boxp_funct(D_700889863_8_8_D_261863326_8_8,"Year Sibling 8 Prostate Cancer Diagnosed", "Year")
# boxp_funct(D_990114799_8_8_D_206625031_8_8,"Age Sibling 8 Stomach Cancer Diagnosed", "Age")
# boxp_funct(D_990114799_8_8_D_261863326_8_8,"Year Sibling 8 Stomach Cancer Diagnosed", "Year")
# boxp_funct(D_195363361_8_8_D_206625031_8_8,"Age Sibling 8 Testicular Cancer Diagnosed", "Age")
# boxp_funct(D_195363361_8_8_D_261863326_8_8,"Year Sibling 8 Testicular Cancer Diagnosed", "Year")
# boxp_funct(D_216840563_8_8_D_206625031_8_8,"Age Sibling 8 Thyroid Cancer Diagnosed", "Age")
# boxp_funct(D_216840563_8_8_D_261863326_8_8,"Year Sibling 8 Thyroid Cancer Diagnosed", "Year")
# boxp_funct(D_514034680_8_8_D_206625031_8_8,"Age Sibling 8 Uterine Cancer Diagnosed", "Age") 
# boxp_funct(D_514034680_8_8_D_261863326_8_8,"Year Sibling 8 Uterine Cancer Diagnosed", "Year") 
# boxp_funct(D_247160067_8_8_D_206625031_8_8,"Age Sibling 8 Other Cancer Diagnosed", "Age")
# boxp_funct(D_247160067_8_8_D_261863326_8_8,"Year Sibling 8 Other Cancer Diagnosed", "Year")
# boxp_funct(D_312545873_8_8_D_206625031_8_8,"Age Sibling 8 Unknown Cancer Diagnosed", "Age")
# boxp_funct(D_312545873_8_8_D_261863326_8_8,"Year Sibling 8 Unknown Cancer Diagnosed", "Year")



```

\newpage

## Children
```{r Children, warning=FALSE, echo=FALSE, message=FALSE}
##Children 
#how many children do you have?
hist_funct(D_446999144, "Number of Children", "Children", "Frequency")


child_logic_funct(D_887697329_1_1, 1, "CHILD2_1: Child 1 Sex at Birth")
child_logic_funct(D_887697329_2_2, 2, "CHILD2_2: Child 2 Sex at Birth")
child_logic_funct(D_887697329_3_3, 3, "CHILD2_3: Child 3 Sex at Birth")
child_logic_funct(D_887697329_4_4, 4, "CHILD2_4: Child 4 Sex at Birth")
child_logic_funct(D_887697329_5_5, 5, "CHILD2_5: Child 5 Sex at Birth")
child_logic_funct(D_887697329_6_6, 6, "CHILD2_6: Child 6 Sex at Birth")
child_logic_funct(D_887697329_7_7, 7, "CHILD2_7: Child 7 Sex at Birth")
child_logic_funct(D_887697329_8_8, 8, "CHILD2_8: Child 8 Sex at Birth")



child_logic_funct(D_473529484_1_1, 1, "CHILDMULT_1: Child 1 a Twin or Multiple")
child_logic_funct(D_473529484_2_2, 2, "CHILDMULT_2: Child 2 a Twin or Multiple")
child_logic_funct(D_473529484_3_3, 3, "CHILDMULT_3: Child 3 a Twin or Multiple")
child_logic_funct(D_473529484_4_4, 4, "CHILDMULT_4: Child 4 a Twin or Multiple")
child_logic_funct(D_473529484_5_5, 5, "CHILDMULT_5: Child 5 a Twin or Multiple")
child_logic_funct(D_473529484_6_6, 6, "CHILDMULT_6: Child 6 a Twin or Multiple")
child_logic_funct(D_473529484_7_7, 7, "CHILDMULT_7: Child 7 a Twin or Multiple")
child_logic_funct(D_473529484_8_8, 8, "CHILDMULT_8: Child 8 a Twin or Multiple")



child_logic_funct(D_873968217_1_1, 1, "CHILD3_1: Child 1 Family Relation")
child_logic_funct(D_873968217_2_2, 2, "CHILD3_2: Child 2 Family Relation")
child_logic_funct(D_873968217_3_3, 3, "CHILD3_3: Child 3 Family Relation")
child_logic_funct(D_873968217_4_4, 4, "CHILD3_4: Child 4 Family Relation")
child_logic_funct(D_873968217_5_5, 5, "CHILD3_5: Child 5 Family Relation")
child_logic_funct(D_873968217_6_6, 6, "CHILD3_6: Child 6 Family Relation")
child_logic_funct(D_873968217_7_7, 7, "CHILD3_7: Child 7 Family Relation")
child_logic_funct(D_873968217_8_8, 8, "CHILD3_8: Child 8 Family Relation")



child_logic_funct(D_418392907_1_1, 1, "CHILD4_1: Child 1 Still Living")
child_logic_funct(D_418392907_2_2, 2, "CHILD4_2: Child 2 Still Living")
child_logic_funct(D_418392907_3_3, 3, "CHILD4_3: Child 3 Still Living")
child_logic_funct(D_418392907_4_4, 4, "CHILD4_4: Child 4 Still Living")
child_logic_funct(D_418392907_5_5, 5, "CHILD4_5: Child 5 Still Living")
child_logic_funct(D_418392907_6_6, 6, "CHILD4_6: Child 6 Still Living")
child_logic_funct(D_418392907_7_7, 7, "CHILD4_7: Child 7 Still Living")
child_logic_funct(D_418392907_8_8, 8, "CHILD4_8: Child 8 Still Living")




ch1_age=boxp_funct(D_640010727_1_1_D_299300933_1,"Age of Child 1 Today", "Age")
ch2_age=boxp_funct(D_640010727_2_2_D_299300933_2,"Age of Child 2 Today", "Age")
ch3_age=boxp_funct(D_640010727_3_3_D_299300933_3,"Age of Child 3 Today", "Age")
ch4_age=boxp_funct(D_640010727_4_4_D_299300933_4,"Age of Child 4 Today", "Age")
ch5_age=boxp_funct(D_640010727_5_5_D_299300933_5,"Age of Child 5 Today", "Age")
ch6_age=boxp_funct(D_640010727_6_6_D_299300933_6,"Age of Child 6 Today", "Age")
ch7_age=boxp_funct(D_640010727_7_7_D_299300933_7,"Age of Child 7 Today", "Age")
ch8_age=boxp_funct(D_640010727_8_8_D_299300933_8,"Age of Child 8 Today", "Age")

grid.arrange(ch1_age,ch2_age,ch3_age,ch4_age, nrow=2)
grid.arrange(ch5_age,ch6_age, ch7_age, ch8_age, nrow=2)


#1
dt_ch1_d_age= data_tib_m1  %>%  filter(D_446999144>0) #is.na(D_640010727_1_1_D_299300933_1) & 

child1= dt_ch1_d_age  %>%  mutate(oth_age= case_when(!is.na(D_640010727_1_1_D_299300933_1) | D_640010727_1_1_D_640010727_1_1=="[]" ~ "Answered with Age",
                                                     D_640010727_1_1_D_640010727_1_1=="[958239616]" ~ "Less than 1 Year",
                                                     D_640010727_1_1_D_640010727_1_1=="[178420302]" ~ "Uknown",
                                                     TRUE ~ "Skipped this Question"))

dt_ch1_d_age_summary <- child1 %>%  dplyr::group_by(oth_age) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(oth_age, n, percentage)

dt_ch1_d_age_summary %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("CHILDAGE: Child 1 Less Than One Year Old or Do Not Know Age ")) %>% 
  cols_label(n= md("**N**"), oth_age = md("**Answer**"), percentage = md("**%**")) %>% 
  # summary_rows( groups=F, column = c(n,percentage), fns= list(Sum= ~sum(.)), decimals=0) %>%
  grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(stub.font.weight = "bold") %>%
  tab_style(style = list(cell_text(weight = "bold")),
            locations = cells_body(columns = oth_age,)) 

#2
dt_ch2_d_age= data_tib_m1  %>%   filter(D_446999144>1)

child2= dt_ch2_d_age  %>%  mutate(oth_age= case_when(!is.na(D_640010727_2_2_D_299300933_2) | D_640010727_2_2_D_640010727_2_2=="[]" ~ "Answered with Age",
                                                     D_640010727_2_2_D_640010727_2_2=="[958239616]" ~ "Less than 1 Year",
                                                     D_640010727_2_2_D_640010727_2_2=="[178420302]" ~ "Uknown",
                                                     TRUE ~ "Skipped this Question"))

dt_ch2_d_age_summary <- child2 %>% dplyr::group_by(oth_age) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(oth_age, n, percentage)

dt_ch2_d_age_summary %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("CHILDAGE: Child 2 Less Than One Year Old or Do Not Know Age ")) %>% 
  cols_label(n= md("**N**"), oth_age = md("**Answer**"), percentage = md("**%**")) %>% 
  #summary_rows( groups=F, column = c(n,percentage), fns= list(Sum= ~sum(.)), decimals=0) %>%
  grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(stub.font.weight = "bold") %>%
  tab_style(style = list(cell_text(weight = "bold")),
            locations = cells_body(columns = oth_age,)) 


#3
dt_ch3_d_age= data_tib_m1 %>% filter(D_446999144>2)

child3= dt_ch3_d_age  %>%  mutate(oth_age= case_when(!is.na(D_640010727_3_3_D_299300933_3) | D_640010727_3_3_D_640010727_3_3=="[]" ~ "Answered with Age",
                                                     D_640010727_3_3_D_640010727_3_3=="[958239616]" ~ "Less than 1 Year",
                                                     D_640010727_3_3_D_640010727_3_3=="[178420302]" ~ "Uknown",
                                                     TRUE ~ "Skipped this Question"))

dt_ch3_d_age_summary <- child3 %>% dplyr::group_by(oth_age) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(oth_age, n, percentage)

dt_ch3_d_age_summary %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("CHILDAGE: Child 3 Less Than One Year Old or Do Not Know Age ")) %>% 
  cols_label(n= md("**N**"), oth_age = md("**Answer**"), percentage = md("**%**")) %>% 
  #summary_rows( groups=F, column = c(n,percentage), fns= list(Sum= ~sum(.)), decimals=0) %>%
  grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(stub.font.weight = "bold") %>%
  tab_style(style = list(cell_text(weight = "bold")),
            locations = cells_body(columns = oth_age,)) 


#4
dt_ch4_d_age= data_tib_m1    %>% filter(D_446999144>3)

child4= dt_ch4_d_age  %>%  mutate(oth_age= case_when(!is.na(D_640010727_4_4_D_299300933_4) | D_640010727_4_4_D_640010727_4_4=="[]" ~ "Answered with Age",
                                                     D_640010727_4_4_D_640010727_4_4=="[958239616]" ~ "Less than 1 Year",
                                                     D_640010727_4_4_D_640010727_4_4=="[178420302]" ~ "Uknown",
                                                     D_640010727_4_4_D_640010727_4_4=="[]" ~ "Answered with age",
                                                     TRUE ~ "Skipped this Question"))

dt_ch4_d_age_summary <- child4 %>% dplyr::group_by(oth_age) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(oth_age, n, percentage)

dt_ch4_d_age_summary %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("CHILDAGE: Child 4 Less Than One Year Old or Do Not Know Age ")) %>% 
  cols_label(n= md("**N**"), oth_age = md("**Answer**"), percentage = md("**%**")) %>% 
  #summary_rows( groups=F, column = c(n,percentage), fns= list(Sum= ~sum(.)), decimals=0) %>%
  grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(stub.font.weight = "bold") %>%
  tab_style(style = list(cell_text(weight = "bold")),
            locations = cells_body(columns = oth_age,)) 

#5
dt_ch5_d_age= data_tib_m1  %>% filter(D_446999144>4)

child5= dt_ch5_d_age  %>%  mutate(oth_age= case_when(!is.na(D_640010727_5_5_D_299300933_5) | D_640010727_5_5_D_640010727_5_5=="[]" ~ "Answered with Age",
                                                     D_640010727_5_5_D_640010727_5_5=="[958239616]" ~ "Less than 1 Year",
                                                     D_640010727_5_5_D_640010727_5_5=="[178420302]" ~ "Uknown",
                                                     D_640010727_5_5_D_640010727_5_5=="[]" ~ "Answered with age",
                                                     TRUE ~ "Skipped this Question"))

dt_ch5_d_age_summary <- child5 %>% dplyr::group_by(oth_age) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(oth_age, n, percentage) 

dt_ch5_d_age_summary %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("CHILDAGE: Child 5 Less Than One Year Old or Do Not Know Age ")) %>% 
  cols_label(n= md("**N**"), oth_age = md("**Answer**"), percentage = md("**%**")) %>% 
  #summary_rows( groups=F, column = c(n,percentage), fns= list(Sum= ~sum(.)), decimals=0) %>%
  grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(stub.font.weight = "bold") %>%
  tab_style(style = list(cell_text(weight = "bold")),
            locations = cells_body(columns = oth_age,)) 

#6
dt_ch6_d_age= data_tib_m1  %>% filter(D_446999144>5)

child6= dt_ch6_d_age  %>%  mutate(oth_age= case_when(!is.na(D_640010727_6_6_D_299300933_6) | D_640010727_6_6_D_640010727_6_6=="[]" ~ "Answered with Age",
                                                     D_640010727_6_6_D_640010727_6_6=="[958239616]" ~ "Less than 1 Year",
                                                     D_640010727_6_6_D_640010727_6_6=="[178420302]" ~ "Uknown",
                                                     D_640010727_6_6_D_640010727_6_6=="[]" ~ "Answered with age",
                                                     TRUE ~ "Skipped this Question"))

dt_ch6_d_age_summary <- child6 %>% dplyr::group_by(oth_age) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(oth_age, n, percentage) 

dt_ch6_d_age_summary %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("CHILDAGE: Child 6 Less Than One Year Old or Do Not Know Age ")) %>% 
  cols_label(n= md("**N**"), oth_age = md("**Answer**"), percentage = md("**%**")) %>% 
  #summary_rows( groups=F, column = c(n,percentage), fns= list(Sum= ~sum(.)), decimals=0) %>%
  grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(stub.font.weight = "bold") %>%
  tab_style(style = list(cell_text(weight = "bold")),
            locations = cells_body(columns = oth_age,)) 




ch1_age_d=boxp_funct(D_236590500_1_1_D_182786508_1,"Age of Child 1 at Death", "Age")
ch2_age_d=boxp_funct(D_236590500_2_2_D_182786508_2,"Age of Child 2 at Death", "Age")
ch3_age_d=boxp_funct(D_236590500_3_3_D_182786508_3,"Age of Child 3 at Death", "Age")
ch4_age_d=boxp_funct(D_236590500_4_4_D_182786508_4,"Age of Child 4 at Death", "Age")
ch5_age_d=boxp_funct(D_236590500_5_5_D_182786508_5,"Age of Child 5 at Death", "Age")
ch6_age_d=boxp_funct(D_236590500_6_6_D_182786508_6,"Age of Child 6 at Death", "Age")

grid.arrange(ch1_age_d,ch2_age_d,ch3_age_d, ch4_age_d,ch5_age_d, ch6_age_d, nrow=3) 
 



#1
dt_chd1_d_age= data_tib_m1  %>%   filter(D_418392907_1_1==104430631)

child1= dt_chd1_d_age  %>%  mutate(oth_age= case_when(D_236590500_1_1_D_236590500_1_1=="[958239616]" ~ "Less than 1 Year",
                                                      D_236590500_1_1_D_236590500_1_1=="[178420302]" ~ "Uknown",
                                                      D_236590500_1_1_D_236590500_1_1=="[]" ~ "Answered with age",
                                                      TRUE ~ "Skipped this Question"))

dt_chd1_d_age_summary <- child1 %>% dplyr::group_by(oth_age) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(oth_age, n, percentage) 

dt_chd1_d_age_summary %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("CHILDDEATH: Child 1 Died Less Than One Year Old or Do Not Know Age at Death ")) %>% 
  cols_label(n= md("**N**"), oth_age = md("**Answer**"), percentage = md("**%**")) %>% 
  #summary_rows( groups=F, column = c(n,percentage), fns= list(Sum= ~sum(.)), decimals=0) %>%
  grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(stub.font.weight = "bold") %>%
  tab_style(style = list(cell_text(weight = "bold")),
            locations = cells_body(columns = oth_age,)) 

#2
dt_chd2_d_age= data_tib_m1  %>%  filter(D_418392907_2_2==104430631)

child2= dt_chd2_d_age  %>%  mutate(oth_age= case_when(D_236590500_2_2_D_236590500_2_2=="[958239616]" ~ "Less than 1 Year",
                                                      D_236590500_2_2_D_236590500_2_2=="[178420302]" ~ "Uknown",
                                                      D_236590500_2_2_D_236590500_2_2=="[]" ~ "Answered with age",
                                                      TRUE ~ "Skipped this Question"))

dt_chd2_d_age_summary <- child2 %>% dplyr::group_by(oth_age) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(oth_age, n, percentage) 

dt_chd2_d_age_summary %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("CHILDDEATH: Child 2 Died Less Than One Year Old or Do Not Know Age at Death ")) %>% 
  cols_label(n= md("**N**"), oth_age = md("**Answer**"), percentage = md("**%**")) %>% 
  #summary_rows( groups=F, column = c(n,percentage), fns= list(Sum= ~sum(.)), decimals=0) %>%
  grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(stub.font.weight = "bold") %>%
  tab_style(style = list(cell_text(weight = "bold")),
            locations = cells_body(columns = oth_age,)) 


#3
dt_chd3_d_age= data_tib_m1   %>% filter(D_418392907_3_3==104430631)

child3= dt_chd3_d_age  %>%  mutate(oth_age= case_when(D_236590500_3_3_D_236590500_3_3=="[958239616]" ~ "Less than 1 Year",
                                                      D_236590500_3_3_D_236590500_3_3=="[178420302]" ~ "Uknown",
                                                      D_236590500_3_3_D_236590500_3_3=="[]" ~ "Answered with age",
                                                      TRUE ~ "Skipped this Question"))

dt_chd3_d_age_summary <- child3 %>% dplyr::group_by(oth_age) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(oth_age, n, percentage)

dt_chd3_d_age_summary %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("CHILDDEATH: Child 3 Died Less Than One Year Old or Do Not Know Age at Death ")) %>% 
  cols_label(n= md("**N**"), oth_age = md("**Answer**"), percentage = md("**%**")) %>% 
  #summary_rows( groups=F, column = c(n,percentage), fns= list(Sum= ~sum(.)), decimals=0) %>%
  grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(stub.font.weight = "bold") %>%
  tab_style(style = list(cell_text(weight = "bold")),
            locations = cells_body(columns = oth_age,)) 


#4
dt_chd4_d_age= data_tib_m1 %>% filter(D_418392907_4_4==104430631)

child4= dt_chd4_d_age  %>%  mutate(oth_age= case_when(D_236590500_4_4_D_236590500_4_4=="[958239616]" ~ "Less than 1 Year",
                                                      D_236590500_4_4_D_236590500_4_4=="[178420302]" ~ "Uknown",
                                                      D_236590500_4_4_D_236590500_4_4=="[]" ~ "Answered with age",
                                                      TRUE ~ "Skipped this Question"))

dt_chd4_d_age_summary <- child4 %>%  dplyr::group_by(oth_age) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(oth_age, n, percentage)

dt_chd4_d_age_summary %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("CHILDDEATH: Child 4 Died Less Than One Year Old or Do Not Know Age at Death ")) %>% 
  cols_label(n= md("**N**"), oth_age = md("**Answer**"), percentage = md("**%**")) %>% 
 #summary_rows( groups=F, column = c(n,percentage), fns= list(Sum= ~sum(.)), decimals=0) %>%
  grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(stub.font.weight = "bold") %>%
  tab_style(style = list(cell_text(weight = "bold")),
            locations = cells_body(columns = oth_age,)) 

#5
dt_chd5_d_age= data_tib_m1 %>% filter(D_418392907_5_5==104430631)

child5= dt_chd5_d_age  %>%  mutate(oth_age= case_when(D_236590500_5_5_D_236590500_5_5=="[958239616]" ~ "Less than 1 Year",
                                                      D_236590500_5_5_D_236590500_5_5=="[178420302]" ~ "Uknown",
                                                      D_236590500_5_5_D_236590500_5_5=="[]" ~ "Answered with age",
                                                      TRUE ~ "Skipped this Question"))

dt_chd5_d_age_summary <- child5 %>%  dplyr::group_by(oth_age) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(oth_age, n, percentage)

dt_chd5_d_age_summary %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("CHILDDEATH: Child 5 Died Less Than One Year Old or Do Not Know Age at Death ")) %>% 
  cols_label(n= md("**N**"), oth_age = md("**Answer**"), percentage = md("**%**")) %>% 
  #summary_rows( groups=F, column = c(n,percentage), fns= list(Sum= ~sum(.)), decimals=0) %>%
  grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(stub.font.weight = "bold") %>%
  tab_style(style = list(cell_text(weight = "bold")),
            locations = cells_body(columns = oth_age,)) 

#6
dt_chd6_d_age= data_tib_m1  %>% filter(D_418392907_6_6==104430631)

child6= dt_chd6_d_age  %>%  mutate(oth_age= case_when(D_236590500_6_6_D_236590500_6_6=="[958239616]" ~ "Less than 1 Year",
                                                      D_236590500_6_6_D_236590500_6_6=="[178420302]" ~ "Uknown",
                                                      D_236590500_6_6_D_236590500_6_6=="[]" ~ "Answered with age",
                                                      TRUE ~ "Skipped this Question"))

dt_chd6_d_age_summary <- child6 %>%  dplyr::group_by(oth_age) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(oth_age, n, percentage)

dt_chd6_d_age_summary %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("CHILDDEATH: Child 6 Died Less Than One Year Old or Do Not Know Age at Death ")) %>% 
  cols_label(n= md("**N**"), oth_age = md("**Answer**"), percentage = md("**%**")) %>% 
  #summary_rows( groups=F, column = c(n,percentage), fns= list(Sum= ~sum(.)), decimals=0) %>%
  grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(stub.font.weight = "bold") %>%
  tab_style(style = list(cell_text(weight = "bold")),
            locations = cells_body(columns = oth_age,)) 


#CHILDCANC
CHILDcanc1= data_tib_m1  %>%  filter(as.numeric(D_446999144) >0) %>%  mutate(status= case_when((D_718867914_1_1==353358909 |D_718867914_2_2==353358909 | D_718867914_3_3==353358909 | 
                                                                                                    D_718867914_4_4==353358909 | D_718867914_5_5==353358909 |
                                      D_718867914_6_6==353358909 | D_718867914_7_7==353358909 | D_718867914_8_8==353358909 | D_718867914_9_9==353358909 |
                                      D_718867914_10_10==353358909) ~ "Child Diagnosed",
                                      (D_718867914_1_1==104430631 |D_718867914_2_2==104430631 | D_718867914_3_3==104430631 | 
                                                                                                    D_718867914_4_4==104430631 | D_718867914_5_5==104430631 |
                                      D_718867914_6_6==104430631 | D_718867914_7_7==104430631 | D_718867914_8_8==104430631 | D_718867914_9_9==104430631 |
                                      D_718867914_10_10==104430631) ~ "No Child Diagnosed",
                                                    TRUE ~ "Skipped this Question"))

dt_CHILDcanc1_summary <- CHILDcanc1 %>% dplyr::group_by(status) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(status, n, percentage) 


dt_CHILDcanc1_summary %>%  gt::gt(rowname_col = "row_lab") %>%  ## why is this not a proper gt_tbl??
  fmt_number(columns = "percentage", decimals = 2) %>%
  tab_header(title = md("CHILDCANC: Children 1-10 Diagnosed with Cancer")) %>%
  cols_label(status = md("**Diagnosed**"), n = md("**N**"), percentage = md("**%**")) %>%
    # summary_rows(
    # column = c(n,percentage),
    # fns= list(
    #   Sum= ~sum(.)
    # ), decimals=0) %>%
  grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = status,
    )
  ) 


#CHILCANC2

kid <- CHILDcanc1 %>%  filter(status=="Child Diagnosed")



kid= kid  %>%  mutate(multc1 = ifelse(D_812370563_1_1_D_812370563_1_1_D_939782495==1, 1, 0) + ifelse(D_812370563_1_1_D_812370563_1_1_D_135725957==1, 1, 0) + ifelse(D_812370563_1_1_D_812370563_1_1_D_518416174==1, 1, 0) + ifelse(D_812370563_1_1_D_812370563_1_1_D_847945207==1, 1, 0) + ifelse(D_812370563_1_1_D_812370563_1_1_D_942970912==1, 1, 0) + ifelse(D_812370563_1_1_D_812370563_1_1_D_596122041==1, 1, 0) + ifelse(D_812370563_1_1_D_812370563_1_1_D_489400183==1, 1, 0) + ifelse(D_812370563_1_1_D_812370563_1_1_D_863246236==1, 1, 0) + ifelse(D_812370563_1_1_D_812370563_1_1_D_607793249==1, 1, 0) + ifelse(D_812370563_1_1_D_812370563_1_1_D_532172400==1, 1, 0) + ifelse(D_812370563_1_1_D_812370563_1_1_D_754745617==1, 1, 0) + ifelse(D_812370563_1_1_D_812370563_1_1_D_665036297==1, 1, 0) + ifelse(D_812370563_1_1_D_812370563_1_1_D_200837530==1, 1, 0) + ifelse(D_812370563_1_1_D_812370563_1_1_D_990319383==1, 1, 0) + ifelse(D_812370563_1_1_D_812370563_1_1_D_482225200==1, 1, 0) + ifelse(D_812370563_1_1_D_812370563_1_1_D_764891959==1, 1, 0) + ifelse(D_812370563_1_1_D_812370563_1_1_D_139822395==1, 1, 0) + ifelse(D_812370563_1_1_D_812370563_1_1_D_248374037==1, 1, 0) + ifelse(D_812370563_1_1_D_812370563_1_1_D_807835037==1, 1, 0) + ifelse(D_812370563_1_1_D_812370563_1_1_D_487917585==1, 1, 0) + ifelse(D_812370563_1_1_D_812370563_1_1_D_295976386==1, 1, 0),
                              multc2 = ifelse(D_812370563_2_2_D_812370563_2_2_D_939782495==1, 1, 0) + ifelse(D_812370563_2_2_D_812370563_2_2_D_135725957==1, 1, 0) + ifelse(D_812370563_2_2_D_812370563_2_2_D_518416174==1, 1, 0) + ifelse(D_812370563_2_2_D_812370563_2_2_D_847945207==1, 1, 0) + ifelse(D_812370563_2_2_D_812370563_2_2_D_942970912==1, 1, 0) + ifelse(D_812370563_2_2_D_812370563_2_2_D_596122041==1, 1, 0) + ifelse(D_812370563_2_2_D_812370563_2_2_D_489400183==1, 1, 0) + ifelse(D_812370563_2_2_D_812370563_2_2_D_863246236==1, 1, 0) + ifelse(D_812370563_2_2_D_812370563_2_2_D_607793249==1, 1, 0) + ifelse(D_812370563_2_2_D_812370563_2_2_D_532172400==1, 1, 0) + ifelse(D_812370563_2_2_D_812370563_2_2_D_754745617==1, 1, 0) + ifelse(D_812370563_2_2_D_812370563_2_2_D_665036297==1, 1, 0) + ifelse(D_812370563_2_2_D_812370563_2_2_D_200837530==1, 1, 0) + ifelse(D_812370563_2_2_D_812370563_2_2_D_990319383==1, 1, 0) + ifelse(D_812370563_2_2_D_812370563_2_2_D_482225200==1, 1, 0) + ifelse(D_812370563_2_2_D_812370563_2_2_D_764891959==1, 1, 0) + ifelse(D_812370563_2_2_D_812370563_2_2_D_139822395==1, 1, 0) + ifelse(D_812370563_2_2_D_812370563_2_2_D_248374037==1, 1, 0) + ifelse(D_812370563_2_2_D_812370563_2_2_D_807835037==1, 1, 0) + ifelse(D_812370563_2_2_D_812370563_2_2_D_487917585==1, 1, 0) + ifelse(D_812370563_2_2_D_812370563_2_2_D_295976386==1, 1, 0),
                              multc3 = ifelse(D_812370563_3_3_D_812370563_3_3_D_939782495==1, 1, 0) + ifelse(D_812370563_3_3_D_812370563_3_3_D_135725957==1, 1, 0) + ifelse(D_812370563_3_3_D_812370563_3_3_D_518416174==1, 1, 0) + ifelse(D_812370563_3_3_D_812370563_3_3_D_847945207==1, 1, 0) + ifelse(D_812370563_3_3_D_812370563_3_3_D_942970912==1, 1, 0) + ifelse(D_812370563_3_3_D_812370563_3_3_D_596122041==1, 1, 0) + ifelse(D_812370563_3_3_D_812370563_3_3_D_489400183==1, 1, 0) + ifelse(D_812370563_3_3_D_812370563_3_3_D_863246236==1, 1, 0) + ifelse(D_812370563_3_3_D_812370563_3_3_D_607793249==1, 1, 0) + ifelse(D_812370563_3_3_D_812370563_3_3_D_532172400==1, 1, 0) + ifelse(D_812370563_3_3_D_812370563_3_3_D_754745617==1, 1, 0) + ifelse(D_812370563_3_3_D_812370563_3_3_D_665036297==1, 1, 0) + ifelse(D_812370563_3_3_D_812370563_3_3_D_200837530==1, 1, 0) + ifelse(D_812370563_3_3_D_812370563_3_3_D_990319383==1, 1, 0) + ifelse(D_812370563_3_3_D_812370563_3_3_D_482225200==1, 1, 0) + ifelse(D_812370563_3_3_D_812370563_3_3_D_764891959==1, 1, 0) + ifelse(D_812370563_3_3_D_812370563_3_3_D_139822395==1, 1, 0) + ifelse(D_812370563_3_3_D_812370563_3_3_D_248374037==1, 1, 0) + ifelse(D_812370563_3_3_D_812370563_3_3_D_807835037==1, 1, 0) + ifelse(D_812370563_3_3_D_812370563_3_3_D_487917585==1, 1, 0) + ifelse(D_812370563_3_3_D_812370563_3_3_D_295976386==1, 1, 0),
                              multc4 = ifelse(D_812370563_4_4_D_812370563_4_4_D_939782495==1, 1, 0) + ifelse(D_812370563_4_4_D_812370563_4_4_D_135725957==1, 1, 0) + ifelse(D_812370563_4_4_D_812370563_4_4_D_518416174==1, 1, 0) + ifelse(D_812370563_4_4_D_812370563_4_4_D_847945207==1, 1, 0) + ifelse(D_812370563_4_4_D_812370563_4_4_D_942970912==1, 1, 0) + ifelse(D_812370563_4_4_D_812370563_4_4_D_596122041==1, 1, 0) + ifelse(D_812370563_4_4_D_812370563_4_4_D_489400183==1, 1, 0) + ifelse(D_812370563_4_4_D_812370563_4_4_D_863246236==1, 1, 0) + ifelse(D_812370563_4_4_D_812370563_4_4_D_607793249==1, 1, 0) + ifelse(D_812370563_4_4_D_812370563_4_4_D_532172400==1, 1, 0) + ifelse(D_812370563_4_4_D_812370563_4_4_D_754745617==1, 1, 0) + ifelse(D_812370563_4_4_D_812370563_4_4_D_665036297==1, 1, 0) + ifelse(D_812370563_4_4_D_812370563_4_4_D_200837530==1, 1, 0) + ifelse(D_812370563_4_4_D_812370563_4_4_D_990319383==1, 1, 0) + ifelse(D_812370563_4_4_D_812370563_4_4_D_482225200==1, 1, 0) + ifelse(D_812370563_4_4_D_812370563_4_4_D_764891959==1, 1, 0) + ifelse(D_812370563_4_4_D_812370563_4_4_D_139822395==1, 1, 0) + ifelse(D_812370563_4_4_D_812370563_4_4_D_248374037==1, 1, 0) + ifelse(D_812370563_4_4_D_812370563_4_4_D_807835037==1, 1, 0) + ifelse(D_812370563_4_4_D_812370563_4_4_D_487917585==1, 1, 0) + ifelse(D_812370563_4_4_D_812370563_4_4_D_295976386==1, 1, 0))

body_kid= kid  %>%  mutate(bodyp= case_when((as.numeric(multc1)>1 | as.numeric(multc2)>1 | as.numeric(multc3)>1 | as.numeric(multc4)>1) ~ "Multiple Cancer Types",
                                            (D_812370563_1_1_D_812370563_1_1_D_939782495==1 | D_812370563_2_2_D_812370563_2_2_D_939782495==1 | D_812370563_3_3_D_812370563_3_3_D_939782495==1 | D_812370563_4_4_D_812370563_4_4_D_939782495==1) ~ "Anal",
                                                     (D_812370563_1_1_D_812370563_1_1_D_135725957==1 | D_812370563_2_2_D_812370563_2_2_D_135725957==1 | D_812370563_3_3_D_812370563_3_3_D_135725957==1 | D_812370563_4_4_D_812370563_4_4_D_135725957==1) ~ "Bladder",
                                                     (D_812370563_1_1_D_812370563_1_1_D_518416174==1 | D_812370563_2_2_D_812370563_2_2_D_518416174==1 | D_812370563_3_3_D_812370563_3_3_D_518416174==1 | D_812370563_4_4_D_812370563_4_4_D_518416174==1) ~ "Brain",
                                                     (D_812370563_1_1_D_812370563_1_1_D_847945207==1 | D_812370563_2_2_D_812370563_2_2_D_847945207==1 | D_812370563_3_3_D_812370563_3_3_D_847945207==1 | D_812370563_4_4_D_812370563_4_4_D_847945207==1) ~ "Breast",
                                                     (D_812370563_1_1_D_812370563_1_1_D_283025574==1 | D_812370563_2_2_D_812370563_2_2_D_283025574==1 | D_812370563_3_3_D_812370563_3_3_D_283025574==1 | D_812370563_4_4_D_812370563_4_4_D_283025574==1) ~ "Cerivical",
                                                     (D_812370563_1_1_D_812370563_1_1_D_942970912==1 | D_812370563_2_2_D_812370563_2_2_D_942970912==1 | D_812370563_3_3_D_812370563_3_3_D_942970912==1 | D_812370563_4_4_D_812370563_4_4_D_942970912==1) ~ "Colon/Rectal",
                                                     (D_812370563_1_1_D_812370563_1_1_D_596122041==1 | D_812370563_2_2_D_812370563_2_2_D_596122041==1 | D_812370563_3_3_D_812370563_3_3_D_596122041==1 | D_812370563_4_4_D_812370563_4_4_D_596122041==1 ) ~ "Esophageal",
                                                     (D_812370563_1_1_D_812370563_1_1_D_489400183==1 | D_812370563_2_2_D_812370563_2_2_D_489400183==1 | D_812370563_3_3_D_812370563_3_3_D_489400183==1 | D_812370563_4_4_D_812370563_4_4_D_489400183==1) ~ "Head, Neck, and Shoulders",
                                                     (D_812370563_1_1_D_812370563_1_1_D_863246236==1 | D_812370563_2_2_D_812370563_2_2_D_863246236==1 | D_812370563_3_3_D_812370563_3_3_D_863246236==1 | D_812370563_4_4_D_812370563_4_4_D_863246236==1) ~ "Kidney",
                                                     (D_812370563_1_1_D_812370563_1_1_D_607793249==1 | D_812370563_2_2_D_812370563_2_2_D_607793249==1 | D_812370563_3_3_D_812370563_3_3_D_607793249==1 | D_812370563_4_4_D_812370563_4_4_D_607793249==1) ~ "Leukemia",
                                                     (D_812370563_1_1_D_812370563_1_1_D_532172400==1 | D_812370563_2_2_D_812370563_2_2_D_532172400==1 | D_812370563_3_3_D_812370563_3_3_D_532172400==1 ) ~ "Liver", 
                                            #| D_812370563_1_1_D_812370563_4_4_D_532172400==1
                                                     (D_812370563_1_1_D_812370563_1_1_D_754745617==1 | D_812370563_2_2_D_812370563_2_2_D_754745617==1 | D_812370563_3_3_D_812370563_3_3_D_754745617==1 ) ~ "Lung",
                                            #| D_812370563_1_1_D_812370563_4_4_D_754745617==1
                                                     (D_812370563_1_1_D_812370563_1_1_D_665036297==1 | D_812370563_2_2_D_812370563_2_2_D_665036297==1 | D_812370563_3_3_D_812370563_3_3_D_665036297==1 ) ~ "Non-Hodgkin's Lymphoma", #| D_812370563_1_1_D_812370563_4_4_D_665036297==1
                                                     (D_812370563_1_1_D_812370563_1_1_D_200837530==1 | D_812370563_2_2_D_812370563_2_2_D_200837530==1 | D_812370563_3_3_D_812370563_3_3_D_200837530==1 ) ~ "Lymphoma",
                                            #| D_812370563_1_1_D_812370563_4_4_D_200837530==1
                                                     (D_812370563_1_1_D_812370563_1_1_D_990319383==1 | D_812370563_2_2_D_812370563_2_2_D_990319383==1 | D_812370563_3_3_D_812370563_3_3_D_990319383==1 ) ~ "Melanoma Skin",
                                            #| D_812370563_1_1_D_812370563_4_4_D_990319383==1
                                                     (D_812370563_1_1_D_812370563_1_1_D_487917585==1 | D_812370563_2_2_D_812370563_2_2_D_487917585==1 | D_812370563_3_3_D_812370563_3_3_D_487917585==1 ) ~ "Non-Melanoma Skin",
                                            #| D_812370563_1_1_D_812370563_4_4_D_487917585==1
                                                     (D_812370563_1_1_D_812370563_1_1_D_603181162==1 | D_812370563_2_2_D_812370563_2_2_D_603181162==1 | D_812370563_3_3_D_812370563_3_3_D_603181162==1 ) ~ "Ovarian",
                                            #| D_812370563_1_1_D_812370563_4_4_D_603181162==1
                                                     (D_812370563_1_1_D_812370563_1_1_D_482225200==1 | D_812370563_2_2_D_812370563_2_2_D_482225200==1 | D_812370563_3_3_D_812370563_3_3_D_482225200==1 ) ~ "Pancreatic",
                                            #| D_812370563_1_1_D_812370563_4_4_D_482225200==1
                                                     (D_812370563_1_1_D_812370563_1_1_D_295976386==1 | D_812370563_2_2_D_812370563_2_2_D_295976386==1 | D_812370563_3_3_D_812370563_3_3_D_295976386==1 ) ~ "Prostate",
                                            #| D_812370563_1_1_D_812370563_4_4_D_295976386==1
                                                     (D_812370563_1_1_D_812370563_1_1_D_764891959==1 | D_812370563_2_2_D_812370563_2_2_D_764891959==1 | D_812370563_3_3_D_812370563_3_3_D_764891959==1 ) ~ "Stomach",
                                            #| D_812370563_1_1_D_812370563_4_4_D_764891959==1
                                                     (D_812370563_1_1_D_812370563_1_1_D_248374037==1 | D_812370563_2_2_D_812370563_2_2_D_248374037==1 | D_812370563_3_3_D_812370563_3_3_D_248374037==1 ) ~ "Testicular",
                                            #| D_812370563_1_1_D_812370563_4_4_D_248374037==1
                                                     (D_812370563_1_1_D_812370563_1_1_D_139822395==1 | D_812370563_2_2_D_812370563_2_2_D_139822395==1 | D_812370563_3_3_D_812370563_3_3_D_139822395==1 ) ~ "Thyroid",
                                            #| D_812370563_1_1_D_812370563_4_4_D_139822395==1
                                                     (D_812370563_1_1_D_812370563_1_1_D_723614811==1 | D_812370563_2_2_D_812370563_2_2_D_723614811==1 | D_812370563_3_3_D_812370563_3_3_D_723614811==1 ) ~ "Uterine",
                                            #| D_812370563_1_1_D_812370563_4_4_D_723614811==1
                                                     (D_812370563_1_1_D_812370563_1_1_D_807835037==1  | D_812370563_2_2_D_812370563_2_2_D_807835037==1  | D_812370563_3_3_D_812370563_3_3_D_807835037==1   | !is.na(D_812370563_1_1_D_933110091_1) | !is.na(D_812370563_2_2_D_933110091_2) | !is.na(D_812370563_3_3_D_933110091_3)) ~ "Other",
                                            #| D_812370563_1_1_D_812370563_4_4_D_807835037==1  | !is.na(D_812370563_4_4_D_933110091_4)
                                                     (D_812370563_1_1_D_812370563_1_1_D_178420302==1 | D_812370563_2_2_D_812370563_2_2_D_178420302==1 | D_812370563_3_3_D_812370563_3_3_D_178420302==1 ) ~ "Unknown",
                                            #| D_812370563_1_1_D_812370563_4_4_D_178420302==1
                                             TRUE ~ "Skipped this Question"))
                                 
dt_body_kid_summary <- body_kid %>% dplyr::group_by(bodyp) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(bodyp, percentage)  


kid_bd_canc <- dt_body_kid_summary %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("CHILDCAN2: Type of Cancer Children 1-4 Diagnosed With")) %>% 
  cols_label(bodyp = md("**Cancer**"), percentage = md("**%**")) %>% 
  # summary_rows(
  #   column = c(n,percentage),
  #   fns= list(
  #     Sum= ~sum(.)
  #   ), decimals=0) %>%
  grand_summary_rows(columns=c(percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = bodyp,
    )
  ) 

kid_bd_canc

 


#Age and Year of Diagnosis 
ch1_c1=boxp_funct(D_900939817_1_1_D_206625031_1_1, "Child 1 Age at Anal Cancer Diagnosis", "Age") #anal
ch1_c2=boxp_funct(D_900939817_1_1_D_261863326_1_1, "Child 1 Year at Anal Cancer Diagnosis", "Year") #anal
ch1_c3=boxp_funct(D_938150507_1_1_D_206625031_1_1, "Child 1 Age at Bladder Cancer Diagnosis", "Age") #bladder
#boxp_funct(D_938150507_1_1_D_261863326_1_1, "Child 1 Year at Bladder Cancer Diagnosis", "Year") #bladder
ch1_c4=boxp_funct(D_601211723_1_1_D_206625031_1_1, "Child 1 Age at Brain Cancer Diagnosis", "Age") #brain
ch1_c5=boxp_funct(D_601211723_1_1_D_261863326_1_1, "Child 1 Year at Brain Cancer Diagnosis", "Year") #brain
ch1_c6=boxp_funct(D_861788020_1_1_D_206625031_1_1, "Child 1 Age at Breast Cancer Diagnosis", "Age") #breast
ch1_c7=boxp_funct(D_861788020_1_1_D_261863326_1_1, "Child 1 Year at Breast Cancer Diagnosis", "Year") #breast
ch1_c8=boxp_funct(D_204425387_1_1_D_206625031_1_1, "Child 1 Age at Cervical Cancer Diagnosis", "Age") #cervical
ch1_c9=boxp_funct(D_204425387_1_1_D_261863326_1_1, "Child 1 Year at Cervical Cancer Diagnosis", "Year") #cervical
ch1_c10=boxp_funct(D_558929585_1_1_D_206625031_1_1, "Child 1 Age at Colon Cancer Diagnosis", "Age") #colon
ch1_c11=boxp_funct(D_558929585_1_1_D_261863326_1_1, "Child 1 Year at Colon Cancer Diagnosis", "Year") #colon
ch1_c12=boxp_funct(D_233764880_1_1_D_206625031_1_1, "Child 1 Age at Esophageal Cancer Diagnosis", "Age") #esphageal
ch1_c13=boxp_funct(D_233764880_1_1_D_261863326_1_1, "Child 1 Year at Esophageal Cancer Diagnosis", "Year") #esphageal
ch1_c14=boxp_funct(D_905145893_1_1_D_206625031_1_1, "Child 1 Age at Head&Neck Cancer Diagnosis", "Age")#head & neck
#boxp_funct(D_905145893_1_1_D_261863326_1_1, "Child 1 Year at Head&Neck Cancer Diagnosis", "Year")#head & neck
ch1_c15=boxp_funct(D_473190270_1_1_D_206625031_1_1, "Child 1 Age at Kidney Cancer Diagnosis", "Age")#kidney
ch1_c16=boxp_funct(D_473190270_1_1_D_261863326_1_1, "Child 1 Year at Kidney Cancer Diagnosis", "Year")#kidney
ch1_c17=boxp_funct(D_483735587_1_1_D_206625031_1_1, "Child 1 Age at Leukemia Cancer Diagnosis", "Age") #leuk
ch1_c18=boxp_funct(D_483735587_1_1_D_261863326_1_1, "Child 1 Year at Leukemia Cancer Diagnosis", "Year") #leuk
ch1_c19=boxp_funct(D_331759900_1_1_D_206625031_1_1, "Child 1 Age at Liver Cancer Diagnosis", "Age") #liver
#boxp_funct(D_331759900_1_1_D_261863326_1_1, "Child 1 Year at Liver Cancer Diagnosis", "Year") #liver
#boxp_funct(D_513077276_1_1_D_206625031_1_1, "Child 1 Age at Lung Cancer Diagnosis", "Age")#lung
#boxp_funct(D_513077276_1_1_D_261863326_1_1, "Child 1 Year at Lung Cancer Diagnosis", "Year")#lung
ch1_c20=boxp_funct(D_519974530_1_1_D_206625031_1_1, "Child 1 Age at Non-Hodgkin's Lymphoma Cancer Diagnosis", "Age") #nonH
#boxp_funct(D_519974530_1_1_D_261863326_1_1, "Child 1 Year at Non-Hodgkin's Lymphoma Cancer Diagnosis", "Year") #nonH
ch1_c21=boxp_funct(D_907776050_1_1_D_206625031_1_1, "Child 1 Age at Lymphoma Cancer Diagnosis", "Age") #lymphoma
#boxp_funct(D_907776050_1_1_D_261863326_1_1, "Child 1 Year at Lymphoma Cancer Diagnosis", "Year") #lymphoma
ch1_c22=boxp_funct(D_271684775_1_1_D_206625031_1_1, "Child 1 Age at Melanoma Cancer Diagnosis", "Age") #mel
#boxp_funct(D_271684775_1_1_D_261863326_1_1, "Child 1 Year at Melanoma Cancer Diagnosis", "Year") #mel
ch1_c23=boxp_funct(D_252160589_1_1_D_206625031_1_1, "Child 1 Age at Non-Melanoma Cancer Diagnosis", "Age") #non-mel
ch1_c24=boxp_funct(D_252160589_1_1_D_261863326_1_1, "Child 1 Year at Non-Melanoma Cancer Diagnosis", "Year") #non-mel
ch1_c25=boxp_funct(D_774774759_1_1_D_206625031_1_1, "Child 1 Age Ovarian Cancer Diagnosis", "Age") #ovarian
#boxp_funct(D_774774759_1_1_D_261863326_1_1, "Child 1 Year at Ovarian Cancer Diagnosis", "Year") #ovarian
ch1_c26=boxp_funct(D_127257956_1_1_D_206625031_1_1, "Child 1 Age at Pancreatic Cancer Diagnosis", "Age") #pancreatic
#boxp_funct(D_127257956_1_1_D_261863326_1_1, "Child 1 Year at Pancreatic Cancer Diagnosis", "Year") #pancreatic
ch1_c27=boxp_funct(D_496917282_1_1_D_206625031_1_1, "Child 1 Age at Prostate Cancer Diagnosis", "Age") #prostate
#boxp_funct(D_496917282_1_1_D_261863326_1_1, "Child 1 Year at Prostate Cancer Diagnosis", "Year") #prostate
ch1_c28=boxp_funct(D_908129316_1_1_D_206625031_1_1, "Child 1 Age at Stomach Cancer Diagnosis", "Age") #stomach
#boxp_funct(D_908129316_1_1_D_261863326_1_1, "Child 1 Year at Stomach Cancer Diagnosis", "Year") #stomach
ch1_c29=boxp_funct(D_795003496_1_1_D_206625031_1_1, "Child 1 Age at Testicular Cancer Diagnosis", "Age") #testicular
ch1_c30=boxp_funct(D_795003496_1_1_D_261863326_1_1, "Child 1 Year at Testicular Cancer Diagnosis", "Year") #testicular
ch1_c31=boxp_funct(D_969177591_1_1_D_206625031_1_1, "Child 1 Age at Thyroid Cancer Diagnosis", "Age") #thyroid
ch1_c32=boxp_funct(D_969177591_1_1_D_261863326_1_1, "Child 1 Year at Thyroid Cancer Diagnosis", "Year") #thyroid
ch1_c33=boxp_funct(D_116065851_1_1_D_206625031_1_1, "Child 1 Age at Urine Cancer Diagnosis", "Age") #urine
ch1_c34=boxp_funct(D_116065851_1_1_D_261863326_1_1, "Child 1 Year at Urine Cancer Diagnosis", "Year") #urine
ch1_c35=boxp_funct(D_278159347_1_1_D_206625031_1_1, "Child 1 Age at Other Cancer Diagnosis", "Age") #other
ch1_c36=boxp_funct(D_278159347_1_1_D_261863326_1_1, "Child 1 Year at Other Cancer Diagnosis", "Year") #other
ch1_c37=boxp_funct(D_845219872_1_1_D_206625031_1_1, "Child 1 Age at Unknown Cancer Diagnosis", "Age")#unknown
ch1_c38=boxp_funct(D_845219872_1_1_D_261863326_1_1, "Child 1 Year at Unknown Cancer Diagnosis", "Year") #unknown

grid.arrange(ch1_c1, ch1_c2, ch1_c3, ch1_c4, nrow=4)
grid.arrange(ch1_c5, ch1_c6, ch1_c7, ch1_c8, nrow=4)
grid.arrange(ch1_c9, ch1_c10, ch1_c11, ch1_c12, nrow=4)
grid.arrange(ch1_c13, ch1_c14, ch1_c15, ch1_c16, nrow=4)
grid.arrange(ch1_c17, ch1_c18, ch1_c19, ch1_c20, nrow=4)
grid.arrange(ch1_c21, ch1_c22, ch1_c23, ch1_c24, nrow=4)
grid.arrange(ch1_c25, ch1_c26, ch1_c27, ch1_c28, nrow=4)
grid.arrange(ch1_c29, ch1_c30, ch1_c31, ch1_c32, nrow=4)
grid.arrange(ch1_c33, ch1_c34, ch1_c35, ch1_c36, nrow=4)
grid.arrange(ch1_c37, ch1_c38,  nrow=2)
 


#boxp_funct(D_900939817_2_2_D_206625031_2_2, "Child 2 Age at Anal Cancer Diagnosis", "Age") #anal
#boxp_funct(D_900939817_2_2_D_261863326_2_2, "Child 2 Year at Anal Cancer Diagnosis", "Year") #anal
#boxp_funct(D_938150507_2_2_D_206625031_2_2, "Child 2 Age at Bladder Cancer Diagnosis", "Age") #bladder
#boxp_funct(D_938150507_2_2_D_261863326_2_2, "Child 2 Year at Bladder Cancer Diagnosis", "Year") #bladder
ch2_c1=boxp_funct(D_601211723_2_2_D_206625031_2_2, "Child 2 Age at Brain Cancer Diagnosis", "Age") #brain
ch2_c2=boxp_funct(D_601211723_2_2_D_261863326_2_2, "Child 2 Year at Brain Cancer Diagnosis", "Year") #brain
ch2_c3=boxp_funct(D_861788020_2_2_D_206625031_2_2, "Child 2 Age at Breast Cancer Diagnosis", "Age") #breast
#boxp_funct(D_861788020_2_2_D_261863326_2_2, "Child 2 Year at Breast Cancer Diagnosis", "Year") #breast
ch2_c4=boxp_funct(D_204425387_2_2_D_206625031_2_2, "Child 2 Age at Cervical Cancer Diagnosis", "Age") #cervical
ch2_c5=boxp_funct(D_204425387_2_2_D_261863326_2_2, "Child 2 Year at Cervical Cancer Diagnosis", "Year") #cervical
ch2_c6=boxp_funct(D_558929585_2_2_D_206625031_2_2, "Child 2 Age at Colon Cancer Diagnosis", "Age") #colon
#boxp_funct(D_558929585_2_2_D_261863326_2_2, "Child 2 Year at Colon Cancer Diagnosis", "Year") #colon
#boxp_funct(D_233764880_2_2_D_206625031_2_2, "Child 2 Age at Esophageal Cancer Diagnosis", "Age") #esphageal
#boxp_funct(D_233764880_2_2_D_261863326_2_2, "Child 2 Year at Esophageal Cancer Diagnosis", "Year") #esphageal
ch2_c7=boxp_funct(D_905145893_2_2_D_206625031_2_2, "Child 2 Age at Head&Neck Cancer Diagnosis", "Age")#head & neck
ch2_c8=boxp_funct(D_905145893_2_2_D_261863326_2_2, "Child 2 Year at Head&Neck Cancer Diagnosis", "Year")#head & neck
ch2_c9=boxp_funct(D_473190270_2_2_D_206625031_2_2, "Child 2 Age at Kidney Cancer Diagnosis", "Age")#kidney
#boxp_funct(D_473190270_2_2_D_261863326_2_2, "Child 2 Year at Kidney Cancer Diagnosis", "Year")#kidney
ch2_c10=boxp_funct(D_483735587_2_2_D_206625031_2_2, "Child 2 Age at Leukemia Cancer Diagnosis", "Age") #leuk
ch2_c11=boxp_funct(D_483735587_2_2_D_261863326_2_2, "Child 2 Year at Leukemia Cancer Diagnosis", "Year") #leuk
#boxp_funct(D_331759900_2_2_D_206625031_2_2, "Child 2 Age at Liver Cancer Diagnosis", "Age") #liver
#boxp_funct(D_331759900_2_2_D_261863326_2_2, "Child 2 Year at Liver Cancer Diagnosis", "Year") #liver
#boxp_funct(D_513077276_2_2_D_206625031_2_2, "Child 2 Age at Lung Cancer Diagnosis", "Age")#lung
#boxp_funct(D_513077276_2_2_D_261863326_2_2, "Child 2 Year at Lung Cancer Diagnosis", "Year")#lung
ch2_c12=boxp_funct(D_519974530_2_2_D_206625031_2_2, "Child 2 Age at Non-Hodgkin's Lymphoma Cancer Diagnosis", "Age") #nonH
#boxp_funct(D_519974530_2_2_D_261863326_2_2, "Child 2 Year at Non-Hodgkin's Lymphoma Cancer Diagnosis", "Year") #nonH
ch2_c13=boxp_funct(D_907776050_2_2_D_206625031_2_2, "Child 2 Age at Lymphoma Cancer Diagnosis", "Age") #lymphoma
#boxp_funct(D_907776050_2_2_D_261863326_2_2, "Child 2 Year at Lymphoma Cancer Diagnosis", "Year") #lymphoma
ch2_c14=boxp_funct(D_271684775_2_2_D_206625031_2_2, "Child 2 Age at Melanoma Cancer Diagnosis", "Age") #mel
#boxp_funct(D_271684775_2_2_D_261863326_2_2, "Child 2 Year at Melanoma Cancer Diagnosis", "Year") #mel
ch2_c15=boxp_funct(D_252160589_2_2_D_206625031_2_2, "Child 2 Age at Non-Melanoma Cancer Diagnosis", "Age") #non-mel
#boxp_funct(D_252160589_2_2_D_261863326_2_2, "Child 2 Year at Non-Melanoma Cancer Diagnosis", "Year") #non-mel
ch2_c16=boxp_funct(D_774774759_2_2_D_206625031_2_2, "Child 2 Age Ovarian Cancer Diagnosis", "Age") #ovarian
#boxp_funct(D_774774759_2_2_D_261863326_2_2, "Child 2 Year at Ovarian Cancer Diagnosis", "Year") #ovarian
#boxp_funct(D_127257956_2_2_D_206625031_2_2, "Child 2 Age at Pancreatic Cancer Diagnosis", "Age") #pancreatic
#boxp_funct(D_127257956_2_2_D_261863326_2_2, "Child 2 Year at Pancreatic Cancer Diagnosis", "Year") #pancreatic
#boxp_funct(D_496917282_2_2_D_206625031_2_2, "Child 2 Age at Prostate Cancer Diagnosis", "Age") #prostate
#boxp_funct(D_496917282_2_2_D_261863326_2_2, "Child 2 Year at Prostate Cancer Diagnosis", "Year") #prostate
#boxp_funct(D_908129316_2_2_D_206625031_2_2, "Child 2 Age at Stomach Cancer Diagnosis", "Age") #stomach
#boxp_funct(D_908129316_2_2_D_261863326_2_2, "Child 2 Year at Stomach Cancer Diagnosis", "Year") #stomach
ch2_c17=boxp_funct(D_795003496_2_2_D_206625031_2_2, "Child 2 Age at Testicular Cancer Diagnosis", "Age") #testicular
ch2_c18=boxp_funct(D_795003496_2_2_D_261863326_2_2, "Child 2 Year at Testicular Cancer Diagnosis", "Year") #testicular
ch2_c19=boxp_funct(D_969177591_2_2_D_206625031_2_2, "Child 2 Age at Thyroid Cancer Diagnosis", "Age") #thyroid
#boxp_funct(D_969177591_2_2_D_261863326_2_2, "Child 2 Year at Thyroid Cancer Diagnosis", "Year") #thyroid
ch2_c20=boxp_funct(D_116065851_2_2_D_206625031_2_2, "Child 2 Age at Urine Cancer Diagnosis", "Age") #urine
#boxp_funct(D_116065851_2_2_D_261863326_2_2, "Child 2 Year at Urine Cancer Diagnosis", "Year") #urine
ch2_c21=boxp_funct(D_278159347_2_2_D_206625031_2_2, "Child 2 Age at Other Cancer Diagnosis", "Age") #other
#boxp_funct(D_278159347_2_2_D_261863326_2_2, "Child 2 Year at Other Cancer Diagnosis", "Year") #other
ch2_c22=boxp_funct(D_845219872_2_2_D_206625031_2_2, "Child 2 Age at Unknown Cancer Diagnosis", "Age")#unknown
#boxp_funct(D_845219872_2_2_D_261863326_2_2, "Child 2 Year at Unknown Cancer Diagnosis", "Year") #unknown

grid.arrange(ch2_c1, ch2_c2, ch2_c3, ch2_c4, nrow=4)
grid.arrange(ch2_c5, ch2_c6, ch2_c7, ch2_c8, nrow=4)
grid.arrange(ch2_c9, ch2_c10, ch2_c11, ch2_c12, nrow=4)
grid.arrange(ch2_c13, ch2_c14, ch2_c15, ch2_c16, nrow=4)
grid.arrange(ch2_c17, ch2_c18, ch2_c19, ch2_c20, nrow=4)
grid.arrange(ch2_c21, ch2_c22,  nrow=2)




#boxp_funct(D_900939817_3_3_D_206625031_3_3, "Child 3 Age at Anal Cancer Diagnosis", "Age") #anal
#boxp_funct(D_900939817_3_3_D_261863326_3_3, "Child 3 Year at Anal Cancer Diagnosis", "Year") #anal
ch3_c1=boxp_funct(D_938150507_3_3_D_206625031_3_3, "Child 3 Age at Bladder Cancer Diagnosis", "Age") #bladder
#boxp_funct(D_938150507_3_3_D_261863326_3_3, "Child 3 Year at Bladder Cancer Diagnosis", "Year") #bladder
ch3_c2=boxp_funct(D_601211723_3_3_D_206625031_3_3, "Child 3 Age at Brain Cancer Diagnosis", "Age") #brain
#boxp_funct(D_601211723_3_3_D_261863326_3_3, "Child 3 Year at Brain Cancer Diagnosis", "Year") #brain
ch3_c3=boxp_funct(D_861788020_3_3_D_206625031_3_3, "Child 3 Age at Breast Cancer Diagnosis", "Age") #breast
#boxp_funct(D_861788020_3_3_D_261863326_3_3, "Child 3 Year at Breast Cancer Diagnosis", "Year") #breast
ch3_c4=boxp_funct(D_204425387_3_3_D_206625031_3_3, "Child 3 Age at Cervical Cancer Diagnosis", "Age") #cervical
#boxp_funct(D_204425387_3_3_D_261863326_3_3, "Child 3 Year at Cervical Cancer Diagnosis", "Year") #cervical
#boxp_funct(D_558929585_3_3_D_206625031_3_3, "Child 3 Age at Colon Cancer Diagnosis", "Age") #colon
#boxp_funct(D_558929585_3_3_D_261863326_3_3, "Child 3 Year at Colon Cancer Diagnosis", "Year") #colon
#boxp_funct(D_233764880_3_3_D_206625031_3_3, "Child 3 Age at Esophageal Cancer Diagnosis", "Age") #esphageal
#boxp_funct(D_233764880_3_3_D_261863326_3_3, "Child 3 Year at Esophageal Cancer Diagnosis", "Year") #esphageal
ch3_c5=boxp_funct(D_905145893_3_3_D_206625031_3_3, "Child 3 Age at Head&Neck Cancer Diagnosis", "Age")#head & neck
#boxp_funct(D_905145893_3_3_D_261863326_3_3, "Child 3 Year at Head&Neck Cancer Diagnosis", "Year")#head & neck
#boxp_funct(D_473190270_3_3_D_206625031_3_3, "Child 3 Age at Kidney Cancer Diagnosis", "Age")#kidney
#boxp_funct(D_473190270_3_3_D_261863326_3_3, "Child 3 Year at Kidney Cancer Diagnosis", "Year")#kidney
ch3_c6=boxp_funct(D_483735587_3_3_D_206625031_3_3, "Child 3 Age at Leukemia Cancer Diagnosis", "Age") #leuk
#boxp_funct(D_483735587_3_3_D_261863326_3_3, "Child 3 Year at Leukemia Cancer Diagnosis", "Year") #leuk
#boxp_funct(D_331759900_3_3_D_206625031_3_3, "Child 3 Age at Liver Cancer Diagnosis", "Age") #liver
#boxp_funct(D_331759900_3_3_D_261863326_3_3, "Child 3 Year at Liver Cancer Diagnosis", "Year") #liver
#boxp_funct(D_513077276_3_3_D_206625031_3_3, "Child 3 Age at Lung Cancer Diagnosis", "Age")#lung
#boxp_funct(D_513077276_3_3_D_261863326_3_3, "Child 3 Year at Lung Cancer Diagnosis", "Year")#lung
ch3_c7=boxp_funct(D_519974530_3_3_D_206625031_3_3, "Child 3 Age at Non-Hodgkin's Lymphoma Cancer Diagnosis", "Age") #nonH
#boxp_funct(D_519974530_3_3_D_261863326_3_3, "Child 3 Year at Non-Hodgkin's Lymphoma Cancer Diagnosis", "Year") #nonH
ch3_c8=boxp_funct(D_907776050_3_3_D_206625031_3_3, "Child 3 Age at Lymphoma Cancer Diagnosis", "Age") #lymphoma
#boxp_funct(D_907776050_3_3_D_261863326_3_3, "Child 3 Year at Lymphoma Cancer Diagnosis", "Year") #lymphoma
ch3_c9=boxp_funct(D_271684775_3_3_D_206625031_3_3, "Child 3 Age at Melanoma Cancer Diagnosis", "Age") #mel
#boxp_funct(D_271684775_3_3_D_261863326_3_3, "Child 3 Year at Melanoma Cancer Diagnosis", "Year") #mel
ch3_c10=boxp_funct(D_252160589_3_3_D_206625031_3_3, "Child 3 Age at Non-Melanoma Cancer Diagnosis", "Age") #non-mel
#boxp_funct(D_252160589_3_3_D_261863326_3_3, "Child 3 Year at Non-Melanoma Cancer Diagnosis", "Year") #non-mel
ch3_c11=boxp_funct(D_774774759_3_3_D_206625031_3_3, "Child 3 Age Ovarian Cancer Diagnosis", "Age") #ovarian
#boxp_funct(D_774774759_3_3_D_261863326_3_3, "Child 3 Year at Ovarian Cancer Diagnosis", "Year") #ovarian
#boxp_funct(D_127257956_3_3_D_206625031_3_3, "Child 3 Age at Pancreatic Cancer Diagnosis", "Age") #pancreatic
#boxp_funct(D_127257956_3_3_D_261863326_3_3, "Child 3 Year at Pancreatic Cancer Diagnosis", "Year") #pancreatic
ch3_c12=boxp_funct(D_496917282_3_3_D_206625031_3_3, "Child 3 Age at Prostate Cancer Diagnosis", "Age") #prostate
#boxp_funct(D_496917282_3_3_D_261863326_3_3, "Child 3 Year at Prostate Cancer Diagnosis", "Year") #prostate
#boxp_funct(D_908129316_3_3_D_206625031_3_3, "Child 3 Age at Stomach Cancer Diagnosis", "Age") #stomach
#boxp_funct(D_908129316_3_3_D_261863326_3_3, "Child 3 Year at Stomach Cancer Diagnosis", "Year") #stomach
ch3_c13=boxp_funct(D_795003496_3_3_D_206625031_3_3, "Child 3 Age at Testicular Cancer Diagnosis", "Age") #testicular
#boxp_funct(D_795003496_3_3_D_261863326_3_3, "Child 3 Year at Testicular Cancer Diagnosis", "Year") #testicular
ch3_c14=boxp_funct(D_969177591_3_3_D_206625031_3_3, "Child 3 Age at Thyroid Cancer Diagnosis", "Age") #thyroid
ch3_c15=boxp_funct(D_969177591_3_3_D_261863326_3_3, "Child 3 Year at Thyroid Cancer Diagnosis", "Year") #thyroid
#boxp_funct(D_116065851_3_3_D_206625031_3_3, "Child 3 Age at Urine Cancer Diagnosis", "Age") #urine
#boxp_funct(D_116065851_3_3_D_261863326_3_3, "Child 3 Year at Urine Cancer Diagnosis", "Year") #urine
ch3_c16=boxp_funct(D_278159347_3_3_D_206625031_3_3, "Child 3 Age at Other Cancer Diagnosis", "Age") #other
ch3_c17=boxp_funct(D_278159347_3_3_D_261863326_3_3, "Child 3 Year at Other Cancer Diagnosis", "Year") #other
ch3_c18=boxp_funct(D_845219872_3_3_D_206625031_3_3, "Child 3 Age at Unknown Cancer Diagnosis", "Age")#unknown
#boxp_funct(D_845219872_3_3_D_261863326_3_3, "Child 3 Year at Unknown Cancer Diagnosis", "Year") #unknown

grid.arrange(ch3_c1, ch3_c2, ch3_c3, ch3_c4, nrow=4)
grid.arrange(ch3_c5, ch3_c6, ch3_c7, ch3_c8, nrow=4)
grid.arrange(ch3_c9, ch3_c10, ch3_c11, ch3_c12, nrow=4)
grid.arrange(ch3_c13, ch3_c14, ch3_c15, ch3_c16, nrow=4)
grid.arrange(ch3_c17, nrow=2)




#boxp_funct(D_900939817_4_4_D_206625031_4_4, "Child 4 Age at Anal Cancer Diagnosis", "Age") #anal
#boxp_funct(D_900939817_4_4_D_261863326_4_4, "Child 4 Year at Anal Cancer Diagnosis", "Year") #anal
#boxp_funct(D_938150507_4_4_D_206625031_4_4, "Child 4 Age at Bladder Cancer Diagnosis", "Age") #bladder
ch4_c1=boxp_funct(D_938150507_4_4_D_261863326_4_4, "Child 4 Year at Bladder Cancer Diagnosis", "Year") #bladder
ch4_c2=boxp_funct(D_601211723_4_4_D_206625031_4_4, "Child 4 Age at Brain Cancer Diagnosis", "Age") #brain
#boxp_funct(D_601211723_4_4_D_261863326_4_4, "Child 4 Year at Brain Cancer Diagnosis", "Year") #brain
#boxp_funct(D_861788020_4_4_D_206625031_4_4, "Child 4 Age at Breast Cancer Diagnosis", "Age") #breast
#boxp_funct(D_861788020_4_4_D_261863326_4_4, "Child 4 Year at Breast Cancer Diagnosis", "Year") #breast
ch4_c3=boxp_funct(D_204425387_4_4_D_206625031_4_4, "Child 4 Age at Cervical Cancer Diagnosis", "Age") #cervical
#boxp_funct(D_204425387_4_4_D_261863326_4_4, "Child 4 Year at Cervical Cancer Diagnosis", "Year") #cervical
ch4_c4=boxp_funct(D_558929585_4_4_D_206625031_4_4, "Child 4 Age at Colon Cancer Diagnosis", "Age") #colon
#boxp_funct(D_558929585_4_4_D_261863326_4_4, "Child 4 Year at Colon Cancer Diagnosis", "Year") #colon
#boxp_funct(D_233764880_4_4_D_206625031_4_4, "Child 4 Age at Esophageal Cancer Diagnosis", "Age") #esphageal
#boxp_funct(D_233764880_4_4_D_261863326_4_4, "Child 4 Year at Esophageal Cancer Diagnosis", "Year") #esphageal
#boxp_funct(D_905145893_4_4_D_206625031_4_4, "Child 4 Age at Head&Neck Cancer Diagnosis", "Age")#head & neck
#boxp_funct(D_905145893_4_4_D_261863326_4_4, "Child 4 Year at Head&Neck Cancer Diagnosis", "Year")#head & neck
#boxp_funct(D_473190270_4_4_D_206625031_4_4, "Child 4 Age at Kidney Cancer Diagnosis", "Age")#kidney
#boxp_funct(D_473190270_4_4_D_261863326_4_4, "Child 4 Year at Kidney Cancer Diagnosis", "Year")#kidney
ch4_c5=boxp_funct(D_483735587_4_4_D_206625031_4_4, "Child 4 Age at Leukemia Cancer Diagnosis", "Age") #leuk
#boxp_funct(D_483735587_4_4_D_261863326_4_4, "Child 4 Year at Leukemia Cancer Diagnosis", "Year") #leuk
#boxp_funct(D_331759900_4_4_D_206625031_4_4, "Child 4 Age at Liver Cancer Diagnosis", "Age") #liver
#boxp_funct(D_331759900_4_4_D_261863326_4_4, "Child 4 Year at Liver Cancer Diagnosis", "Year") #liver
#boxp_funct(D_513077276_4_4_D_206625031_4_4, "Child 4 Age at Lung Cancer Diagnosis", "Age")#lung
#boxp_funct(D_513077276_4_4_D_261863326_4_4, "Child 4 Year at Lung Cancer Diagnosis", "Year")#lung
ch4_c6=boxp_funct(D_519974530_4_4_D_206625031_4_4, "Child 4 Age at Non-Hodgkin's Lymphoma Cancer Diagnosis", "Age") #nonH
#boxp_funct(D_519974530_4_4_D_261863326_4_4, "Child 4 Year at Non-Hodgkin's Lymphoma Cancer Diagnosis", "Year") #nonH
#boxp_funct(D_907776050_4_4_D_206625031_4_4, "Child 4 Age at Lymphoma Cancer Diagnosis", "Age") #lymphoma
#boxp_funct(D_907776050_4_4_D_261863326_4_4, "Child 4 Year at Lymphoma Cancer Diagnosis", "Year") #lymphoma
ch4_c7=boxp_funct(D_271684775_4_4_D_206625031_4_4, "Child 4 Age at Melanoma Cancer Diagnosis", "Age") #mel
#boxp_funct(D_271684775_4_4_D_261863326_4_4, "Child 4 Year at Melanoma Cancer Diagnosis", "Year") #mel
#boxp_funct(D_252160589_4_4_D_206625031_4_4, "Child 4 Age at Non-Melanoma Cancer Diagnosis", "Age") #non-mel
#boxp_funct(D_252160589_4_4_D_261863326_4_4, "Child 4 Year at Non-Melanoma Cancer Diagnosis", "Year") #non-mel
#boxp_funct(D_774774759_4_4_D_206625031_4_4, "Child 4 Age Ovarian Cancer Diagnosis", "Age") #ovarian
#boxp_funct(D_774774759_4_4_D_261863326_4_4, "Child 4 Year at Ovarian Cancer Diagnosis", "Year") #ovarian
#boxp_funct(D_127257956_4_4_D_206625031_4_4, "Child 4 Age at Pancreatic Cancer Diagnosis", "Age") #pancreatic
#boxp_funct(D_127257956_4_4_D_261863326_4_4, "Child 4 Year at Pancreatic Cancer Diagnosis", "Year") #pancreatic
#boxp_funct(D_496917282_4_4_D_206625031_4_4, "Child 4 Age at Prostate Cancer Diagnosis", "Age") #prostate
#boxp_funct(D_496917282_4_4_D_261863326_4_4, "Child 4 Year at Prostate Cancer Diagnosis", "Year") #prostate
#boxp_funct(D_908129316_4_4_D_206625031_4_4, "Child 4 Age at Stomach Cancer Diagnosis", "Age") #stomach
#boxp_funct(D_908129316_4_4_D_261863326_4_4, "Child 4 Year at Stomach Cancer Diagnosis", "Year") #stomach
#boxp_funct(D_795003496_4_4_D_206625031_4_4, "Child 4 Age at Testicular Cancer Diagnosis", "Age") #testicular
#boxp_funct(D_795003496_4_4_D_261863326_4_4, "Child 4 Year at Testicular Cancer Diagnosis", "Year") #testicular
ch4_c8=boxp_funct(D_969177591_4_4_D_206625031_4_4, "Child 4 Age at Thyroid Cancer Diagnosis", "Age") #thyroid
#boxp_funct(D_969177591_4_4_D_261863326_4_4, "Child 4 Year at Thyroid Cancer Diagnosis", "Year") #thyroid
#boxp_funct(D_116065851_4_4_D_206625031_4_4, "Child 4 Age at Urine Cancer Diagnosis", "Age") #urine
#boxp_funct(D_116065851_4_4_D_261863326_4_4, "Child 4 Year at Urine Cancer Diagnosis", "Year") #urine
ch4_c9=boxp_funct(D_278159347_4_4_D_206625031_4_4, "Child 4 Age at Other Cancer Diagnosis", "Age") #other
#boxp_funct(D_278159347_4_4_D_261863326_4_4, "Child 4 Year at Other Cancer Diagnosis", "Year") #other
#boxp_funct(D_845219872_4_4_D_206625031_4_4, "Child 4 Age at Unknown Cancer Diagnosis", "Age")#unknown
#boxp_funct(D_845219872_4_4_D_261863326_4_4, "Child 4 Year at Unknown Cancer Diagnosis", "Year") #unknown

grid.arrange(ch4_c1, ch4_c2, ch4_c3, ch4_c4, nrow=4)
grid.arrange(ch4_c5, ch4_c6, ch4_c7, ch4_c8, nrow=4)



```



\newpage

# Section 5: Education and Occupation 
```{r edu, warning=FALSE, echo=FALSE, message=FALSE}

#Highest level of ed. achieved 
data_tib_m1$D_367803647_D_367803647 <- factor(data_tib_m1$D_367803647_D_367803647, levels=c(978204320,935502060,404564707,432193665,890756124,766964355,875342283,598242454,807835037, "Skipped this Question"))
simple_funct(D_367803647_D_367803647, "EDU: Highest Level of School Completed")


#In school now?
simple_funct(D_784967158, "STUDENT: Currently Enrolled in School")

#do you currently work?
simple_funct(D_613744428, "WORK: Currently Work for Pay")

#work status
one_logic_funct(D_114529380, D_613744428,104430631,"WORK2: Employment Status")

#current title
#table(module1$D_627122657)-- potentially pii and VERY long with all individual responses 
home1skip <- data_tib_m1 %>%  filter(data_tib_m1$D_613744428==353358909)  
home1skip= home1skip %>%  mutate(Address1= case_when(is.na(D_761310265)~"Skipped this Question",
                                                     TRUE ~ "Provided a Response"))
  
dt_home1skip_summary <- home1skip %>% dplyr::group_by(Address1) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address1, n, percentage)
  
  
dt_home1skip_summary %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("WORK3: Job Title (current Position) ")) %>% 
  cols_label(n= md("**N**"),Address1 = md("**Answer**"), percentage = md("**%**")) %>% 
  grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address1,
    )
  ) 


#current ocupational category
#table(module1$D_761310265)-- leaving out as it is VERY long and not helpful unless the category codes are accessible

home1skip <- data_tib_m1 %>%  filter(data_tib_m1$D_613744428==353358909)
home1skip= home1skip %>%  mutate(Address1= case_when(is.na(D_761310265)~"Skipped this Question",
                                                     TRUE ~ "Provided a Response"))
  
dt_home1skip_summary <- home1skip %>% dplyr::group_by(Address1) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address1, n, percentage)
  
  
dt_home1skip_summary %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("OCCUPTN1: Occupation Category of Current Job")) %>% 
  cols_label(n= md("**N**"),Address1 = md("**Answer**"), percentage = md("**%**")) %>% 
  # summary_rows(
  #   column = c(participants,percentage),
  #   fns= list(
  #     Sum= ~sum(.)
  #   ), decimals=0) %>%
  grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address1,
    )
  ) 


#name of current employer
#table(module1$D_434316600)-- potentially identifying? And Very long with individual reponses
home1skip <- data_tib_m1  %>%  filter(data_tib_m1$D_613744428==353358909)
home1skip= home1skip %>%  mutate(Address1= case_when(is.na(D_434316600)~"Skipped this Question",
                                                     TRUE ~ "Provided a Response"))
  
dt_home1skip_summary <- home1skip %>% dplyr::group_by(Address1) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address1, n, percentage)
  
  
dt_home1skip_summary %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("EMPLYR1:Name of Current Employer")) %>% 
  cols_label(n= md("**N**"),Address1 = md("**Answer**"), percentage = md("**%**")) %>% 
  # summary_rows(
  #   column = c(participants,percentage),
  #   fns= list(
  #     Sum= ~sum(.)
  #   ), decimals=0) %>%
  grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address1,
    )
  ) 


#type of business for current employer
dt_curr_bus= data_tib_m1 %>%  filter(data_tib_m1$D_613744428==353358909)

dt_curr_bus= dt_curr_bus  %>%  mutate(multb1 = ifelse(D_700374192_D_700374192_D_641572847==1, 1, 0) + ifelse(D_700374192_D_700374192_D_592592455==1, 1, 0) + ifelse(D_700374192_D_700374192_D_711138281==1, 1, 0) + ifelse(D_700374192_D_700374192_D_596792238==1, 1, 0) + ifelse(D_700374192_D_700374192_D_133362151==1, 1, 0) + ifelse(D_700374192_D_700374192_D_372993567==1, 1, 0) + ifelse(D_700374192_D_700374192_D_620577362==1, 1, 0) + ifelse(D_700374192_D_700374192_D_580409149==1, 1, 0) + ifelse(D_700374192_D_700374192_D_867237640==1, 1, 0) + ifelse(D_700374192_D_700374192_D_698814077==1, 1, 0) + ifelse(D_700374192_D_700374192_D_751475124==1, 1, 0) + ifelse(D_700374192_D_700374192_D_308286913==1, 1, 0) + ifelse(D_700374192_D_700374192_D_807835037==1, 1, 0) + ifelse(D_700374192_D_700374192_D_178420302==1, 1, 0))


bsn= dt_curr_bus  %>%  mutate(category= case_when(as.numeric(multb1)>1 ~ "Multiple Business Types",
                                                  D_700374192_D_700374192_D_641572847==1 ~ "Manufacturing",
                                             D_700374192_D_700374192_D_592592455==1 ~ "Retail or Wholesale Sales",
                                             #D_700374192_D_700374192_D_711138281==1 ~ "Wholesale or Distributor",
                                             D_700374192_D_700374192_D_711138281==1 | D_700374192_D_700374192_D_149230791 ==1 ~ "Transportation, warehousing, and utilities",
                                             #D_700374192_D_700374192_D_596792238==1 ~ "A Service Provider",
                                            D_700374192_D_700374192_D_596792238==1 | D_700374192_D_700374192_D_439857718==1 ~ "Professional and business services",
                                             D_700374192_D_700374192_D_133362151==1 ~ "Construction or Equipment Repair",
                                             D_700374192_D_700374192_D_372993567==1 ~ "Mining, quarrying, and oil annd gas extraction",
                                             #D_700374192_D_700374192_D_620577362==1 ~ "Farming",
                                             D_700374192_D_700374192_D_709307391==1 ~ "Accommodation and food services",
                                             #D_700374192_D_700374192_D_580409149==1 ~ "Fishing",
                                             #D_700374192_D_700374192_D_867237640==1 ~ "Forestry",
                                             D_700374192_D_700374192_D_620577362==1 | D_700374192_D_700374192_D_580409149==1 |
                                              D_700374192_D_700374192_D_867237640==1 | D_700374192_D_700374192_D_927863729==1 ~ "Farming, fishing, or forestry",
                                             D_700374192_D_700374192_D_766533183==1 ~ "Healthcare or social assistance",
                                             D_700374192_D_700374192_D_698814077==1 ~ "Government",
                                             #D_700374192_D_700374192_D_751475124==1 ~ "Military",
                                             D_700374192_D_700374192_D_751475124==1 | D_700374192_D_700374192_D_942545134==1 ~ "Military, police, firefighting, security services",
                                             D_700374192_D_700374192_D_308286913==1 ~ "Shipyard",
                                             D_700374192_D_700374192_D_924908599==1 ~ "Education",
                                             D_700374192_D_700374192_D_868510850==1 ~ "Arts, entertainment, and recreation",
                                             (D_700374192_D_700374192_D_807835037==1 | !is.na(D_700374192_D_923333992)) ~ "Other", 
                                             D_700374192_D_700374192_D_178420302==1 ~ "Unknown",
                                             TRUE ~ "Skipped this Question"))

dt_curr_bus_summary <- bsn %>% group_by(category) %>%   dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(category, n, percentage)

dt_curr_bus_summary %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("BSNSSTYP1: Current Employer Business Type")) %>% 
  cols_label(n= md("**N**"), category = md("**Type**"), percentage = md("**%**")) %>% 
  # summary_rows( groups=F,
  #   column = c(n,percentage),
  #   fns= list(
  #     Sum= ~sum(.)
  #   ), decimals=0) %>%
  grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = category,
    )
  ) 


#products made/services provided from current employer
#table(module1$D_868232409) -- potentially identifying? And VERY LONG with individual reponses
home1skip <- data_tib_m1 %>%  filter(data_tib_m1$D_613744428==353358909)
home1skip= home1skip %>%  mutate(Address1= case_when(is.na(D_868232409)~"Skipped this Question",
                                                     TRUE ~ "Provided a Response"))
  
dt_home1skip_summary <- home1skip %>% dplyr::group_by(Address1) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address1, n, percentage)
  
  
dt_home1skip_summary %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("EMPLYRSRVCE1: Products or Services of Current Employer")) %>% 
  cols_label(n= md("**N**"),Address1 = md("**Answer**"), percentage = md("**%**")) %>% 
  # summary_rows(
  #   column = c(participants,percentage),
  #   fns= list(
  #     Sum= ~sum(.)
  #   ), decimals=0) %>%
  grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address1,
    )
  ) 


#yrs at current job--739294356
module1 %>% mutate(D_739294356=as.numeric(as.character(D_739294356))) %>%
    filter(!is.na(D_739294356)) %>%
    ggplot(aes(x=D_739294356))+
     xlab("Years") + ylab("Frequency") + geom_histogram()+  ggtitle("WORK4: Years at Current Job")+
    geom_histogram(color="black")+ scale_y_continuous(breaks=pretty_breaks()) +
    geom_vline(aes(xintercept=mean(D_739294356, na.rm=T)), colour="#2973A5", linetype="solid")


#this current position your longest held position?
work5 <- data_tib_m1  %>%  filter(!is.na(D_868232409))


work5_ans= work5 %>%  mutate(answer= case_when(D_847533056==353358909 ~ "Yes",
                                             D_847533056==104430631 ~ "No",
                                             TRUE ~ "Skipped this Question"))

dtwork5_summary <- work5_ans %>% group_by(answer) %>%   dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(answer, n, percentage)

dtwork5_summary %>%  gt::gt() %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("WORK5: Current Job the Longest Held Job")) %>% 
  cols_label(n= md("**N**"), answer = md("**Answer**"), percentage = md("**%**")) %>% 
  grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = answer,
    )
  ) 


#ever worked for pay?
one_logic_funct(D_403258164, D_613744428,104430631,"WORK6: Ever Work")


#longest held job title --work7
#table(module1$D_118061122)- potentially identifiable and a very long list with individual responses 
home1skip <- data_tib_m1 %>% filter(D_403258164==353358909 | D_847533056!=353358909) %>% select(D_118061122)
home1skip= home1skip %>%  mutate(Address1= case_when(is.na(D_118061122)~"Skipped this Question",
                                                     TRUE ~ "Provided a Response"))
  
dt_home1skip_summary <- home1skip %>% dplyr::group_by(Address1) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address1, n, percentage)
  
  
dt_home1skip_summary %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("WORK7: Job Title (Longest Held Position")) %>% 
  cols_label(n= md("**N**"),Address1 = md("**Answer**"), percentage = md("**%**")) %>% 
  # summary_rows(
  #   column = c(participants,percentage),
  #   fns= list(
  #     Sum= ~sum(.)
  #   ), decimals=0) %>%
  grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address1,
    )
  ) 


#Occupational category for longest held job--OCCUPTN2
#table(module1$D_279637054) -- leaving out as it is VERY long and not helpful unless the category codes are accessible
home1skip <- data_tib_m1 %>% filter(D_403258164==353358909 | D_847533056!=353358909) 
home1skip= home1skip %>%  mutate(Address1= case_when(is.na(D_279637054)~"Skipped this Question",
                                                     TRUE ~ "Provided a Response"))
  
dt_home1skip_summary <- home1skip %>% dplyr::group_by(Address1) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address1, n, percentage)
  
  
dt_home1skip_summary %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("OCCUPTN2: Occupation Category of Longest Held Job")) %>% 
  cols_label(n= md("**N**"),Address1 = md("**Answer**"), percentage = md("**%**")) %>% 
  # summary_rows(
  #   column = c(participants,percentage),
  #   fns= list(
  #     Sum= ~sum(.)
  #   ), decimals=0) %>%
  grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address1,
    )
  ) 


#employers name for longest held job--EMPLYR2
#table(module1$D_988878019) -- potentially identifying? And Very long with individual reponses
home1skip <- data_tib_m1 %>% filter(D_403258164==353358909 | D_847533056!=353358909) 
home1skip= home1skip %>%  mutate(Address1= case_when(is.na(D_988878019)~"Skipped this Question",
                                                     TRUE ~ "Provided a Response"))
  
dt_home1skip_summary <- home1skip %>% dplyr::group_by(Address1) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address1, n, percentage)
  
  
dt_home1skip_summary %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("EMPLYR1: Name of Longest Employer")) %>% 
  cols_label(n= md("**N**"),Address1 = md("**Answer**"), percentage = md("**%**")) %>% 
  # summary_rows(
  #   column = c(participants,percentage),
  #   fns= list(
  #     Sum= ~sum(.)
  #   ), decimals=0) %>%
  grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address1,
    )
  ) 


#type of business for longest held job 
dt_long_bus = data_tib_m1  %>% filter(D_403258164==353358909 | D_847533056!=353358909)

dt_curr_bus2= dt_long_bus  %>%  mutate(multb2 = ifelse(D_530742915_D_530742915_D_641572847==1, 1, 0) + ifelse(D_530742915_D_530742915_D_592592455==1, 1, 0) + ifelse(D_530742915_D_530742915_D_711138281==1, 1, 0) + ifelse(D_530742915_D_530742915_D_596792238==1, 1, 0) + ifelse(D_530742915_D_530742915_D_133362151==1, 1, 0) + ifelse(D_530742915_D_530742915_D_372993567==1, 1, 0) + ifelse(D_530742915_D_530742915_D_620577362==1, 1, 0) + ifelse(D_530742915_D_530742915_D_580409149==1, 1, 0) + ifelse(D_530742915_D_530742915_D_867237640==1, 1, 0) + ifelse(D_530742915_D_530742915_D_698814077==1, 1, 0) + ifelse(D_530742915_D_530742915_D_751475124==1, 1, 0) + ifelse(D_530742915_D_530742915_D_308286913==1, 1, 0) + ifelse(D_530742915_D_530742915_D_807835037==1, 1, 0) + ifelse(D_530742915_D_530742915_D_178420302==1, 1, 0))


bsn= dt_curr_bus2  %>%  mutate(category= case_when(as.numeric(multb2)>1 ~ "Multiple Business Types",
                                                  D_530742915_D_530742915_D_641572847==1 ~ "Manufacturing",
                                             D_530742915_D_530742915_D_592592455==1 ~ "Retail or Wholesale Sales",
                                             #D_530742915_D_530742915_D_711138281==1 ~ "Wholesale or Distributor",
                                             D_530742915_D_530742915_D_711138281==1 | D_530742915_D_530742915_D_149230791 ==1 ~ "Transportation, warehousing, and utilities",
                                             #D_530742915_D_530742915_D_596792238==1 ~ "A Service Provider",
                                            D_530742915_D_530742915_D_596792238==1 | D_530742915_D_530742915_D_439857718==1 ~ "Professional and business services",
                                             D_530742915_D_530742915_D_133362151==1 ~ "Construction or Equipment Repair",
                                             D_530742915_D_530742915_D_372993567==1 ~ "Mining, quarrying, and oil annd gas extraction",
                                             #D_530742915_D_530742915_D_620577362==1 ~ "Farming",
                                             D_530742915_D_530742915_D_709307391==1 ~ "Accommodation and food services",
                                             #D_530742915_D_530742915_D_580409149==1 ~ "Fishing",
                                             #D_530742915_D_530742915_D_867237640==1 ~ "Forestry",
                                             D_530742915_D_530742915_D_620577362==1 | D_530742915_D_530742915_D_580409149==1 |
                                              D_530742915_D_530742915_D_867237640==1 | D_530742915_D_530742915_D_927863729==1 ~ "Farming, fishing, or forestry",
                                             D_530742915_D_530742915_D_766533183==1 ~ "Healthcare or social assistance",
                                             D_530742915_D_530742915_D_698814077==1 ~ "Government",
                                             #D_530742915_D_530742915_D_751475124==1 ~ "Military",
                                             D_530742915_D_530742915_D_751475124==1 | D_530742915_D_530742915_D_942545134==1 ~ "Military, police, firefighting, security services",
                                             D_530742915_D_530742915_D_308286913==1 ~ "Shipyard",
                                             D_530742915_D_530742915_D_924908599==1 ~ "Education",
                                             D_530742915_D_530742915_D_868510850==1 ~ "Arts, entertainment, and recreation",
                                             (D_530742915_D_530742915_D_807835037==1 | !is.na(D_530742915_D_739237614)) ~ "Other", 
                                             D_530742915_D_530742915_D_178420302==1 ~ "Unknown",
                                             TRUE ~ "Skipped this Question"))

dt_long_bus_summary <- bsn %>% group_by(category) %>%   dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(category, n, percentage)

#gt_dt_long_bus <- 
dt_long_bus_summary %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("BSNSSTYP2: Employer Business Type for Longest Held Position")) %>% 
  cols_label(n= md("**N**"), category = md("**Type**"), percentage = md("**%**")) %>% 
  # summary_rows( groups=F,
  #   column = c(n,percentage),
  #   fns= list(
  #     Sum= ~sum(.)
  #   ), decimals=0) %>%
  #summary_rows(groups=F, fns = list(label = md("**ALL**"), id = "totals") ~ sum(.)) %>% 
  grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = category,
    )
  ) 


#Products made/services provided for longest held job--EMPLYRSRVCE2
#table(module1$D_233198706) -- potentially identifying? And VERY LONG with individual reponses
 home1skip <- data_tib_m1 %>% filter(D_403258164==353358909 | D_847533056!=353358909) 
home1skip= home1skip %>%  mutate(Address1= case_when(is.na(D_233198706)~"Skipped this Question",
                                                     TRUE ~ "Provided a Response"))
  
dt_home1skip_summary <- home1skip %>% dplyr::group_by(Address1) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Address1, n, percentage)
  
  
dt_home1skip_summary %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("EMPLYRSRVCE2: Products/Services at Longest Held Position")) %>% 
  cols_label(n= md("**N**"),Address1 = md("**Answer**"), percentage = md("**%**")) %>% 
  # summary_rows(
  #   column = c(participants,percentage),
  #   fns= list(
  #     Sum= ~sum(.)
  #   ), decimals=0) %>%
  grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Address1,
    )
  ) 

#yrs at longest held position 
module1 %>% mutate(D_686172464=as.numeric(as.character(D_686172464))) %>%
     filter((D_403258164==353358909 | D_847533056!=353358909) & !is.na(D_686172464))%>%
    ggplot(aes(x=D_686172464))+
     xlab("Years") + ylab("Frequency") + geom_histogram()+  ggtitle("WORK8: Years at Longest Held Position")+
    geom_histogram(color="black")+ scale_y_continuous(breaks=pretty_breaks()) +
    geom_vline(aes(xintercept=mean(D_686172464, na.rm=T)), colour="#2973A5", linetype="solid")


#total family income
data_tib_m1$D_759004335 <- factor(data_tib_m1$D_759004335, levels=c(374508062,976555124,745561936,209571450,212249150,777814771,922395188,913602274,742032816,178420302,746038746, "Skipped this Question"))
simple_funct(D_759004335, "INCOME: Total Family Income")







#Number of people in the house
##sum(table(module1$D_173508724 ))
hist_funct(D_641651634_D_173508724, "Number of People in Household", "People", "Frequency")
cat("Don't know number of people in household:", as.numeric(sum(table(module1$D_641651634_D_641651634_D_746038746==1))))



#ALTADDRESS1/ALTADDRESS2/ALTCONTACT1/ALTCONTACT2 won't list for PII reasons
  altcont1= data_tib_m1 %>%  mutate(Contact= case_when(!is.na(D_986275155_D_661719912) & !is.na(D_986275155_D_801653230)~"Gave Full Name",
                                                           (!is.na(D_986275155_D_661719912)| !is.na(D_986275155_D_801653230))~"Gave First or Last Name Only",
                                                           TRUE~"Skipped Alternative Contact Question"))

dt_altcont1_summary <- altcont1 %>% dplyr::group_by(Contact) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Contact, n, percentage)


dt_altcont1_summary %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("ALTCONTACT1: Contact Name In Case Participant Cannot Be Reached")) %>% 
  cols_label(n= md("**N**"),Contact = md("**Answer**"), percentage = md("**%**")) %>% 
  grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Contact,
    )
  ) 







altcont2= data_tib_m1 %>%  mutate(Contact= case_when(!is.na(D_285718391_D_286149234) | !is.na(D_285718391_D_318130543) | !is.na(D_285718391_D_750097000)~"Gave Alternative Contact Info",
                                                       TRUE~"Skipped Alternative Contact Info"))
dt_altcont2_summary <- altcont2 %>% dplyr::group_by(Contact) %>%  dplyr::summarize(n=n(), percentage=100*n/nrow(.))  %>% dplyr::ungroup() %>%  dplyr::select(Contact, n, percentage)

dt_altcont2_summary %>%  gt::gt(rowname_col = "row_lab") %>%  
  fmt_number(columns = "percentage", decimals = 2) %>% 
  tab_header(title = md("ALTCONTACT2: Phone/Email of Alternative Contact")) %>% 
  cols_label(n= md("**N**"),Contact = md("**Answer**"), percentage = md("**%**")) %>% 
  grand_summary_rows(columns=c(n, percentage),fns = ~sum(.,na.rm = T))|>
  tab_options(
      stub.font.weight = "bold"
    ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold")
    ),
    locations = cells_body(
      columns = Contact,
    )
  ) 


#module1 survey 
simple_funct(D_431721131, "QXAUTHOR1: Who Completed this Survey")



```



